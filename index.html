<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Shinichi Nakagawa">
<meta name="author" content="Santiago Ortega">
<meta name="author" content="Elena Gazzea">
<meta name="author" content="Malgorzata Lagisz">
<meta name="author" content="Anna Lenz">
<meta name="author" content="Erick Lundgren">
<meta name="author" content="Ayumi Mizuno*">
<meta name="dcterms.date" content="2025-07-14">
<title>Location–scale models in ecology: handling heterogeneity in continuous, counts and proportions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="online_tutorial_files/libs/clipboard/clipboard.min.js"></script>
<script src="online_tutorial_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="online_tutorial_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="online_tutorial_files/libs/quarto-html/popper.min.js"></script>
<script src="online_tutorial_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="online_tutorial_files/libs/quarto-html/anchor.min.js"></script>
<link href="online_tutorial_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="online_tutorial_files/libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="online_tutorial_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="online_tutorial_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="online_tutorial_files/libs/bootstrap/bootstrap-53ebf1a67f6b8c9f24769331023d810e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title"><strong>CONTENTS</strong></h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li>
<a href="#preparation" id="toc-preparation" class="nav-link" data-scroll-target="#preparation">Preparation</a>
  <ul>
<li><a href="#load-required-packages" id="toc-load-required-packages" class="nav-link" data-scroll-target="#load-required-packages">Load required packages</a></li>
  <li>
<a href="#glmmtmb-vs-brms" id="toc-glmmtmb-vs-brms" class="nav-link" data-scroll-target="#glmmtmb-vs-brms"><code>glmmTMB</code> vs <code>brms</code></a>
  <ul>
<li><a href="#parallel-processing" id="toc-parallel-processing" class="nav-link" data-scroll-target="#parallel-processing">Parallel Processing</a></li>
  </ul>
</li>
  <li><a href="#specifying-the-scale-component" id="toc-specifying-the-scale-component" class="nav-link" data-scroll-target="#specifying-the-scale-component">Specifying the Scale Component</a></li>
  </ul>
</li>
  <li>
<a href="#fixed-effects-locationscale-model-model-1" id="toc-fixed-effects-locationscale-model-model-1" class="nav-link" data-scroll-target="#fixed-effects-locationscale-model-model-1">Fixed-effects location–scale model (model 1)</a>
  <ul>
<li>
<a href="#dataset-overview" id="toc-dataset-overview" class="nav-link" data-scroll-target="#dataset-overview">Dataset overview</a>
  <ul>
<li><a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions">Questions</a></li>
  </ul>
</li>
  <li><a href="#visualise-the-datasets" id="toc-visualise-the-datasets" class="nav-link" data-scroll-target="#visualise-the-datasets">Visualise the datasets</a></li>
  <li>
<a href="#run-models-and-interpret-results" id="toc-run-models-and-interpret-results" class="nav-link" data-scroll-target="#run-models-and-interpret-results">Run models and interpret results</a>
  <ul>
<li><a href="#model-fitting" id="toc-model-fitting" class="nav-link" data-scroll-target="#model-fitting">Model fitting</a></li>
  <li><a href="#comparison-of-location-only-model-and-location-scale-model" id="toc-comparison-of-location-only-model-and-location-scale-model" class="nav-link" data-scroll-target="#comparison-of-location-only-model-and-location-scale-model">Comparison of location-only model and location-scale model</a></li>
  <li><a href="#interpretation-of-location-scale-model" id="toc-interpretation-of-location-scale-model" class="nav-link" data-scroll-target="#interpretation-of-location-scale-model">Interpretation of location-scale model :</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</li>
  <li>
<a href="#adding-random-effects-in-the-location-part-only-model-2" id="toc-adding-random-effects-in-the-location-part-only-model-2" class="nav-link" data-scroll-target="#adding-random-effects-in-the-location-part-only-model-2">Adding random effects in the location part only (model 2)</a>
  <ul>
<li>
<a href="#dataset-overview-1" id="toc-dataset-overview-1" class="nav-link" data-scroll-target="#dataset-overview-1">Dataset overview</a>
  <ul>
<li><a href="#questions-1" id="toc-questions-1" class="nav-link" data-scroll-target="#questions-1">Questions</a></li>
  <li><a href="#variables-included" id="toc-variables-included" class="nav-link" data-scroll-target="#variables-included">Variables included</a></li>
  </ul>
</li>
  <li><a href="#visualise-the-dataset" id="toc-visualise-the-dataset" class="nav-link" data-scroll-target="#visualise-the-dataset">Visualise the dataset</a></li>
  <li>
<a href="#run-models-and-interpret-results-1" id="toc-run-models-and-interpret-results-1" class="nav-link" data-scroll-target="#run-models-and-interpret-results-1">Run models and interpret results</a>
  <ul>
<li><a href="#comparison-of-location-only-model-and-location-scale-model-1" id="toc-comparison-of-location-only-model-and-location-scale-model-1" class="nav-link" data-scroll-target="#comparison-of-location-only-model-and-location-scale-model-1">Comparison of location-only model and location-scale model</a></li>
  <li><a href="#interpretation-of-location-scale-model-1" id="toc-interpretation-of-location-scale-model-1" class="nav-link" data-scroll-target="#interpretation-of-location-scale-model-1">Interpretation of location-scale model :</a></li>
  </ul>
</li>
  <li><a href="#conclusion-1" id="toc-conclusion-1" class="nav-link" data-scroll-target="#conclusion-1">Conclusion</a></li>
  </ul>
</li>
  <li>
<a href="#double-hierarchical-location-scale-model-model-3" id="toc-double-hierarchical-location-scale-model-model-3" class="nav-link" data-scroll-target="#double-hierarchical-location-scale-model-model-3">Double-hierarchical location-scale model (Model 3)</a>
  <ul>
<li>
<a href="#dataset-overview-2" id="toc-dataset-overview-2" class="nav-link" data-scroll-target="#dataset-overview-2">Dataset overview</a>
  <ul>
<li><a href="#question" id="toc-question" class="nav-link" data-scroll-target="#question">Question</a></li>
  </ul>
</li>
  <li>
<a href="#run-models-and-interpret-results-2" id="toc-run-models-and-interpret-results-2" class="nav-link" data-scroll-target="#run-models-and-interpret-results-2">Run models and interpret results</a>
  <ul>
<li><a href="#comparison-of-location-only-model-and-location-scale-model-2" id="toc-comparison-of-location-only-model-and-location-scale-model-2" class="nav-link" data-scroll-target="#comparison-of-location-only-model-and-location-scale-model-2">Comparison of location-only model and location-scale model</a></li>
  <li><a href="#interpretation-of-location-scale-model-2" id="toc-interpretation-of-location-scale-model-2" class="nav-link" data-scroll-target="#interpretation-of-location-scale-model-2">Interpretation of location-scale model :</a></li>
  </ul>
</li>
  <li><a href="#conclusion-2" id="toc-conclusion-2" class="nav-link" data-scroll-target="#conclusion-2">Conclusion</a></li>
  </ul>
</li>
  <li>
<a href="#beyond-gaussian-1" id="toc-beyond-gaussian-1" class="nav-link" data-scroll-target="#beyond-gaussian-1">Beyond Gaussian 1</a>
  <ul>
<li><a href="#questions-2" id="toc-questions-2" class="nav-link" data-scroll-target="#questions-2">Questions</a></li>
  <li><a href="#variables-included-1" id="toc-variables-included-1" class="nav-link" data-scroll-target="#variables-included-1">Variables included</a></li>
  <li><a href="#visualise-the-datasets-1" id="toc-visualise-the-datasets-1" class="nav-link" data-scroll-target="#visualise-the-datasets-1">Visualise the datasets</a></li>
  <li>
<a href="#run-models-and-interpret-results-3" id="toc-run-models-and-interpret-results-3" class="nav-link" data-scroll-target="#run-models-and-interpret-results-3">Run models and interpret results</a>
  <ul>
<li><a href="#model-fitting-1" id="toc-model-fitting-1" class="nav-link" data-scroll-target="#model-fitting-1">Model fitting</a></li>
  <li><a href="#comparison-of-location-only-model-and-location-scale-model-3" id="toc-comparison-of-location-only-model-and-location-scale-model-3" class="nav-link" data-scroll-target="#comparison-of-location-only-model-and-location-scale-model-3">Comparison of location-only model and location-scale model</a></li>
  <li><a href="#interpretation-of-location-scale-model-3" id="toc-interpretation-of-location-scale-model-3" class="nav-link" data-scroll-target="#interpretation-of-location-scale-model-3">Interpretation of location-scale model :</a></li>
  </ul>
</li>
  <li><a href="#conclusion-3" id="toc-conclusion-3" class="nav-link" data-scroll-target="#conclusion-3">Conclusion</a></li>
  </ul>
</li>
  <li>
<a href="#beyond-gaussian-2" id="toc-beyond-gaussian-2" class="nav-link" data-scroll-target="#beyond-gaussian-2">Beyond Gaussian 2</a>
  <ul>
<li>
<a href="#questions-3" id="toc-questions-3" class="nav-link" data-scroll-target="#questions-3">Questions</a>
  <ul>
<li><a href="#variables-included-2" id="toc-variables-included-2" class="nav-link" data-scroll-target="#variables-included-2">Variables included</a></li>
  </ul>
</li>
  <li><a href="#visualise-the-dataset-1" id="toc-visualise-the-dataset-1" class="nav-link" data-scroll-target="#visualise-the-dataset-1">Visualise the dataset</a></li>
  <li>
<a href="#run-models-and-interpret-results-4" id="toc-run-models-and-interpret-results-4" class="nav-link" data-scroll-target="#run-models-and-interpret-results-4">Run models and interpret results</a>
  <ul>
<li><a href="#model-fitting-2" id="toc-model-fitting-2" class="nav-link" data-scroll-target="#model-fitting-2">Model fitting</a></li>
  <li><a href="#model-comparison-results" id="toc-model-comparison-results" class="nav-link" data-scroll-target="#model-comparison-results">Model Comparison Results</a></li>
  <li><a href="#model-interpretation" id="toc-model-interpretation" class="nav-link" data-scroll-target="#model-interpretation">Model Interpretation</a></li>
  </ul>
</li>
  <li><a href="#conclusion-4" id="toc-conclusion-4" class="nav-link" data-scroll-target="#conclusion-4">Conclusion</a></li>
  </ul>
</li>
  <li>
<a href="#model-selection" id="toc-model-selection" class="nav-link" data-scroll-target="#model-selection">Model selection</a>
  <ul>
<li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example 2</a></li>
  </ul>
</li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#information-about-r-session" id="toc-information-about-r-session" class="nav-link" data-scroll-target="#information-about-r-session">Information about R session</a></li>
  </ul></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Location–scale models in ecology: handling heterogeneity in continuous, counts and proportions</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">step by step online tutorial</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Shinichi Nakagawa </p>
             <p>Santiago Ortega </p>
             <p>Elena Gazzea </p>
             <p>Malgorzata Lagisz </p>
             <p>Anna Lenz </p>
             <p>Erick Lundgren </p>
             <p>Ayumi Mizuno* </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 14, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header><p>If you have any questions, errors or bug reports, please feel free to contact Ayumi Mizuno (amizuno@ualberta.ca / ayumi.mizuno5@gmail.com).</p>
<p>Some of the models in this tutorial take a long time to run. To make the tutorial faster and easier to follow, we have precomputed selected models and saved them as .rds files.</p>
<p>If you would like to re-run the code yourself and reproduce the results shown in the tutorial, please make sure to do the following:</p>
<ol type="1">
<li>
<p>Download the following files:</p>
<ul>
<li><p>online_tutorial.qmd (the source file for this website)</p></li>
<li><p>All datasets in the data folder</p></li>
<li><p>The precomputed .rds files from Google Drive Google Drive link: <a href="https://drive.google.com/drive/folders/1CvshmYMowXSB9MdbCprP1LP7llZNxIbe?usp=drive_link" class="uri">https://drive.google.com/drive/folders/1CvshmYMowXSB9MdbCprP1LP7llZNxIbe?usp=drive_link</a></p></li>
</ul>
</li>
<li><p>Create a folder structure like this on your machine:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>    your<span class="sc">-</span>project<span class="sc">-</span>folder<span class="sc">/</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    ├── online_tutorial.qmd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    ├── data<span class="sc">/</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    │   └── (CSV files)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    └── Rdata<span class="sc">/</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        └── (RDS files from Google Drive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Adjust file paths if your folder structure is different. We use <code><a href="https://here.r-lib.org/reference/here.html">here::here()</a></code>to help make paths more portable, but if you move or rename files/folders, make sure to update functions like <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code> or <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> accordingly:</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># this is example</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"XXX.csv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">brms_m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"Rdata"</span>, <span class="st">"brms_m1.rds"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You will see similar code snippets throughout the tutorial. Feel free to modify them based on your own setup. If everything is placed correctly, the <code>.qmd</code> file should run without any issues.</p>
<section id="introduction" class="level1"><h1>Introduction</h1>
<p>This tutorial provides a step-by-step guide to applying location-scale models in ecology, evolution, and environmental sciences. We focus on practical applications and demonstrate how to implement these models in <code>R</code> using the <code>glmmTMB</code> and <code>brms</code> packages.</p>
<p>After a brief introduction to both modeling frameworks, we present worked examples using real datasets. In the final section, we also discuss approaches for model comparison and selection.</p>
</section><section id="preparation" class="level1"><h1>Preparation</h1>
<section id="load-required-packages" class="level2"><h2 class="anchored" data-anchor-id="load-required-packages">Load required packages</h2>
<p>Our tutorial uses <code>R</code> statistical software and existing <code>R</code> packages, which you will first need to download and install.</p>
<p>This tutorial makes use of several R packages for data manipulation, model fitting, diagnostics, visualisation, and reporting:</p>
<ul>
<li><p><code>dplyr</code>, <code>tibble</code>, <code>tidyverse</code> - for efficient and tidy data manipulation.</p></li>
<li><p><code>brms</code>, <code>glmmTMB</code>, <code>arm</code> - for fitting generalised linear mixed models.</p></li>
<li><p><code>cmdstanr</code> - interfaces with the CmdStan backend to accelerate Bayesian sampling via within-chain parallelisation. is a C++ library for Bayesian inference, in order to enable within-chain parallelisation to speeding up the sampling process.</p></li>
<li><p><code>DHARMa</code>, <code>loo</code>, <code>MuMIn</code> - for model diagnostics, cross-validation, and multi-model inference (note that both <code>loo</code> and <code>Mumin</code> contain functions with the same names, so call them with explicit namespaces, e.g.&nbsp;<code><a href="https://mc-stan.org/loo/reference/loo.html">loo::loo( )</a></code>).</p></li>
<li><p><code>ggplot2</code>, <code>patchwork</code>, <code>bayesplot</code>, <code>tidybayes</code> - for flexible and publication-ready visualisations.</p></li>
<li><p><code>gt</code>, <code>kableExtra</code>, <code>knitr</code> - for creating clean tables.</p></li>
<li><p><code>here</code> - for consistent file path management across projects.</p></li>
<li><p><code>ape</code>, <code>TreeTools</code> - for phylogenetic analyses and tree manipulation.</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span></span>
<span>  <span class="co">## data manipulation</span></span>
<span>  <span class="va">dplyr</span>, <span class="va">tibble</span>, <span class="va">tidyverse</span>,</span>
<span>  </span>
<span>  <span class="co">## model fitting</span></span>
<span>  <span class="va">ape</span>, <span class="va">arm</span>, <span class="va">brms</span>, <span class="va">broom.mixed</span>, <span class="va">cmdstanr</span>, <span class="va">emmeans</span>, <span class="va">glmmTMB</span>, <span class="va">MASS</span>, <span class="va">phytools</span>, <span class="va">rstan</span>, <span class="va">TreeTools</span>,</span>
<span>  </span>
<span>  <span class="co">## model checking and evaluation</span></span>
<span>  <span class="va">DHARMa</span>, <span class="va">loo</span>, <span class="va">MuMIn</span>, <span class="va">parallel</span>,</span>
<span>  </span>
<span>  <span class="co">## visualisation</span></span>
<span>  <span class="va">bayesplot</span>, <span class="va">ggplot2</span>, <span class="va">patchwork</span>, <span class="va">tidybayes</span>,</span>
<span>  </span>
<span>  <span class="co">## reporting and utilities</span></span>
<span>  <span class="va">gt</span>, <span class="va">here</span>, <span class="va">kableExtra</span>, <span class="va">knitr</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="glmmtmb-vs-brms" class="level2"><h2 class="anchored" data-anchor-id="glmmtmb-vs-brms">
<code>glmmTMB</code> vs <code>brms</code>
</h2>
<p><code>glmmTMB</code> is a powerful and flexible <code>R</code> package for fitting generalized linear mixed models (GLMMs), including models with random effect structures and scale (dispersion) part. It is built on the Template Model Builder (TMB) framework, which allows fast and efficient maximum likelihood estimation even for large and complex models.</p>
<p><code>brms</code> is an <code>R</code> package that allows users to fit Bayesian generalized (non-)linear multilevel models using the probabilistic programming language Stan. It provides a user-friendly formula syntax similar to that of <code>lme4</code> or <code>glmmTMB</code>, and supports a wide range of distributions, link functions, and advanced model components, including location-scale modeling.</p>
<p>Both packages are suitable for fitting location-scale models and are widely used in ecology and its related fields. Therefore, we selected them to illustrate how location-scale models can be practically applied in real data analysis.</p>
<p>While <code>brms</code> is a powerful and flexible package for Bayesian regression modeling, some readers may not be familiar with its usage. Below, we provide a brief introduction to fitting models using <code>brms</code>, focusing on the basic location-scale structure and key functions relevant to our analysis. You can also find some examples each section…</p>
<p>If you get stuck or are unsure about something, it might be helpful to check the below:</p>
<ul>
<li><p><a href="https://paulbuerkner.com/brms/index.html" class="uri">https://paulbuerkner.com/brms/index.html</a></p></li>
<li><p><a href="https://discourse.mc-stan.org/" class="uri">https://discourse.mc-stan.org/</a></p></li>
</ul>
<p>This example shows how to fit a simple location-scale model, where both the mean (<span class="math inline">\(\mu\)</span>) and the variability (<span class="math inline">\(\sigma\)</span>) of a continuous outcome variable <span class="math inline">\(y\)</span> are modeled as functions of a predictor <span class="math inline">\(x\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Example dataset</span></span>
<span><span class="co"># y is continuous response, x is a predictor</span></span>
<span><span class="co"># specify the model using bf()</span></span>
<span><span class="va">formula1</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">x</span>,  <span class="co"># location part</span></span>
<span>  sigma <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">x</span> <span class="co"># scale part - specified by sigma</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate default priors based on the formula and data</span></span>
<span><span class="va">default_priors</span> <span class="op">&lt;-</span> <span class="fu">default_prior</span><span class="op">(</span></span>
<span>                        <span class="va">formula1</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">dat</span>,                             </span>
<span>                        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>                               </span>
<span>                          <span class="op">)</span></span>
<span></span>
<span><span class="co"># fit the model - you can change N of iter, warmup (and thin), and also chains.</span></span>
<span>  <span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span><span class="va">formula1</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">dat</span>,           </span>
<span>                  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,                   </span>
<span>                  prior <span class="op">=</span> <span class="va">default_priors</span>,                </span>
<span>                  iter <span class="op">=</span> <span class="fl">2000</span>,   <span class="co"># total iterations per Markov-chain (i.e., how many posterior samples are drawn, including warm-up)</span></span>
<span>                       </span>
<span>                  warmup <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># number of early draws used only for adapting the sampler (step-size, mass matrix). These samples are discarded</span></span>
<span>                  thin <span class="op">=</span> <span class="fl">1</span>,      <span class="co"># keep every n-th post-warm-up draw. 1 means keep all draws                    </span></span>
<span>                  chains <span class="op">=</span> <span class="fl">2</span>,    <span class="co">#  number of independent MCMC chains run in parallel. Provides a convergence check (via Rhat)                    </span></span>
<span>             <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After fitting the model, you can use <code>summary(m1)</code> to inspect the estimated coefficients and sigma with 95% Credible Intervals, along with diagnostic statistics such as Rhat and effective sample size. To better understand how to interpret the model output, please refer to the “<strong>Bonus - brms</strong>” part in the next section.</p>
<section id="parallel-processing" class="level3"><h3 class="anchored" data-anchor-id="parallel-processing">Parallel Processing</h3>
<p>Before fitting our models with <code>brms</code>, we configure some global options to optimize sampling speed using parallel processing:</p>
<ol type="1">
<li>
<code><a href="https://rdrr.io/r/parallel/detectCores.html">parallel::detectCores()</a></code>: This function automatically detects the number of logical CPU cores available on your machine. This is a convenient way to ensure your code adapts to different computing environments.</li>
<li>
<code>options(mc.cores = parallel::detectCores())</code>: The mc.cores option is a global setting primarily used by rstan (the engine behind brms). It controls the number of MCMC chains that will be run in parallel. By setting it to <code>detectCores()</code>, you are telling brms to run as many chains concurrently as your CPU allows, significantly speeding up the overall sampling process.</li>
<li>
<code>options(brms.threads = 6)</code>: The brms.threads option specifies the number of CPU threads that Stan’s internal operations can utilize within a single MCMC chain. This enables within-chain parallelisation, further accelerating computations, especially for complex or large datasets. The value 6 is an example; you can adjust this based on your specific CPU architecture and memory.</li>
</ol>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Threading is a powerful feature that enables you to split a chain into multiple parallel threads, significantly reducing computation time. However, it requires installing both <code>cmdstanr</code> and the underlying <code>CmdStan</code> backend.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html">install_cmdstan</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html">check_cmdstan_toolchain</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/set_cmdstan_path.html">cmdstan_version</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>These settings are crucial for making Bayesian model fitting with <code>brms</code> more efficient, particularly for complex models or large datasets.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>brms.threads <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>  <span class="co"># Set global default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><code>brms</code> models can be computationally intensive and take a significant amount of time to run. To streamline your workflow, we provide the pre-fit models in RDS files, allowing you to load them directly without needing to re-run the lengthy estimation process.</p>
</div>
</div>
</div>
</section></section><section id="specifying-the-scale-component" class="level2"><h2 class="anchored" data-anchor-id="specifying-the-scale-component">Specifying the Scale Component</h2>
<p>Here’s how the scale component is handled in <code>glmmTMB</code> and <code>brms</code>, along with common parameter names for various distributions:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Distribution</th>
<th style="text-align: left;">Scale Parameter (Example)</th>
<th style="text-align: left;">
<code>glmmTMB</code> Specification</th>
<th style="text-align: left;">
<code>brms</code> Specification (Example)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Gaussian</td>
<td style="text-align: left;"><span class="math inline">\(\sigma\)</span></td>
<td style="text-align: left;"><code>dispformula = ~ ...</code></td>
<td style="text-align: left;"><code>bf(..., sigma ~ ...)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Negative Binomial</td>
<td style="text-align: left;"><span class="math inline">\(\theta\)</span></td>
<td style="text-align: left;"><code>dispformula = ~ ...</code></td>
<td style="text-align: left;"><code>bf(..., shape ~ ...)</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conway-Maxwell-Poisson</td>
<td style="text-align: left;"><span class="math inline">\(\nu\)</span></td>
<td style="text-align: left;"><code>dispformula = ~ ...</code></td>
<td style="text-align: left;"><code>bf(..., nu ~ ...)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Beta-Binomial</td>
<td style="text-align: left;"><span class="math inline">\(\phi\)</span></td>
<td style="text-align: left;"><code>dispformula = ~ ...</code></td>
<td style="text-align: left;"><code>bf(..., phi ~ ...)</code></td>
</tr>
</tbody>
</table>
<p><em>Note: In <code>glmmTMB</code>, <code>dispformula</code> is generally used to model the dispersion or scale parameter, regardless of its specific Greek letter notation, which varies by distribution.</em></p>
<p>The scale part varies depending on the distribution: for example, <span class="math inline">\(\sigma\)</span> for Gaussian or <span class="math inline">\(\theta\)</span> for negative binomial, <span class="math inline">\(\nu\)</span> for Conway–Maxwell–Poisson, <span class="math inline">\(\phi\)</span> for beta- binomial distribution (see the main text).</p>
</section></section><section id="fixed-effects-locationscale-model-model-1" class="level1"><h1>Fixed-effects location–scale model (model 1)</h1>
<p>Model 1 is a fixed-effects location-scale model, which allows us to model both the mean (location) and variance (scale) of a response variable simultaneously. This is particularly useful when we suspect that the variance of the response variable may differ across groups or treatments.</p>
<section id="dataset-overview" class="level2"><h2 class="anchored" data-anchor-id="dataset-overview">Dataset overview</h2>
<p>This dataset comes from a study by <a href="https://doi.org/10.1186/1756-0500-4-431">Cleasby et al.&nbsp;(2011)</a>, which investigated the effects of early-life food supplementation on adult morphology in a wild population of house sparrows (<em>Passer domesticus</em>). In particular, we focus on adult tarsus length as a measure of skeletal size. The dataset includes adult birds that either received supplemental food as chicks or not, and compares their tarsus length by treatment and sex.</p>
<section id="questions" class="level3"><h3 class="anchored" data-anchor-id="questions">Questions</h3>
<ol type="1">
<li><strong>Does early-life food supplementation increase adult size? Specifically, does it increase the average tarsus length in adulthood?</strong></li>
<li><strong>Does early-life food supplementation lead to lower variation in adult tarsus length?</strong></li>
<li><strong>Are there sex-specific effects of food supplementation? Do the effects on mean or variance differ between males and females?</strong></li>
</ol>
<p><strong>Variables included</strong></p>
<p>The dataset includes adult birds that either received supplemental food as chicks or not, and compares their tarsus length by treatment and sex. We use the following variables:</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>
<code>Sex</code>: Biological sex of the bird (“Male” or “Female”)</li>
<li>
<code>AdTarsus</code>: Adult tarsus length (mm)</li>
<li>
<code>Treatment</code>: Whether the bird received food supplementation as a chick (<code>Fed</code>) or not (<code>Control</code>)</li>
</ul>
</div>
</div>
</div>
</section></section><section id="visualise-the-datasets" class="level2"><h2 class="anchored" data-anchor-id="visualise-the-datasets">Visualise the datasets</h2>
<p>The plot shows how adult tarsus length varies by treatment (early-life food supplementation) and sex. Boxplots summarise the central tendency and spread, while the jittered points reveal the distribution of individual values. As shown in the plot, there is a clear tendency for reduced variability in the <strong>male treatment group</strong> (<code>Fed</code>), suggesting that early-life food supplementation may lead to more canalised development in males.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># load the datasets　----</span></span>
<span></span>
<span><span class="va">dat_tarsus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"SparrowTarsusData.csv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat_tarsus</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Treatment</span>, y <span class="op">=</span> <span class="va">AdTarsus</span>, fill <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_jitterdodge</span><span class="op">(</span>jitter.width <span class="op">=</span> <span class="fl">0.2</span>, dodge.width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Male"</span> <span class="op">=</span> <span class="st">"#1f78b4"</span>, <span class="st">"Female"</span> <span class="op">=</span> <span class="st">"#e31a1c"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Male"</span> <span class="op">=</span> <span class="st">"#1f78b4"</span>, <span class="st">"Female"</span> <span class="op">=</span> <span class="st">"#e31a1c"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Adult tarsus length by treatment and sex"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Treatment"</span>, y <span class="op">=</span> <span class="st">"Tarsus length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/show_data%20-%20model1-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section><section id="run-models-and-interpret-results" class="level2"><h2 class="anchored" data-anchor-id="run-models-and-interpret-results">Run models and interpret results</h2>
<p>We fit and compare two types of models to understand the structure of adult tarsus length:</p>
<ul>
<li><p>Location-only model: Estimates the mean of adult tarsus length as a function of sex and early-life food supplementation (treatment).</p></li>
<li><p>Location-scale model: Estimates both the mean and the variability (residual dispersion) of adult tarsus length, allowing us to examine whether treatment and sex influence not only the average trait value but also its individual variation.</p></li>
</ul>
<p>This approach enables us to detect subtle patterns, such as sex-specific canalisation, that may not be captured when modeling the mean alone.</p>
<section id="model-fitting" class="level3"><h3 class="anchored" data-anchor-id="model-fitting">Model fitting</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Location model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Residual diagnostics</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Location-scale model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Model comparison</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Summary of model results</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false" href="">bonus - <code>brms</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>First, we fit a location-only model as the baseline model.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># location-only model ----</span></span>
<span></span>
<span><span class="co">## log-transformation was applied to AdTarsus to reduce skewness and stabilize residual variance.</span></span>
<span><span class="va">model_0</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">AdTarsus</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="va">Sex</span><span class="op">:</span><span class="va">Treatment</span>,</span>
<span>    data <span class="op">=</span> <span class="va">dat_tarsus</span>, </span>
<span>    family <span class="op">=</span> <span class="va">gaussian</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          log(AdTarsus) ~ 1 + Sex + Treatment + Sex:Treatment
Data: dat_tarsus

      AIC       BIC    logLik -2*log(L)  df.resid 
   -221.0    -210.2     115.5    -231.0        59 


Dispersion estimate for gaussian family (sigma^2): 0.00158 

Conditional model:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           2.88728    0.01064  271.42   &lt;2e-16 ***
SexMale               0.01043    0.01373    0.76    0.447    
TreatmentFed          0.01036    0.01436    0.72    0.471    
SexMale:TreatmentFed  0.01353    0.02034    0.67    0.506    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## to quantify the uncertainty in parameter estimates, we computed 95% confidence intervals using the confint() function.</span></span>
<span><span class="co">## this function returns the lower and upper bounds for each fixed/random effect parameters. If a confidence interval does not include zero, it suggests that the corresponding predictor has a statistically significant effect (at approximately the 0.05 level).</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">model_0</span><span class="op">)</span> <span class="co"># check 95%CI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           2.5 %     97.5 %   Estimate
(Intercept)           2.86643380 2.90813203 2.88728291
SexMale              -0.01648352 0.03734866 0.01043257
TreatmentFed         -0.01779914 0.03850937 0.01035511
SexMale:TreatmentFed -0.02633701 0.05340220 0.01353260</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>We can check the residuals of the model to assess the model fit and assumptions. The Q-Q plot should show points falling along a straight line.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># | label: model0_diagnostics - model1</span></span>
<span></span>
<span><span class="co"># plot a q-q plot of residuals to visually assess the normality assumption</span></span>
<span><span class="co"># the data points should fail approximately along the reference line</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">model_0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="co"># visual check for normality of residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="co"># reference line for normal distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The residuals mostly follow a straight line in the Q-Q plot, but there are some deviations, particularly at the lower and upper ends. This suggests that the model may not fully capture the distribution of the data, indicating some potential issues with normality or heteroscedasticity.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Then, we fit a location-scale model.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># location-scale model ---- </span></span>
<span></span>
<span><span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">AdTarsus</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="va">Sex</span><span class="op">:</span><span class="va">Treatment</span>, <span class="co"># location part</span></span>
<span>    dispformula <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="va">Sex</span><span class="op">:</span><span class="va">Treatment</span>, <span class="co"># scale part</span></span>
<span>    data <span class="op">=</span> <span class="va">dat_tarsus</span>, </span>
<span>    family <span class="op">=</span> <span class="va">gaussian</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          log(AdTarsus) ~ 1 + Sex + Treatment + Sex:Treatment
Dispersion:                     ~1 + Sex + Treatment + Sex:Treatment
Data: dat_tarsus

      AIC       BIC    logLik -2*log(L)  df.resid 
   -224.0    -206.7     120.0    -240.0        56 


Conditional model:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           2.88728    0.01006  286.87   &lt;2e-16 ***
SexMale               0.01043    0.01343    0.78    0.437    
TreatmentFed          0.01036    0.01566    0.66    0.508    
SexMale:TreatmentFed  0.01353    0.01897    0.71    0.476    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Dispersion model:
                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)          -3.27919    0.18898 -17.352  &lt; 2e-16 ***
SexMale               0.07846    0.24397   0.322  0.74775    
TreatmentFed          0.27232    0.25520   1.067  0.28592    
SexMale:TreatmentFed -0.95054    0.36139  -2.630  0.00853 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                2.5 %      97.5 %    Estimate
cond.(Intercept)           2.86755650  2.90700935  2.88728293
cond.SexMale              -0.01588533  0.03675044  0.01043255
cond.TreatmentFed         -0.02033051  0.04104072  0.01035511
cond.SexMale:TreatmentFed -0.02364145  0.05070669  0.01353262
disp.(Intercept)          -3.64959165 -2.90879561 -3.27919363
disp.SexMale              -0.39971908  0.55664476  0.07846284
disp.TreatmentFed         -0.22785555  0.77250192  0.27232319
disp.SexMale:TreatmentFed -1.65885084 -0.24223149 -0.95054117</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Now we can compare the two models to see if the location-scale model provides a better fit to the data than the location-only model. We can use the <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> function to compare the two models based on their AIC values. Alternatively, we can use the <code>model.sel()</code> function from the <code>MuMIn</code> package to compare AICc values, which is more appropriate for small sample sizes.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compare models ----</span></span>
<span><span class="co">## we can use the anova() function to compare the two models of AIC </span></span>
<span><span class="co">## model.sel() from the MuMIn package can be used to compare AICc values.</span></span>
<span><span class="fu">model.sel</span><span class="op">(</span><span class="va">model_0</span>, <span class="va">model_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model selection table 
        cnd((Int)) dsp((Int)) cnd(Sex) cnd(Trt) cnd(Sex:Trt) dsp(Sex) dsp(Trt)
model_1      2.887     -3.279        +        +            +        +        +
model_0      2.887                   +        +            +                  
        dsp(Sex:Trt) df  logLik   AICc delta weight
model_1            +  8 119.976 -221.3  0.00  0.662
model_0               5 115.514 -220.0  1.34  0.338
Models ranked by AICc(x) </code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>The results of the location-only model (Model 0) and the location-scale model (Model 1) are summarised below.</p>
<div class="cell">
<div class="cell-output-display">
<div id="ckwemfgjnv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ckwemfgjnv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ckwemfgjnv thead, #ckwemfgjnv tbody, #ckwemfgjnv tfoot, #ckwemfgjnv tr, #ckwemfgjnv td, #ckwemfgjnv th {
  border-style: none;
}

#ckwemfgjnv p {
  margin: 0;
  padding: 0;
}

#ckwemfgjnv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ckwemfgjnv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ckwemfgjnv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ckwemfgjnv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ckwemfgjnv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ckwemfgjnv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckwemfgjnv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ckwemfgjnv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ckwemfgjnv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ckwemfgjnv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ckwemfgjnv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ckwemfgjnv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ckwemfgjnv .gt_spanner_row {
  border-bottom-style: hidden;
}

#ckwemfgjnv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ckwemfgjnv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ckwemfgjnv .gt_from_md > :first-child {
  margin-top: 0;
}

#ckwemfgjnv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ckwemfgjnv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ckwemfgjnv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ckwemfgjnv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ckwemfgjnv .gt_row_group_first td {
  border-top-width: 2px;
}

#ckwemfgjnv .gt_row_group_first th {
  border-top-width: 2px;
}

#ckwemfgjnv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckwemfgjnv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ckwemfgjnv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ckwemfgjnv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckwemfgjnv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckwemfgjnv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ckwemfgjnv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ckwemfgjnv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ckwemfgjnv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ckwemfgjnv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ckwemfgjnv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckwemfgjnv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ckwemfgjnv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ckwemfgjnv .gt_left {
  text-align: left;
}

#ckwemfgjnv .gt_center {
  text-align: center;
}

#ckwemfgjnv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ckwemfgjnv .gt_font_normal {
  font-weight: normal;
}

#ckwemfgjnv .gt_font_bold {
  font-weight: bold;
}

#ckwemfgjnv .gt_font_italic {
  font-style: italic;
}

#ckwemfgjnv .gt_super {
  font-size: 65%;
}

#ckwemfgjnv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ckwemfgjnv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ckwemfgjnv .gt_indent_1 {
  text-indent: 5px;
}

#ckwemfgjnv .gt_indent_2 {
  text-indent: 10px;
}

#ckwemfgjnv .gt_indent_3 {
  text-indent: 15px;
}

#ckwemfgjnv .gt_indent_4 {
  text-indent: 20px;
}

#ckwemfgjnv .gt_indent_5 {
  text-indent: 25px;
}

#ckwemfgjnv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ckwemfgjnv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Location-only model</th>
</tr>
<tr class="gt_col_headings even">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="StdError" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Std. Error</th>
<th id="CI_low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (low)</th>
<th id="CI_high" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (high)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Term">(Intercept)</td>
<td class="gt_row gt_center" headers="Estimate">2.887</td>
<td class="gt_row gt_center" headers="StdError">0.011</td>
<td class="gt_row gt_center" headers="CI_low">2.866</td>
<td class="gt_row gt_center" headers="CI_high">2.908</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">SexMale</td>
<td class="gt_row gt_center" headers="Estimate">0.010</td>
<td class="gt_row gt_center" headers="StdError">0.014</td>
<td class="gt_row gt_center" headers="CI_low">−0.016</td>
<td class="gt_row gt_center" headers="CI_high">0.037</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Term">TreatmentFed</td>
<td class="gt_row gt_center" headers="Estimate">0.010</td>
<td class="gt_row gt_center" headers="StdError">0.014</td>
<td class="gt_row gt_center" headers="CI_low">−0.018</td>
<td class="gt_row gt_center" headers="CI_high">0.039</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">SexMale:TreatmentFed</td>
<td class="gt_row gt_center" headers="Estimate">0.014</td>
<td class="gt_row gt_center" headers="StdError">0.020</td>
<td class="gt_row gt_center" headers="CI_low">−0.026</td>
<td class="gt_row gt_center" headers="CI_high">0.053</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="suomlbzsfj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#suomlbzsfj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#suomlbzsfj thead, #suomlbzsfj tbody, #suomlbzsfj tfoot, #suomlbzsfj tr, #suomlbzsfj td, #suomlbzsfj th {
  border-style: none;
}

#suomlbzsfj p {
  margin: 0;
  padding: 0;
}

#suomlbzsfj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#suomlbzsfj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#suomlbzsfj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#suomlbzsfj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#suomlbzsfj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#suomlbzsfj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#suomlbzsfj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#suomlbzsfj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#suomlbzsfj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#suomlbzsfj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#suomlbzsfj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#suomlbzsfj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#suomlbzsfj .gt_spanner_row {
  border-bottom-style: hidden;
}

#suomlbzsfj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#suomlbzsfj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#suomlbzsfj .gt_from_md > :first-child {
  margin-top: 0;
}

#suomlbzsfj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#suomlbzsfj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#suomlbzsfj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#suomlbzsfj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#suomlbzsfj .gt_row_group_first td {
  border-top-width: 2px;
}

#suomlbzsfj .gt_row_group_first th {
  border-top-width: 2px;
}

#suomlbzsfj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#suomlbzsfj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#suomlbzsfj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#suomlbzsfj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#suomlbzsfj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#suomlbzsfj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#suomlbzsfj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#suomlbzsfj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#suomlbzsfj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#suomlbzsfj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#suomlbzsfj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#suomlbzsfj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#suomlbzsfj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#suomlbzsfj .gt_left {
  text-align: left;
}

#suomlbzsfj .gt_center {
  text-align: center;
}

#suomlbzsfj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#suomlbzsfj .gt_font_normal {
  font-weight: normal;
}

#suomlbzsfj .gt_font_bold {
  font-weight: bold;
}

#suomlbzsfj .gt_font_italic {
  font-style: italic;
}

#suomlbzsfj .gt_super {
  font-size: 65%;
}

#suomlbzsfj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#suomlbzsfj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#suomlbzsfj .gt_indent_1 {
  text-indent: 5px;
}

#suomlbzsfj .gt_indent_2 {
  text-indent: 10px;
}

#suomlbzsfj .gt_indent_3 {
  text-indent: 15px;
}

#suomlbzsfj .gt_indent_4 {
  text-indent: 20px;
}

#suomlbzsfj .gt_indent_5 {
  text-indent: 25px;
}

#suomlbzsfj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#suomlbzsfj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Location-scale model (location part)</th>
</tr>
<tr class="gt_col_headings even">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="StdError" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Std. Error</th>
<th id="CI_low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (low)</th>
<th id="CI_high" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (high)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Term">(Intercept)</td>
<td class="gt_row gt_center" headers="Estimate">2.887</td>
<td class="gt_row gt_center" headers="StdError">0.010</td>
<td class="gt_row gt_center" headers="CI_low">2.868</td>
<td class="gt_row gt_center" headers="CI_high">2.907</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">SexMale</td>
<td class="gt_row gt_center" headers="Estimate">0.010</td>
<td class="gt_row gt_center" headers="StdError">0.013</td>
<td class="gt_row gt_center" headers="CI_low">−0.016</td>
<td class="gt_row gt_center" headers="CI_high">0.037</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Term">TreatmentFed</td>
<td class="gt_row gt_center" headers="Estimate">0.010</td>
<td class="gt_row gt_center" headers="StdError">0.016</td>
<td class="gt_row gt_center" headers="CI_low">−0.020</td>
<td class="gt_row gt_center" headers="CI_high">0.041</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">SexMale:TreatmentFed</td>
<td class="gt_row gt_center" headers="Estimate">0.014</td>
<td class="gt_row gt_center" headers="StdError">0.019</td>
<td class="gt_row gt_center" headers="CI_low">−0.024</td>
<td class="gt_row gt_center" headers="CI_high">0.051</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div id="kusexgzmzv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kusexgzmzv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kusexgzmzv thead, #kusexgzmzv tbody, #kusexgzmzv tfoot, #kusexgzmzv tr, #kusexgzmzv td, #kusexgzmzv th {
  border-style: none;
}

#kusexgzmzv p {
  margin: 0;
  padding: 0;
}

#kusexgzmzv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kusexgzmzv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kusexgzmzv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kusexgzmzv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kusexgzmzv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kusexgzmzv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kusexgzmzv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kusexgzmzv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kusexgzmzv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kusexgzmzv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kusexgzmzv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kusexgzmzv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kusexgzmzv .gt_spanner_row {
  border-bottom-style: hidden;
}

#kusexgzmzv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kusexgzmzv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kusexgzmzv .gt_from_md > :first-child {
  margin-top: 0;
}

#kusexgzmzv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kusexgzmzv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kusexgzmzv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kusexgzmzv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kusexgzmzv .gt_row_group_first td {
  border-top-width: 2px;
}

#kusexgzmzv .gt_row_group_first th {
  border-top-width: 2px;
}

#kusexgzmzv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kusexgzmzv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kusexgzmzv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kusexgzmzv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kusexgzmzv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kusexgzmzv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kusexgzmzv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kusexgzmzv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kusexgzmzv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kusexgzmzv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kusexgzmzv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kusexgzmzv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kusexgzmzv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kusexgzmzv .gt_left {
  text-align: left;
}

#kusexgzmzv .gt_center {
  text-align: center;
}

#kusexgzmzv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kusexgzmzv .gt_font_normal {
  font-weight: normal;
}

#kusexgzmzv .gt_font_bold {
  font-weight: bold;
}

#kusexgzmzv .gt_font_italic {
  font-style: italic;
}

#kusexgzmzv .gt_super {
  font-size: 65%;
}

#kusexgzmzv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kusexgzmzv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kusexgzmzv .gt_indent_1 {
  text-indent: 5px;
}

#kusexgzmzv .gt_indent_2 {
  text-indent: 10px;
}

#kusexgzmzv .gt_indent_3 {
  text-indent: 15px;
}

#kusexgzmzv .gt_indent_4 {
  text-indent: 20px;
}

#kusexgzmzv .gt_indent_5 {
  text-indent: 25px;
}

#kusexgzmzv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kusexgzmzv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Location-scale model (dispersion part)</th>
</tr>
<tr class="gt_col_headings even">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="StdError" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Std. Error</th>
<th id="CI_low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (low)</th>
<th id="CI_high" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (high)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Term">(Intercept)</td>
<td class="gt_row gt_center" headers="Estimate">−3.279</td>
<td class="gt_row gt_center" headers="StdError">0.189</td>
<td class="gt_row gt_center" headers="CI_low">−3.650</td>
<td class="gt_row gt_center" headers="CI_high">−2.909</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">SexMale</td>
<td class="gt_row gt_center" headers="Estimate">0.078</td>
<td class="gt_row gt_center" headers="StdError">0.244</td>
<td class="gt_row gt_center" headers="CI_low">−0.400</td>
<td class="gt_row gt_center" headers="CI_high">0.557</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Term">TreatmentFed</td>
<td class="gt_row gt_center" headers="Estimate">0.272</td>
<td class="gt_row gt_center" headers="StdError">0.255</td>
<td class="gt_row gt_center" headers="CI_low">−0.228</td>
<td class="gt_row gt_center" headers="CI_high">0.773</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">SexMale:TreatmentFed</td>
<td class="gt_row gt_center" headers="Estimate">−0.951</td>
<td class="gt_row gt_center" headers="StdError">0.361</td>
<td class="gt_row gt_center" headers="CI_low">−1.659</td>
<td class="gt_row gt_center" headers="CI_high">−0.242</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<p>Of course, we can also fit the location–scale model using the <code>brms</code>! Here we show how to fit the same model as above using <code>brms</code>. The results should be similar to those obtained with <code>glmmTMB</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># specify the model using bf()</span></span>
<span><span class="va">formula1</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">AdTarsus</span><span class="op">)</span> <span class="op">~</span>  <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="va">Sex</span><span class="op">:</span><span class="va">Treatment</span>, </span>
<span>  sigma <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">Sex</span> <span class="op">+</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="va">Sex</span><span class="op">:</span><span class="va">Treatment</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate default priors based on the formula and data</span></span>
<span><span class="va">default_priors</span> <span class="op">&lt;-</span> <span class="fu">default_prior</span><span class="op">(</span></span>
<span>                        <span class="va">formula1</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">dat_tarsus</span>,                             </span>
<span>                        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># default link function for gaussian family                                 </span></span>
<span>                          <span class="op">)</span></span>
<span></span>
<span><span class="co"># fit the model - you can change N of iter, warmup, thin, and also chains.</span></span>
<span><span class="co"># adapt_delta = 0.95 helps to reduce divergent transitions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="va">brms_g1</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span><span class="va">formula1</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">dat_tarsus</span>,           </span>
<span>                  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,                   </span>
<span>                  prior <span class="op">=</span> <span class="va">default_priors</span>,                </span>
<span>                  iter <span class="op">=</span> <span class="fl">2000</span>,                          </span>
<span>                  warmup <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                  thin <span class="op">=</span> <span class="fl">1</span>,                              </span>
<span>                  chains <span class="op">=</span> <span class="fl">2</span>,                            </span>
<span>                  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> </span>
<span>             <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">brms_g1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: log(AdTarsus) ~ 1 + Sex + Treatment + Sex:Treatment 
         sigma ~ 1 + Sex + Treatment + Sex:Treatment
   Data: dat_tarsus (Number of observations: 64) 
  Draws: 2 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 2000

Regression Coefficients:
                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                      2.89      0.01     2.86     2.91 1.00     1162
sigma_Intercept               -3.19      0.21    -3.56    -2.72 1.00     1041
SexMale                        0.01      0.01    -0.02     0.04 1.00      994
TreatmentFed                   0.01      0.02    -0.03     0.05 1.00      795
SexMale:TreatmentFed           0.01      0.02    -0.03     0.06 1.00      711
sigma_SexMale                  0.04      0.27    -0.52     0.56 1.00     1025
sigma_TreatmentFed             0.24      0.28    -0.30     0.77 1.00      917
sigma_SexMale:TreatmentFed    -0.87      0.41    -1.66    -0.01 1.00      890
                           Tail_ESS
Intercept                      1130
sigma_Intercept                1202
SexMale                        1040
TreatmentFed                    756
SexMale:TreatmentFed            865
sigma_SexMale                  1079
sigma_TreatmentFed             1082
sigma_SexMale:TreatmentFed     1050

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>First, you need to check the effective sample size (<code>\*\*\_ESS</code>) and <code>Rhat</code> values. ESS should be greater than <strong>400</strong> (<a href="https://doi.org/10.1214/20-BA1221">Vehtari et al.&nbsp;2021</a>), and R-hat should be close to <strong>1.0</strong> (ideally &lt; 1.01). If these conditions are not met, you may need to increase the number of iterations or adjust the model specification.</p>
<p>Then, we can check the output - it is divided into two parts: <strong>Location (mean) part</strong> (how the average changes) and <strong>Scale (dispersion) part</strong> (how the variability changes - in Gaussian data, the scale part is <span class="math inline">\(\sigma\)</span>)</p>
<p>Here is the explanation of the output table:</p>
<hr>
<p><code>Estimate</code>: posterior mean</p>
<p><code>Est.Err</code>: standard error of posterior mean</p>
<p><code>l-95% CI</code> and <code>u-95% CI</code>: Lower and upper bounds of the 95% <strong>credible interval</strong> (range where the true value lies with 95% probability, given the model and data)</p>
<p><code>Rhat</code>: Convergence diagnostic. Should be close to 1.00. If &gt;1.01, convergence may be poor.</p>
<p><code>Bulk_ESS</code> and <code>Tail_ESS</code>: Effective sample sizes for bulk and tail distributions. Should be &gt;400 for reliable estimates (larger is better).</p>
<hr>
<p>Now, you can find the results from <code>glmmTMB</code> and <code>brms</code> are very close to each other, but there are some differences in the estimates and standard errors. This came from the different estimation methods used by the two packages. <code>glmmTMB</code> uses maximum likelihood estimation, while <code>brms</code> uses Bayesian estimation with Markov Chain Monte Carlo (MCMC) sampling…</p>
</div>
</div>
</div>
</section><section id="comparison-of-location-only-model-and-location-scale-model" class="level3"><h3 class="anchored" data-anchor-id="comparison-of-location-only-model-and-location-scale-model">Comparison of location-only model and location-scale model</h3>
<p>There was no significant difference in the fit of the two models. location-scale model (model 1) had a lower AICc (-221.0) than location-only model (model 0: -220.0), with an AIC weight of 0.662 vs.&nbsp;0.338 (see <code>Model comparison</code> tab).　</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note on <code>AIC</code> vs <code>AICc</code>:
</div>
</div>
<div class="callout-body-container callout-body">
<p>While both <code>AIC</code> (Akaike Information Criterion) and <code>AICc</code> (AIC with correction) assess model fit by balancing goodness of fit and model complexity, AICc includes an additional correction for small sample sizes. When the sample size is limited relative to the number of estimated parameters, AICc is generally preferred because it reduces the risk of overfitting. As a result, AIC and AICc values may differ slightly, and model rankings based on them may also vary.</p>
</div>
</div>
</section><section id="interpretation-of-location-scale-model" class="level3"><h3 class="anchored" data-anchor-id="interpretation-of-location-scale-model">Interpretation of location-scale model :</h3>
<p><strong>Location (mean) part:</strong></p>
<ul>
<li>There was no significant effect of treatment, sex, or their interaction on the mean of <code>log(AdTarsus)</code> (all 95% CIs include 0).</li>
</ul>
<p><strong>Scale (dispersion) part:</strong></p>
<ul>
<li>There are a significant negative interaction between sex and treatment (<code>SexMale:TreatmentFed</code>; <span class="math inline">\(\beta_{[\text{interaction}]}^{(s)}\)</span> = -0.95, 95% CI = [-1.66, -0.24]). The estimate -0.95 in the dispersion model indicates that the residual variance in <code>log(AdTarsus)</code> is significantly lower in Fed males than in Control males.</li>
<li>This indicates that variance in adult tarsus length was significantly reduced among males that received food supplementation as chicks.</li>
<li>Neither treatment nor sex alone had a significant effect on variance (i.e., the reduction was specific to supplemented males).</li>
</ul></section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p><strong>Q1. Does early-life food supplementation increase adult size? Specifically, does it increase the average tarsus length in adulthood?</strong></p>
<p>Answer: No clear evidence. In both the location-only and location-scale models, the effect of feeding (treatment) on the mean adult tarsus length was small and not statistically significant. This suggests that food supplementation did not lead to a measurable increase in average tarsus length.</p>
<p><strong>Q2. Does early-life food supplementation lead to lower variation in adult tarsus length??</strong></p>
<p>Answer: Partically yes - especially in males. The location-scale model revealed a significant reduction in variance in the male treatment group (Fed) compared to the male control group. This was supported by a significant negative interaction between sex and treatment in the dispersion model. In contrast, females showed no significant difference in variance between treatment groups. This indicates that early-life food supplementation reduced size variation only in males, not across all individuals.</p>
<p><strong>Q3. Are there sex-specific effects of food supplementation? Do the effects on mean or variance differ between males and females?</strong></p>
<p>Answer: Yes. The male treatment group (<code>Fed</code>) showed significantly reduced variance in adult tarsus length compared to the control group <code>(Control)</code>, while females did not show a significant difference in variance between treatment groups. There were no significant differences in mean tarsus length between sexes or treatments. This pattern suggests that early-life food supplementation may canalise trait development in males, leading to more uniform adult morphology under favourable nutritional conditions.</p>
<hr>
<p>Although the model comparison did not show a strong difference in overall fit between the location-only and location-scale models (<span class="math inline">\(\Delta AICc = 1.3\)</span>), the location-scale model revealed an important and previously overlooked pattern:</p>
<p><em>Early-life food supplementation significantly reduced trait variance in males, but not in females.</em></p>
<p>This result would have been missed in a traditional location-only analysis that focuses solely on mean differences. By modeling both the mean and the dispersion, we were able to detect a sex-specific canalisation effect, highlighting the value of using location-scale models when investigating trait variability and developmental plasticity.</p>
<!-- need to fix the Santi's sections - add glmmTMB?? -->
<!-- for now, I downloaded all RDS files in my computer -->
</section></section><section id="adding-random-effects-in-the-location-part-only-model-2" class="level1"><h1>Adding random effects in the location part only (model 2)</h1>
<p>Model 2 is a location-scale model with random effects in the location part only. This allows us to account for individual-level variation in the mean response while still modeling the dispersion separately.</p>
<section id="dataset-overview-1" class="level2"><h2 class="anchored" data-anchor-id="dataset-overview-1">Dataset overview</h2>
<p>This dataset comes from <a href="https://doi.org/10.1093/beheco/araf050">Drummond et al (2025)</a>, which examined the benefits of brood reduction in the blue-footed booby (<em>Sula nebouxii</em>).Focusing on two-chick broods, the research explored whether the death of one chick (brood reduction) primarily benefits the surviving sibling (via increased resource acquisition) or the parents (by lessening parental investment). In this species, older chicks establish a strong dominance hierarchy over their younger siblings. Under stressful environmental conditions, this often results in the death of the second-hatched chick, with parental intervention being extremely rare.</p>
<p>For this tutorial, we will specifically examine data from two-chick broods where both chicks survived to fledging. Our analysis will focus on how hatching order influences the body condition of chicks at fledging.</p>
<section id="questions-1" class="level3"><h3 class="anchored" data-anchor-id="questions-1">Questions</h3>
<ol type="1">
<li><strong>Do first hatched chicks have a higher body mass than second-hatched chicks?</strong></li>
<li><strong>Does the variability in body mass differ between first and second-hatched chicks?</strong></li>
</ol></section><section id="variables-included" class="level3"><h3 class="anchored" data-anchor-id="variables-included">Variables included</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>
<code>SMI</code>: Scaled Mass Index, a measure that accounts for body mass relative to size</li>
<li>
<code>RANK</code>: The order in which chicks hatched (1 for first-hatched, 2 for second-hatched)</li>
<li>
<code>NEST_ID</code>: Identifier for the nest where the chicks were raised</li>
<li>
<code>YEAR</code>: The year in which the chicks were born</li>
</ul>
</div>
</div>
</div>
</section></section><section id="visualise-the-dataset" class="level2"><h2 class="anchored" data-anchor-id="visualise-the-dataset">Visualise the dataset</h2>
<p>The plot displays the distribution of body condition, measured as Scaled Mass Index (SMI), for blue-footed booby chicks based on their <code>hatching order</code>. Violin plots illustrate the overall density distribution of SMI for both “First-Hatched” and “Second-Hatched” chicks. Each individual empty circle represents the SMI of a single chick. The plot visually highlights individual variability and allows for the comparison of both central tendency (black solid line) and spread of body condition between the two hatching orders.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"SMI_Drummond_et_al_2025.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">REDUCTION</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span><span class="op">&lt;-</span> <span class="va">dat</span><span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">TIME</span>, <span class="op">-</span><span class="va">ST_DATE</span>, <span class="op">-</span><span class="va">HATCHING_DATE</span>,<span class="op">-</span><span class="va">REDUCTION</span>,<span class="op">-</span><span class="va">RING</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>SMI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">SMI</span><span class="op">)</span>, <span class="co"># Scaled mass index</span></span>
<span>         NEST <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">NEST</span><span class="op">)</span>, </span>
<span>         WORKYEAR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">WORKYEAR</span><span class="op">)</span>,</span>
<span>         RANK <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">RANK</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">RANK</span>, y <span class="op">=</span> <span class="va">SMI</span>, fill <span class="op">=</span> <span class="va">RANK</span>, color <span class="op">=</span> <span class="va">RANK</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu">geom_violin</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">RANK</span><span class="op">)</span>,</span>
<span>              color <span class="op">=</span> <span class="st">"#8B8B83"</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">0.8</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>              position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">RANK</span><span class="op">)</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>              shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              position <span class="op">=</span> <span class="fu">position_jitterdodge</span><span class="op">(</span>dodge.width <span class="op">=</span> <span class="fl">0.5</span>, jitter.width <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,              </span>
<span>               geom <span class="op">=</span> <span class="st">"crossbar"</span>,       </span>
<span>               width <span class="op">=</span> <span class="fl">0.1</span>,             </span>
<span>               color <span class="op">=</span> <span class="st">"black"</span>,         </span>
<span>               linewidth <span class="op">=</span> <span class="fl">0.5</span>,         </span>
<span>               position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Body Condition (SMI) by Hatching Order"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Hatching Order"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Scaled Mass Index (g)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"#1F78B4"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#E31A1C"</span><span class="op">)</span> <span class="co"># </span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"#1F78B4"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#E31A1C"</span><span class="op">)</span> <span class="co"># </span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"First-Hatched"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Second-Hatched"</span><span class="op">)</span>,</span>
<span>    expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/show_data%20-%20model2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section><section id="run-models-and-interpret-results-1" class="level2"><h2 class="anchored" data-anchor-id="run-models-and-interpret-results-1">Run models and interpret results</h2>
<p>We will fit three progressively complex Bayesian models to the data using the <code>brms</code> package. All models incorporate <code>NEST_ID</code> and <code>YEAR</code> random effects to account for non-independence of chicks within the same nest and observations within the same year.</p>
<p>The models are as follows:</p>
<ol type="a">
<li>Location-only model: Estimates the average difference in Scaled Mass Index (SMI) between the two hatching orders.</li>
<li>Location-scale model: Estimates both the average difference (location) and differences in the variability (scale) of SMI between hatching orders.</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Location model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Location-scale model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Model comparison</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false" href="">Summary of model results</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false" href="">Bonus</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Following the previous section, we first fit a location-only model as our baseline and applied a log-transformation to <code>SMI</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model2_1</span><span class="op">&lt;-</span><span class="fu">glmmTMB</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">SMI</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">RANK</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">NEST</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">WORKYEAR</span><span class="op">)</span>,</span>
<span>              family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model2_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          log(SMI) ~ 1 + RANK + (1 | NEST) + (1 | WORKYEAR)
Data: dat

      AIC       BIC    logLik -2*log(L)  df.resid 
  -8048.8   -8016.5    4029.4   -8058.8      4732 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 NEST     (Intercept) 0.002434 0.04934 
 WORKYEAR (Intercept) 0.008858 0.09412 
 Residual             0.008245 0.09080 
Number of obs: 4737, groups:  NEST, 2873; WORKYEAR, 24

Dispersion estimate for gaussian family (sigma^2): 0.00824 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  7.35953    0.01973   372.9  &lt; 2e-16 ***
RANK2       -0.01872    0.00272    -6.9 5.91e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">model2_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                   2.5 %      97.5 %    Estimate
(Intercept)                   7.32085592  7.39820911  7.35953252
RANK2                        -0.02405065 -0.01338785 -0.01871925
Std.Dev.(Intercept)|NEST      0.04463325  0.05454148  0.04933927
Std.Dev.(Intercept)|WORKYEAR  0.07008890  0.12638674  0.09411859</code></pre>
</div>
</div>
<p>Then we use the ‘DHARMa’ package to simulate residuals and plot them automatically. This step is crucial for checking the model’s assumptions, such as normality and homoscedasticity of residuals.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># | label: model_diagnostics - model0</span></span>
<span><span class="va">simulationOutput</span> <span class="op">&lt;-</span> <span class="fu">simulateResiduals</span><span class="op">(</span>fittedModel <span class="op">=</span> <span class="va">model2_1</span>, plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">simulationOutput</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The QQ plot and Kolmogorov-Smirnov (KS) test reveal that the model’s residuals aren’t uniformly distributed, hinting at potential issues with the chosen distribution or the model’s underlying structure. While tests for overdispersion and outliers showed no significant concerns, the boxplots and Levene test highlight a lack of uniformity within residual groups and non-homogeneous variances. This suggests the model doesn’t fully capture the data’s complexity and might benefit from adjustments, perhaps by incorporating a location-scale model to better handle varying dispersion.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># location-scale model ---- </span></span>
<span></span>
<span><span class="va">model2_2</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">SMI</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">RANK</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">NEST</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">WORKYEAR</span><span class="op">)</span>,</span>
<span>    dispformula <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">RANK</span>,     </span>
<span>    data <span class="op">=</span> <span class="va">dat</span>, </span>
<span>    family <span class="op">=</span> <span class="va">gaussian</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model2_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          log(SMI) ~ 1 + RANK + (1 | NEST) + (1 | WORKYEAR)
Dispersion:                ~1 + RANK
Data: dat

      AIC       BIC    logLik -2*log(L)  df.resid 
  -8070.8   -8032.1    4041.4   -8082.8      4731 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 NEST     (Intercept) 0.002430 0.04929 
 WORKYEAR (Intercept) 0.008595 0.09271 
 Residual                   NA      NA 
Number of obs: 4737, groups:  NEST, 2873; WORKYEAR, 24

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  7.36075    0.01944   378.7  &lt; 2e-16 ***
RANK2       -0.01880    0.00271    -6.9 3.93e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Dispersion model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -2.47026    0.02242 -110.20  &lt; 2e-16 ***
RANK2        0.13035    0.02687    4.85 1.23e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">model2_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        2.5 %      97.5 %    Estimate
cond.(Intercept)                   7.32265786  7.39885037  7.36075412
cond.RANK2                        -0.02411510 -0.01349325 -0.01880417
disp.(Intercept)                  -2.51419214 -2.42631943 -2.47025578
disp.RANK2                         0.07768165  0.18301526  0.13034846
cond.Std.Dev.(Intercept)|NEST      0.04462552  0.05445269  0.04929482
cond.Std.Dev.(Intercept)|WORKYEAR  0.06903183  0.12450065  0.09270657</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Finally, we compare the location-scale model with the location-only model based on AICc values (<code>model.sel()</code> from the <code>MuMIn</code> package).</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">model.sel</span><span class="op">(</span><span class="va">model2_1</span>, <span class="va">model2_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model selection table 
         cnd((Int)) dsp((Int)) cnd(RAN) dsp(RAN) df   logLik    AICc delta
model2_2      7.361      -2.47        +        +  6 4041.417 -8070.8  0.00
model2_1      7.360                   +           5 4029.421 -8048.8 21.99
         weight
model2_2      1
model2_1      0
Models ranked by AICc(x) 
Random terms (all models): 
  cond(1 | NEST), cond(1 | WORKYEAR)</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>The results of the location-only model (Model 0) and the location-scale model (Model 1) are summarized below.</p>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>Here is how to fit the same location-scale model using the <code>brms</code> package for comparison.</p>
<section id="location-only-model" class="level3"><h3 class="anchored" data-anchor-id="location-only-model">Location-only model</h3>
<!-- I will remove the commentout results. -->
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">SMI</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">RANK</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">NEST</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">WORKYEAR</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior1</span><span class="op">&lt;-</span><span class="fu">default_prior</span><span class="op">(</span><span class="va">m1</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">m1</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">prior1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">6000</span>,     </span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,   </span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,  cores<span class="op">=</span><span class="fl">4</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    adapt_delta <span class="op">=</span> <span class="fl">0.99</span>,  <span class="co"># Keep high if you have divergent transitions</span></span>
<span>    max_treedepth <span class="op">=</span> <span class="fl">15</span>   <span class="co"># Keep high if hitting max_treedepth warnings</span></span>
<span>    <span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,      </span>
<span>  refresh <span class="op">=</span> <span class="fl">500</span>    <span class="co"># Less frequent progress updates (reduces overhead)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: log(SMI) ~ (1 | NEST) + (1 | WORKYEAR) + RANK 
   Data: dat (Number of observations: 4737) 
  Draws: 4 chains, each with iter = 6000; warmup = 1000; thin = 1;
         total post-warmup draws = 20000

Multilevel Hyperparameters:
~NEST (Number of levels: 2873) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.05      0.00     0.04     0.05 1.00     4028     7765

~WORKYEAR (Number of levels: 24) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.10      0.02     0.08     0.14 1.00     5145     9062

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     7.36      0.02     7.32     7.40 1.00     2947     5200
RANK2        -0.02      0.00    -0.02    -0.01 1.00    25883    12974

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     0.09      0.00     0.09     0.09 1.00     5732    10919

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section><section id="location-scale-model-2" class="level3"><h3 class="anchored" data-anchor-id="location-scale-model-2">Location-scale model</h3>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">SMI</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">RANK</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">NEST</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">WORKYEAR</span><span class="op">)</span>,</span>
<span>         <span class="va">sigma</span><span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">RANK</span><span class="op">)</span></span>
<span><span class="va">prior2</span> <span class="op">&lt;-</span> <span class="fu">default_prior</span><span class="op">(</span><span class="va">m2</span>,data <span class="op">=</span> <span class="va">dat</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span> <span class="va">m2</span>,</span>
<span> prior<span class="op">=</span> <span class="va">prior2</span>,</span>
<span> data <span class="op">=</span> <span class="va">dat</span>,</span>
<span> family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span> iter <span class="op">=</span> <span class="fl">6000</span>,     </span>
<span> warmup <span class="op">=</span> <span class="fl">1000</span>,   </span>
<span> chains <span class="op">=</span> <span class="fl">4</span>,  cores<span class="op">=</span><span class="fl">4</span>,</span>
<span> backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span> control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>   adapt_delta <span class="op">=</span> <span class="fl">0.99</span>,  <span class="co"># Keep high if you have divergent transitions</span></span>
<span>   max_treedepth <span class="op">=</span> <span class="fl">15</span>   <span class="co"># Keep high if hitting max_treedepth warnings</span></span>
<span> <span class="op">)</span>,</span>
<span> seed <span class="op">=</span> <span class="fl">123</span>,      </span>
<span> refresh <span class="op">=</span> <span class="fl">500</span>    <span class="co"># Less frequent progress updates (reduces overhead)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: log(SMI) ~ 1 + RANK + (1 | NEST) + (1 | WORKYEAR) 
         sigma ~ 1 + RANK
   Data: dat (Number of observations: 4737) 
  Draws: 4 chains, each with iter = 6000; warmup = 1000; thin = 1;
         total post-warmup draws = 20000

Multilevel Hyperparameters:
~NEST (Number of levels: 2873) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.05      0.00     0.04     0.05 1.00     3871     8155

~WORKYEAR (Number of levels: 24) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.10      0.02     0.07     0.14 1.00     3937     7503

Regression Coefficients:
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           7.36      0.02     7.32     7.40 1.00     1826     4007
sigma_Intercept    -2.47      0.02    -2.51    -2.43 1.00     5963    11191
RANK2              -0.02      0.00    -0.02    -0.01 1.00    31665    14172
sigma_RANK2         0.13      0.03     0.08     0.18 1.00    16024    15761

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section><section id="model-comparison-2" class="level3"><h3 class="anchored" data-anchor-id="model-comparison-2">Model comparison</h3>
<!-- Once I finalised the online tutorial, I will remove the `eval: false` option so that the models will be fitted and the results will be displayed in the online tutorial. For now, I will keep the `eval: false` option to avoid errors. -->
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f1loo</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="va">f2loo</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Model comparison </span></span>
<span><span class="va">fc</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html">loo_compare</a></span><span class="op">(</span><span class="va">f1loo</span>, <span class="va">f2loo</span><span class="op">)</span></span>
<span><span class="va">fc</span></span>
<span></span>
<span><span class="co">#     elpd_diff se_diff</span></span>
<span><span class="co"># fit2   0.0       0.0  </span></span>
<span><span class="co"># fit1 -10.3       7.6  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="summary-of-brms-model-results" class="level3"><h3 class="anchored" data-anchor-id="summary-of-brms-model-results">Summary of brms model results</h3>
<!-- Once I finalised the online tutorial, I will remove the `eval: false` option so that the models will be fitted and the results will be displayed in the online tutorial. For now, I will keep the `eval: false` option to avoid errors. -->
<div class="cell">
<div class="cell-output-display">
<div id="vdoogopmbh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vdoogopmbh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vdoogopmbh thead, #vdoogopmbh tbody, #vdoogopmbh tfoot, #vdoogopmbh tr, #vdoogopmbh td, #vdoogopmbh th {
  border-style: none;
}

#vdoogopmbh p {
  margin: 0;
  padding: 0;
}

#vdoogopmbh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vdoogopmbh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vdoogopmbh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vdoogopmbh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vdoogopmbh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vdoogopmbh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vdoogopmbh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vdoogopmbh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vdoogopmbh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vdoogopmbh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vdoogopmbh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vdoogopmbh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vdoogopmbh .gt_spanner_row {
  border-bottom-style: hidden;
}

#vdoogopmbh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vdoogopmbh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vdoogopmbh .gt_from_md > :first-child {
  margin-top: 0;
}

#vdoogopmbh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vdoogopmbh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vdoogopmbh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vdoogopmbh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vdoogopmbh .gt_row_group_first td {
  border-top-width: 2px;
}

#vdoogopmbh .gt_row_group_first th {
  border-top-width: 2px;
}

#vdoogopmbh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vdoogopmbh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vdoogopmbh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vdoogopmbh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vdoogopmbh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vdoogopmbh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vdoogopmbh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vdoogopmbh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vdoogopmbh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vdoogopmbh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vdoogopmbh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vdoogopmbh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vdoogopmbh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vdoogopmbh .gt_left {
  text-align: left;
}

#vdoogopmbh .gt_center {
  text-align: center;
}

#vdoogopmbh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vdoogopmbh .gt_font_normal {
  font-weight: normal;
}

#vdoogopmbh .gt_font_bold {
  font-weight: bold;
}

#vdoogopmbh .gt_font_italic {
  font-style: italic;
}

#vdoogopmbh .gt_super {
  font-size: 65%;
}

#vdoogopmbh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vdoogopmbh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vdoogopmbh .gt_indent_1 {
  text-indent: 5px;
}

#vdoogopmbh .gt_indent_2 {
  text-indent: 10px;
}

#vdoogopmbh .gt_indent_3 {
  text-indent: 15px;
}

#vdoogopmbh .gt_indent_4 {
  text-indent: 20px;
}

#vdoogopmbh .gt_indent_5 {
  text-indent: 25px;
}

#vdoogopmbh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vdoogopmbh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Model 1: Posterior Summary</th>
</tr>
<tr class="gt_col_headings even">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="Std.error" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Std.error</th>
<th id="a95%-CI-(low)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (low)</th>
<th id="a95%-CI-(high)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (high)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="5" id="Location Model" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Location Model</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center" headers="Location Model  Term">Intercept</td>
<td class="gt_row gt_center" headers="Location Model  Estimate">7.359</td>
<td class="gt_row gt_center" headers="Location Model  Std.error">0.022</td>
<td class="gt_row gt_center" headers="Location Model  95% CI (low)">7.316</td>
<td class="gt_row gt_center" headers="Location Model  95% CI (high)">7.403</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Location Model  Term">Second hatched chick</td>
<td class="gt_row gt_center" headers="Location Model  Estimate">−0.019</td>
<td class="gt_row gt_center" headers="Location Model  Std.error">0.003</td>
<td class="gt_row gt_center" headers="Location Model  95% CI (low)">−0.024</td>
<td class="gt_row gt_center" headers="Location Model  95% CI (high)">−0.013</td>
</tr>
<tr class="gt_group_heading_row even">
<td colspan="5" id="Random Effects" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Random Effects</td>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_center" headers="Random Effects  Term">Nest ID</td>
<td class="gt_row gt_center" headers="Random Effects  Estimate">0.049</td>
<td class="gt_row gt_center" headers="Random Effects  Std.error">0.003</td>
<td class="gt_row gt_center" headers="Random Effects  95% CI (low)">0.044</td>
<td class="gt_row gt_center" headers="Random Effects  95% CI (high)">0.054</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Random Effects  Term">Year</td>
<td class="gt_row gt_center" headers="Random Effects  Estimate">0.102</td>
<td class="gt_row gt_center" headers="Random Effects  Std.error">0.017</td>
<td class="gt_row gt_center" headers="Random Effects  95% CI (low)">0.075</td>
<td class="gt_row gt_center" headers="Random Effects  95% CI (high)">0.141</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="5" id="Residual Standard Deviation" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Residual Standard Deviation</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center" headers="Residual Standard Deviation  Term">Sigma</td>
<td class="gt_row gt_center" headers="Residual Standard Deviation  Estimate">0.091</td>
<td class="gt_row gt_center" headers="Residual Standard Deviation  Std.error">0.001</td>
<td class="gt_row gt_center" headers="Residual Standard Deviation  95% CI (low)">0.088</td>
<td class="gt_row gt_center" headers="Residual Standard Deviation  95% CI (high)">0.094</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div id="udposiwjmv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#udposiwjmv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#udposiwjmv thead, #udposiwjmv tbody, #udposiwjmv tfoot, #udposiwjmv tr, #udposiwjmv td, #udposiwjmv th {
  border-style: none;
}

#udposiwjmv p {
  margin: 0;
  padding: 0;
}

#udposiwjmv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#udposiwjmv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#udposiwjmv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#udposiwjmv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#udposiwjmv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#udposiwjmv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#udposiwjmv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#udposiwjmv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#udposiwjmv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#udposiwjmv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#udposiwjmv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#udposiwjmv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#udposiwjmv .gt_spanner_row {
  border-bottom-style: hidden;
}

#udposiwjmv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#udposiwjmv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#udposiwjmv .gt_from_md > :first-child {
  margin-top: 0;
}

#udposiwjmv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#udposiwjmv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#udposiwjmv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#udposiwjmv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#udposiwjmv .gt_row_group_first td {
  border-top-width: 2px;
}

#udposiwjmv .gt_row_group_first th {
  border-top-width: 2px;
}

#udposiwjmv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#udposiwjmv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#udposiwjmv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#udposiwjmv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#udposiwjmv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#udposiwjmv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#udposiwjmv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#udposiwjmv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#udposiwjmv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#udposiwjmv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#udposiwjmv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#udposiwjmv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#udposiwjmv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#udposiwjmv .gt_left {
  text-align: left;
}

#udposiwjmv .gt_center {
  text-align: center;
}

#udposiwjmv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#udposiwjmv .gt_font_normal {
  font-weight: normal;
}

#udposiwjmv .gt_font_bold {
  font-weight: bold;
}

#udposiwjmv .gt_font_italic {
  font-style: italic;
}

#udposiwjmv .gt_super {
  font-size: 65%;
}

#udposiwjmv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#udposiwjmv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#udposiwjmv .gt_indent_1 {
  text-indent: 5px;
}

#udposiwjmv .gt_indent_2 {
  text-indent: 10px;
}

#udposiwjmv .gt_indent_3 {
  text-indent: 15px;
}

#udposiwjmv .gt_indent_4 {
  text-indent: 20px;
}

#udposiwjmv .gt_indent_5 {
  text-indent: 25px;
}

#udposiwjmv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#udposiwjmv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Model 2: Posterior Summary</th>
</tr>
<tr class="gt_col_headings even">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="Std.error" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Std.error</th>
<th id="a95%-CI-(low)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (low)</th>
<th id="a95%-CI-(high)" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (high)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="5" id="Location Submodel" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Location Submodel</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center" headers="Location Submodel  Term">Intercept</td>
<td class="gt_row gt_center" headers="Location Submodel  Estimate">7.360</td>
<td class="gt_row gt_center" headers="Location Submodel  Std.error">0.021</td>
<td class="gt_row gt_center" headers="Location Submodel  95% CI (low)">7.318</td>
<td class="gt_row gt_center" headers="Location Submodel  95% CI (high)">7.402</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Location Submodel  Term">Second hatched chick</td>
<td class="gt_row gt_center" headers="Location Submodel  Estimate">−0.019</td>
<td class="gt_row gt_center" headers="Location Submodel  Std.error">0.003</td>
<td class="gt_row gt_center" headers="Location Submodel  95% CI (low)">−0.024</td>
<td class="gt_row gt_center" headers="Location Submodel  95% CI (high)">−0.014</td>
</tr>
<tr class="gt_group_heading_row even">
<td colspan="5" id="Scale Submodel" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Scale Submodel</td>
</tr>
<tr class="gt_row_group_first odd">
<td class="gt_row gt_center" headers="Scale Submodel  Term">Intercept (sigma)</td>
<td class="gt_row gt_center" headers="Scale Submodel  Estimate">−2.469</td>
<td class="gt_row gt_center" headers="Scale Submodel  Std.error">0.022</td>
<td class="gt_row gt_center" headers="Scale Submodel  95% CI (low)">−2.514</td>
<td class="gt_row gt_center" headers="Scale Submodel  95% CI (high)">−2.426</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Scale Submodel  Term">Second hatched chick (sigma)</td>
<td class="gt_row gt_center" headers="Scale Submodel  Estimate">0.130</td>
<td class="gt_row gt_center" headers="Scale Submodel  Std.error">0.027</td>
<td class="gt_row gt_center" headers="Scale Submodel  95% CI (low)">0.077</td>
<td class="gt_row gt_center" headers="Scale Submodel  95% CI (high)">0.182</td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="5" id="Random effects" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Random effects</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_center" headers="Random effects  Term">Nest ID</td>
<td class="gt_row gt_center" headers="Random effects  Estimate">0.049</td>
<td class="gt_row gt_center" headers="Random effects  Std.error">0.003</td>
<td class="gt_row gt_center" headers="Random effects  95% CI (low)">0.044</td>
<td class="gt_row gt_center" headers="Random effects  95% CI (high)">0.054</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Random effects  Term">Year</td>
<td class="gt_row gt_center" headers="Random effects  Estimate">0.100</td>
<td class="gt_row gt_center" headers="Random effects  Std.error">0.017</td>
<td class="gt_row gt_center" headers="Random effects  95% CI (low)">0.073</td>
<td class="gt_row gt_center" headers="Random effects  95% CI (high)">0.139</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
<section id="comparison-of-location-only-model-and-location-scale-model-1" class="level3"><h3 class="anchored" data-anchor-id="comparison-of-location-only-model-and-location-scale-model-1">Comparison of location-only model and location-scale model</h3>
<p>The location-scale model (Model 2) was the most-supported model based on AICc values (-8070.8) compared to the location-only model (-8048.8; see <code>Model comparison</code> tab for details).</p>
</section><section id="interpretation-of-location-scale-model-1" class="level3"><h3 class="anchored" data-anchor-id="interpretation-of-location-scale-model-1">Interpretation of location-scale model :</h3>
<p><strong>Location (mean) part:</strong></p>
<ul>
<li>There was a conclusive effect of hatching order on the mean of <code>log(SMI)</code>, with second-hatched chicks having a lower SMI than first-hatched chicks (<span class="math inline">\(\beta_{[\text{first-second}]}^{(l)}\)</span> = -0.018, 95% CI = [-0.024, -0.013]).</li>
</ul>
<p><strong>Scale (dispersion) part:</strong></p>
<ul>
<li>The scale component revealed a conclusive difference in the variability of SMI between hatching orders. The second-hatched chicks exhibited greater variability in SMI compared to first-hatched chicks (<span class="math inline">\(\beta_{[\text{first-second}]}^{(s)}\)</span> = 0.130, 95% CI = [0.077, 0.183]).</li>
</ul>
<p><strong>Location (mean) random effects:</strong></p>
<ul>
<li><p>There is very little variation in the average body condition across different nests (<span class="math inline">\(\sigma_{[\text{Nest\_ID}]}^{(l)}\)</span> = 0.049, 95% CI [0.044, 0.054]), suggesting that most nests have similar average body conditions for their chicks.</p></li>
<li><p>There is also very little variation in the average body condition across different years (<span class="math inline">\(\sigma_{[\text{Year}]}^{(l)}\)</span> = 0.092, 95% CI [0.069, 0.124]),implying generally consistent average body conditions from year to year.</p></li>
</ul></section></section><section id="conclusion-1" class="level2"><h2 class="anchored" data-anchor-id="conclusion-1">Conclusion</h2>
<p><strong>Do first hatched chicks have a higher body mass than second-hatched chicks?</strong></p>
<p>Answer: Answer: Yes, first-hatched chicks have a significantly higher Scaled Mass Index (SMI) than second-hatched chicks at fledging, with a mean difference of approximately 0.018 on the log scale.</p>
<p><strong>Does the variability in body mass differ between first and second-hatched chicks?</strong></p>
<p>Answer: Yes, the variability in body mass (SMI) is significantly greater in second-hatched chicks compared to first-hatched chicks. This indicates that second-hatched chicks show more variation in their body condition at fledging.</p>
</section></section><section id="double-hierarchical-location-scale-model-model-3" class="level1"><h1>Double-hierarchical location-scale model (Model 3)</h1>
<p>Following up on the previous example analyzing the scaled mass index (SMI) at fledging <a href="https://doi.org/10.1093/beheco/araf050">Drummond et al(2025)</a>, we now extend our approach by fitting a double-hierarchical Gaussian location-scale model. This extends Model 2 by introducing nest identity as a correlated random effect in both the location (mean) and scale (variance) components. This extension allows us to examine not only how average <code>log(SMI)</code> and its variability differ across nests, but also whether these two forms of nest-level variation are correlated. The main distinction between Model 2 and Model 3 lies in how they handle variation. Model 2 includes random effects only for the mean, assuming constant variance across groups. In contrast, Model 3 accounts for group-level variability by including random effects in both the mean and the variance components. This makes Model 3 particularly useful when:</p>
<ul>
<li>Group-level variability (heteroscedasticity) is present</li>
</ul>
<!-- --><ul>
<li><p>There may be a correlation between group-level means and variances (e.g., nests with higher average SMI also show more variability)</p></li>
<li><p>Both the average and variability are biologically meaningful or expected to vary across groups</p></li>
</ul>
<p>By modeling variation explicitly, Model 3 can yield better fit and more nuanced inference, especially in ecological or evolutionary contexts where both central tendencies and dispersion carry important signals.</p>
<section id="dataset-overview-2" class="level2"><h2 class="anchored" data-anchor-id="dataset-overview-2">Dataset overview</h2>
<p>We use the same dataset as in Model 2, but extend the location-scale framework by moving from Model 2 to Model 3, a double-hierarchical location-scale model. This extension allows us to model group-level variation in both the mean (location) and the variance (scale), as well as their potential correlation.</p>
<section id="question" class="level3"><h3 class="anchored" data-anchor-id="question">Question</h3>
<p><strong>Variation between and within nests</strong> Do nests with generally healthier (heavier) chicks also tend to have chicks that are more similar in their body condition?</p>
</section></section><section id="run-models-and-interpret-results-2" class="level2"><h2 class="anchored" data-anchor-id="run-models-and-interpret-results-2">Run models and interpret results</h2>
<p>In this section, we compare Model 1 and Model 3 using the <code>brms</code> package, since <code>glmmTMB</code> does not support estimating correlations between random effects in the location and scale components. Model 3 - the double-hierarchical location-scale model - extends Model 2 by incorporating random effects for NEST_ID in both the mean and the variability of SMI. Crucially, it also estimates the correlation between these nest-level effects. For instance, a positive correlation would indicate that nests with higher average SMI also exhibit greater variability in SMI.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Double-hierarchical Location-scale model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Model comparison</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">Summary of model results</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">SMI</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">RANK</span><span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">q</span><span class="op">|</span><span class="va">NEST</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">WORKYEAR</span><span class="op">)</span>,</span>
<span>         <span class="va">sigma</span><span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">RANK</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">q</span><span class="op">|</span><span class="va">NEST</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">WORKYEAR</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior3</span><span class="op">&lt;-</span><span class="fu">default_prior</span><span class="op">(</span><span class="va">m3</span>,data <span class="op">=</span> <span class="va">dat</span>,family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">m3</span>,</span>
<span>  prior<span class="op">=</span> <span class="va">prior3</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">6000</span>,     </span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,   </span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,  </span>
<span>  cores<span class="op">=</span><span class="fl">4</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    adapt_delta <span class="op">=</span> <span class="fl">0.99</span>,  </span>
<span>    max_treedepth <span class="op">=</span> <span class="fl">15</span>  </span>
<span>    <span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,      </span>
<span>  refresh <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = log 
Formula: log(SMI) ~ (1 | q | NEST) + (1 | WORKYEAR) + RANK 
         sigma ~ (1 | q | NEST) + (1 | WORKYEAR) + RANK
   Data: dat (Number of observations: 4737) 
  Draws: 4 chains, each with iter = 6000; warmup = 1000; thin = 1;
         total post-warmup draws = 20000

Multilevel Hyperparameters:
~NEST (Number of levels: 2873) 
                               Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)                      0.05      0.00     0.04     0.05 1.00
sd(sigma_Intercept)                0.36      0.02     0.32     0.40 1.00
cor(Intercept,sigma_Intercept)    -0.46      0.07    -0.58    -0.33 1.00
                               Bulk_ESS Tail_ESS
sd(Intercept)                      3596     7826
sd(sigma_Intercept)                4668     9783
cor(Intercept,sigma_Intercept)     3805     7596

~WORKYEAR (Number of levels: 24) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)           0.10      0.02     0.07     0.14 1.00     5949    10071
sd(sigma_Intercept)     0.28      0.06     0.18     0.41 1.00     8421    12541

Regression Coefficients:
                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept           7.36      0.02     7.32     7.40 1.00     3428     6959
sigma_Intercept    -2.52      0.07    -2.65    -2.38 1.00     5030     8529
RANK2              -0.01      0.00    -0.02    -0.01 1.00    24251    17886
sigma_RANK2         0.13      0.03     0.07     0.19 1.00    19128    15170

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>We compare the double-hierarchical location-scale model (Model 3) with the previous location-only model (Model 1) to examine whether the added complexity of Model 3 leads to a better fit to the data.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f1loo</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="va">f3loo</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Model comparison </span></span>
<span><span class="va">fc2</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html">loo_compare</a></span><span class="op">(</span><span class="va">f1loo</span>, <span class="va">f3loo</span><span class="op">)</span></span>
<span><span class="va">fc2</span></span>
<span><span class="co">#  elpd_diff se_diff</span></span>
<span><span class="co"># fit3    0.0       0.0 </span></span>
<span><span class="co"># fit1 -357.2      37.4 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>The impact of including random effects in the scale component becomes clear when comparing the results of Model 1 with those of the double-hierarchical location-scale model (Model 3).</p>
</div>
</div>
</div>
<section id="comparison-of-location-only-model-and-location-scale-model-2" class="level3"><h3 class="anchored" data-anchor-id="comparison-of-location-only-model-and-location-scale-model-2">Comparison of location-only model and location-scale model</h3>
<p>The model comparison results indicate that the double-hierarchical location-scale model (Model 3) is the most supported by the data, as it has the lowest LOO (Leave-One-Out Cross-Validation) information criterion value. This suggests that this model provides the best fit to the data while accounting for both the average differences in body condition and the variability in body condition between first and second-hatched chicks.</p>
</section><section id="interpretation-of-location-scale-model-2" class="level3"><h3 class="anchored" data-anchor-id="interpretation-of-location-scale-model-2">Interpretation of location-scale model :</h3>
<p><strong>Scale (dispersion) random effects:</strong></p>
<ul>
<li><p>There is notable variation in body condition within nests (<span class="math inline">\(\sigma_{[\text{Nest\_ID}]}^{(s)}\)</span> = 0.37, 95% CI [0.316, 0.399]). This indicates that some nests consistently produce chicks with more consistent body conditions than others.</p></li>
<li><p>The consistency of chick body conditions varies notably across work years (<span class="math inline">\(\sigma_{[\text{Year}]}^{(s)}\)</span> = 0.277, 95% CI [0.183, 0.411]), implying some years yield chicks with more consistent body conditions than others.</p></li>
</ul>
<p><strong>Correlation between location and scale random effects:</strong></p>
<ul>
<li>The correlation between the nest-specific random effects for the average body condition and the variability in body condition is negative (<span class="math inline">\(\rho_{[\text{Nest\_ID}]}\)</span> = -0.457, 95% CI [-0.584, -0.326]). This suggests that nests with higher average body conditions tend to produce chicks with more consistent body condition values (less dispersion).</li>
</ul></section></section><section id="conclusion-2" class="level2"><h2 class="anchored" data-anchor-id="conclusion-2">Conclusion</h2>
<p><strong>Do nests with generally healthier (heavier) chicks also tend to have chicks that are more similar in their body condition?</strong></p>
<p>Answer: Yes, there’s a tendency for nests with higher average chick body condition to also exhibit greater consistency among their chicks’ body conditions. This is supported by a negative correlation between nest-specific average body condition and its variability.</p>
</section></section><section id="beyond-gaussian-1" class="level1 page-columns page-full"><h1>Beyond Gaussian 1</h1>
<p>This dataset comes from <a href="https://doi.org/10.1098/rsos.231057">Mizuno and Soma (2023)</a>, which investigates the visual preferences of estrildid finches. The study measured how often birds gazed at different visual stimuli (white dots vs.&nbsp;white stripes) under two conditions: food-deprived and food-supplied. The research originally tested the sensory bias hypothesis, which suggests that a pre-existing preference for whitish, round objects (like seeds) may have influenced the evolution of plumage patterns.</p>
<p>Here, to keep things simple, we use only a subset of the data related to the white dot pattern stimulus. We analyse how gaze frequency toward dot stimuli differs between the two conditions (food-deprived vs.&nbsp;food-supplied), using a location-scale model with a negative binomial distribution.</p>
<p>Although this model includes two random effects (individual and species), it follows the same basic structure as Model 2 - the only difference is that we use a non-Gaussian distribution (negative binomial) instead of a Gaussian one.</p>
<section id="questions-2" class="level3"><h3 class="anchored" data-anchor-id="questions-2">Questions</h3>
<ol type="1">
<li><strong>Do birds gaze at dot patterns more (or less) when food-deprived compared to food-supplied?</strong></li>
<li><strong>Does the variability in gaze responses differ between conditions?</strong></li>
</ol></section><section id="variables-included-1" class="level3"><h3 class="anchored" data-anchor-id="variables-included-1">Variables included</h3>
<p>The dataset contains the following variables:</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>
<code>species</code> and <code>phylo</code>: The species of the bird (12 species).</li>
<li>
<code>id</code>: The individual bird’s ID.</li>
<li>
<code>sex</code>: Male or female.</li>
<li>
<code>condition</code>: The condition under which the data was collected (food-deprived or food-supplied).</li>
<li>
<code>frequency</code>: The total frequency of gazes towards the stimulus over a 1-hour period.</li>
<li>
<code>p_dot</code>: Having plumage dot patterns or not.</li>
<li>
<code>termite</code>: The presence of termite-eating diet.</li>
</ul>
</div>
</div>
</div>
</section><section id="visualise-the-datasets-1" class="level2"><h2 class="anchored" data-anchor-id="visualise-the-datasets-1">Visualise the datasets</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Condition</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Species</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>First, we visualise the data to understand how gaze frequency varies by condition and species.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># load the dataset ----</span></span>
<span><span class="va">dat_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"AM_preference.csv"</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_pref</span> <span class="op">&lt;-</span> <span class="va">dat_pref</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">stripe</span>, <span class="op">-</span><span class="va">full</span>, <span class="op">-</span><span class="va">subset</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>frequency <span class="op">=</span> <span class="va">dot</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>species <span class="op">=</span> <span class="va">phylo</span>, <span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">condition</span>, <span class="va">sex</span><span class="op">)</span>, <span class="va">as.factor</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat_pref</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,</span>
<span>                     y <span class="op">=</span> <span class="va">frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_violin</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#8B8B83"</span>, fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">1.2</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Total frequency of gazes towards dot patterns"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total frequency of gazes (1hr)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_shape_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span> <span class="op">=</span> <span class="fl">17</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span> <span class="op">=</span> <span class="st">"Male"</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span> <span class="op">=</span> <span class="st">"#009ACD"</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="st">"#FF4D4D"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span> <span class="op">=</span> <span class="st">"Male"</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/show_data-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>The plot breaks down the same gaze data by species. Each point is a bird’s gaze frequency under a condition. Colored lines represent species-specific means across conditions, helping to visualise - how different species vary in their average gazing behaviour, whether species respond differently to food deprivation. Faceting by species can help compare species-level patterns.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat_pref</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Total frequency of gazes towards dot patterns by species"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total frequency of gazes (1hr)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"line"</span>, <span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="va">species</span>, color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">species</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/show_data2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="run-models-and-interpret-results-3" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="run-models-and-interpret-results-3">Run models and interpret results</h2>
<p>We fit and compare two types of models to analyse gaze frequency toward white dot patterns using the <code>glmmTMB</code> package:</p>
<ul>
<li><p>Location-only model: Estimates how the mean gaze frequency varies between the two experimental conditions (<code>food-deprived</code> vs.&nbsp;<code>food-supplied</code>).</p></li>
<li><p>Location-scale model: Estimates how both the mean and the variability (<code>dispersion</code>) of gaze frequency vary between conditions.</p></li>
</ul>
<p>These models help us examine whether internal states such as hunger (represented by food deprivation) influence not only the average number of gazes, but also the species/individual variability in gaze behaviour. Such variability may reflect differences in exploratory tendencies among species/individuals. Please note that in this section, species are not modelled with phylogenetic relatedness. For an example of how to fit a location–scale phylogenetic regression model, see <em>Section Model selection (example 2)</em>.</p>
<section id="model-fitting-1" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="model-fitting-1">Model fitting</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset page-columns page-full">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Location model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Residual diagnostics</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">Location-scale model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false" href="">Model comparison</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false" href="">Summary of model results</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false" href="">Bonus 1 - Conway-Maxwell-Poisson (CMP) model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false" href="">Bonus 2 - brms</a></li>
</ul>
<div class="tab-content page-columns page-full">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>We use negative binomial model here, as the response variable <code>frequency</code> is a count of gazes and may exhibit overdispersion. In The <code>glmmTMB</code> package, we can specify the family as <code>nbinom2</code> for negative binomial distribution with a log link function.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># location model ----</span></span>
<span><span class="co">## the mean (location) of gaze frequency with condition and sex as fixed effects; assumes constant variance.</span></span>
<span></span>
<span><span class="va">model_0</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span>  <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># location part (mean)</span></span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">nbinom2</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          frequency ~ 1 + condition + sex + (1 | species) + (1 | id)
Data: dat_pref

      AIC       BIC    logLik -2*log(L)  df.resid 
   2176.3    2195.8   -1082.2    2164.3       184 

Random effects:

Conditional model:
 Groups  Name        Variance Std.Dev.
 species (Intercept) 0.3725   0.6103  
 id      (Intercept) 0.1353   0.3679  
Number of obs: 190, groups:  species, 12; id, 95

Dispersion parameter for nbinom2 family (): 1.72 

Conditional model:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        4.84086    0.22151  21.854  &lt; 2e-16 ***
conditionsupplied -0.92168    0.12080  -7.630 2.36e-14 ***
sexM              -0.06673    0.14422  -0.463    0.644    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">model_0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 2.5 %     97.5 %   Estimate
(Intercept)                  4.4067149  5.2750101  4.8408625
conditionsupplied           -1.1584490 -0.6849075 -0.9216782
sexM                        -0.3493977  0.2159315 -0.0667331
Std.Dev.(Intercept)|species  0.3467243  1.0743326  0.6103255
Std.Dev.(Intercept)|id       0.2105812  0.6427136  0.3678905</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>For Gaussian models, we can use the Q-Q plot to show whether the residuals fall along a straight line. However, for non-Gaussian models, we can use the <code>DHARMa</code> package to check the residuals. The <code>DHARMa</code> package provides a set of diagnostic tools for generalized linear mixed models (GLMMs) and allows us to simulate residuals and check for overdispersion, outliers, and uniformity.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># location-only model (NB) ----</span></span>
<span><span class="co"># main diagnostic plots</span></span>
<span><span class="va">model0_res</span> <span class="op">&lt;-</span> <span class="fu">simulateResiduals</span><span class="op">(</span><span class="va">model_0</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/residual_diagnostics%20-%20nb%20model-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># formal test for over/underdispersion</span></span>
<span><span class="fu">testDispersion</span><span class="op">(</span><span class="va">model0_res</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/residual_diagnostics%20-%20nb%20model-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.45606, p-value = 0.456
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The <code>DHARMa</code> diagnostics indicate no issues with overdispersion or outliers (Dispersion test: <code>p = 0.456</code>; Outlier test: <code>p = 0.88</code>). However, the KS test for uniformity is significant (<code>p = 2e-05</code>), suggesting deviation from the expected residual distribution. Additionally, residuals show non-uniform patterns across levels of the categorical predictor (catPred), and the Levene’s test indicates heterogeneity of variance among groups. These results suggest that the model may not fully capture the structure associated with the categorical predictor.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>The result from<code>DHARMa</code> diagnostics suggests that the location-only model may not fully capture the structure of the data. Therefore, we can fit a location-scale model to account for both the mean and variance of the response variable.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># location-scale model ---- </span></span>
<span><span class="co"># both the mean (location) and the variance (scale) as functions of condition and sex.</span></span>
<span></span>
<span><span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>   dispformula <span class="op">=</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span>,     </span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>,                          </span>
<span>  family <span class="op">=</span> <span class="fu">nbinom2</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          frequency ~ 1 + condition + sex + (1 | species) + (1 | id)
Dispersion:                 ~condition + sex
Data: dat_pref

      AIC       BIC    logLik -2*log(L)  df.resid 
     2172      2198     -1078      2156       182 

Random effects:

Conditional model:
 Groups  Name        Variance Std.Dev.
 species (Intercept) 0.3047   0.5520  
 id      (Intercept) 0.1173   0.3425  
Number of obs: 190, groups:  species, 12; id, 95

Conditional model:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         4.8737     0.2042  23.868  &lt; 2e-16 ***
conditionsupplied  -0.8452     0.1206  -7.010 2.38e-12 ***
sexM               -0.1040     0.1370  -0.759    0.448    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Dispersion model:
                  Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)         0.8394     0.2597   3.232  0.00123 **
conditionsupplied  -0.6616     0.2480  -2.667  0.00765 **
sexM                0.1320     0.2486   0.531  0.59549   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">model_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      2.5 %     97.5 %   Estimate
cond.(Intercept)                  4.4734822  5.2739084  4.8736953
cond.conditionsupplied           -1.0814991 -0.6088973 -0.8451982
cond.sexM                        -0.3725499  0.1646364 -0.1039568
disp.(Intercept)                  0.3303327  1.3485194  0.8394261
disp.conditionsupplied           -1.1476836 -0.1754389 -0.6615612
disp.sexM                        -0.3552045  0.6191168  0.1319561
cond.Std.Dev.(Intercept)|species  0.3079456  0.9894436  0.5519916
cond.Std.Dev.(Intercept)|id       0.1719628  0.6820707  0.3424774</code></pre>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>Let’s compare the two models to see if the location-scale model provides a better fit to the data than the location-only model.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compare models ----</span></span>
<span><span class="fu">model.sel</span><span class="op">(</span><span class="va">model_0</span>, <span class="va">model_1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model selection table 
        cond((Int)) dsp((Int)) cond(cndt) cond(sex) dsp(cndt) dsp(sex) df
model_1       4.874     0.8394          +         +         +        +  8
model_0       4.841                     +         +                     6
           logLik   AICc delta weight
model_1 -1078.021 2172.8  0.00  0.877
model_0 -1082.155 2176.8  3.93  0.123
Models ranked by AICc(x) 
Random terms (all models): 
  cond(1 | species), cond(1 | id)</code></pre>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<p>You can quickly check the results of the location-only model (model 0) and the location-scale model (model 1) below.</p>
<div class="cell">
<div class="cell-output-display">
<div id="ayjdrzqoxg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ayjdrzqoxg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ayjdrzqoxg thead, #ayjdrzqoxg tbody, #ayjdrzqoxg tfoot, #ayjdrzqoxg tr, #ayjdrzqoxg td, #ayjdrzqoxg th {
  border-style: none;
}

#ayjdrzqoxg p {
  margin: 0;
  padding: 0;
}

#ayjdrzqoxg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ayjdrzqoxg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ayjdrzqoxg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ayjdrzqoxg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ayjdrzqoxg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ayjdrzqoxg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ayjdrzqoxg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ayjdrzqoxg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ayjdrzqoxg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ayjdrzqoxg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ayjdrzqoxg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ayjdrzqoxg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ayjdrzqoxg .gt_spanner_row {
  border-bottom-style: hidden;
}

#ayjdrzqoxg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ayjdrzqoxg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ayjdrzqoxg .gt_from_md > :first-child {
  margin-top: 0;
}

#ayjdrzqoxg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ayjdrzqoxg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ayjdrzqoxg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ayjdrzqoxg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ayjdrzqoxg .gt_row_group_first td {
  border-top-width: 2px;
}

#ayjdrzqoxg .gt_row_group_first th {
  border-top-width: 2px;
}

#ayjdrzqoxg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ayjdrzqoxg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ayjdrzqoxg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ayjdrzqoxg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ayjdrzqoxg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ayjdrzqoxg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ayjdrzqoxg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ayjdrzqoxg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ayjdrzqoxg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ayjdrzqoxg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ayjdrzqoxg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ayjdrzqoxg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ayjdrzqoxg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ayjdrzqoxg .gt_left {
  text-align: left;
}

#ayjdrzqoxg .gt_center {
  text-align: center;
}

#ayjdrzqoxg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ayjdrzqoxg .gt_font_normal {
  font-weight: normal;
}

#ayjdrzqoxg .gt_font_bold {
  font-weight: bold;
}

#ayjdrzqoxg .gt_font_italic {
  font-style: italic;
}

#ayjdrzqoxg .gt_super {
  font-size: 65%;
}

#ayjdrzqoxg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ayjdrzqoxg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ayjdrzqoxg .gt_indent_1 {
  text-indent: 5px;
}

#ayjdrzqoxg .gt_indent_2 {
  text-indent: 10px;
}

#ayjdrzqoxg .gt_indent_3 {
  text-indent: 15px;
}

#ayjdrzqoxg .gt_indent_4 {
  text-indent: 20px;
}

#ayjdrzqoxg .gt_indent_5 {
  text-indent: 25px;
}

#ayjdrzqoxg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ayjdrzqoxg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Location-only model</th>
</tr>
<tr class="gt_col_headings even">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="StdError" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Std. Error</th>
<th id="CI_low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (low)</th>
<th id="CI_high" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (high)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Term">(Intercept)</td>
<td class="gt_row gt_center" headers="Estimate">4.841</td>
<td class="gt_row gt_center" headers="StdError">0.222</td>
<td class="gt_row gt_center" headers="CI_low">4.407</td>
<td class="gt_row gt_center" headers="CI_high">5.275</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">conditionsupplied</td>
<td class="gt_row gt_center" headers="Estimate">−0.922</td>
<td class="gt_row gt_center" headers="StdError">0.121</td>
<td class="gt_row gt_center" headers="CI_low">−1.158</td>
<td class="gt_row gt_center" headers="CI_high">−0.685</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Term">sexM</td>
<td class="gt_row gt_center" headers="Estimate">−0.067</td>
<td class="gt_row gt_center" headers="StdError">0.144</td>
<td class="gt_row gt_center" headers="CI_low">−0.349</td>
<td class="gt_row gt_center" headers="CI_high">0.216</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="dyentzroci" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dyentzroci table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dyentzroci thead, #dyentzroci tbody, #dyentzroci tfoot, #dyentzroci tr, #dyentzroci td, #dyentzroci th {
  border-style: none;
}

#dyentzroci p {
  margin: 0;
  padding: 0;
}

#dyentzroci .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dyentzroci .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dyentzroci .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dyentzroci .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dyentzroci .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dyentzroci .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dyentzroci .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dyentzroci .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dyentzroci .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dyentzroci .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dyentzroci .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dyentzroci .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dyentzroci .gt_spanner_row {
  border-bottom-style: hidden;
}

#dyentzroci .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dyentzroci .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dyentzroci .gt_from_md > :first-child {
  margin-top: 0;
}

#dyentzroci .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dyentzroci .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dyentzroci .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dyentzroci .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dyentzroci .gt_row_group_first td {
  border-top-width: 2px;
}

#dyentzroci .gt_row_group_first th {
  border-top-width: 2px;
}

#dyentzroci .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dyentzroci .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dyentzroci .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dyentzroci .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dyentzroci .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dyentzroci .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dyentzroci .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dyentzroci .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dyentzroci .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dyentzroci .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dyentzroci .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dyentzroci .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dyentzroci .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dyentzroci .gt_left {
  text-align: left;
}

#dyentzroci .gt_center {
  text-align: center;
}

#dyentzroci .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dyentzroci .gt_font_normal {
  font-weight: normal;
}

#dyentzroci .gt_font_bold {
  font-weight: bold;
}

#dyentzroci .gt_font_italic {
  font-style: italic;
}

#dyentzroci .gt_super {
  font-size: 65%;
}

#dyentzroci .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dyentzroci .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dyentzroci .gt_indent_1 {
  text-indent: 5px;
}

#dyentzroci .gt_indent_2 {
  text-indent: 10px;
}

#dyentzroci .gt_indent_3 {
  text-indent: 15px;
}

#dyentzroci .gt_indent_4 {
  text-indent: 20px;
}

#dyentzroci .gt_indent_5 {
  text-indent: 25px;
}

#dyentzroci .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dyentzroci div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Location-scale model (location part)</th>
</tr>
<tr class="gt_col_headings even">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="StdError" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Std. Error</th>
<th id="CI_low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (low)</th>
<th id="CI_high" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (high)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Term">(Intercept)</td>
<td class="gt_row gt_center" headers="Estimate">4.874</td>
<td class="gt_row gt_center" headers="StdError">0.204</td>
<td class="gt_row gt_center" headers="CI_low">4.473</td>
<td class="gt_row gt_center" headers="CI_high">5.274</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">conditionsupplied</td>
<td class="gt_row gt_center" headers="Estimate">−0.845</td>
<td class="gt_row gt_center" headers="StdError">0.121</td>
<td class="gt_row gt_center" headers="CI_low">−1.081</td>
<td class="gt_row gt_center" headers="CI_high">−0.609</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Term">sexM</td>
<td class="gt_row gt_center" headers="Estimate">−0.104</td>
<td class="gt_row gt_center" headers="StdError">0.137</td>
<td class="gt_row gt_center" headers="CI_low">−0.373</td>
<td class="gt_row gt_center" headers="CI_high">0.165</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell-output-display">
<div id="ydemetbhcz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ydemetbhcz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ydemetbhcz thead, #ydemetbhcz tbody, #ydemetbhcz tfoot, #ydemetbhcz tr, #ydemetbhcz td, #ydemetbhcz th {
  border-style: none;
}

#ydemetbhcz p {
  margin: 0;
  padding: 0;
}

#ydemetbhcz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ydemetbhcz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ydemetbhcz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ydemetbhcz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ydemetbhcz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ydemetbhcz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydemetbhcz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ydemetbhcz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ydemetbhcz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ydemetbhcz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ydemetbhcz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ydemetbhcz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ydemetbhcz .gt_spanner_row {
  border-bottom-style: hidden;
}

#ydemetbhcz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ydemetbhcz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ydemetbhcz .gt_from_md > :first-child {
  margin-top: 0;
}

#ydemetbhcz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ydemetbhcz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ydemetbhcz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ydemetbhcz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ydemetbhcz .gt_row_group_first td {
  border-top-width: 2px;
}

#ydemetbhcz .gt_row_group_first th {
  border-top-width: 2px;
}

#ydemetbhcz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydemetbhcz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ydemetbhcz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ydemetbhcz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydemetbhcz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydemetbhcz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ydemetbhcz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ydemetbhcz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ydemetbhcz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydemetbhcz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ydemetbhcz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydemetbhcz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ydemetbhcz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydemetbhcz .gt_left {
  text-align: left;
}

#ydemetbhcz .gt_center {
  text-align: center;
}

#ydemetbhcz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ydemetbhcz .gt_font_normal {
  font-weight: normal;
}

#ydemetbhcz .gt_font_bold {
  font-weight: bold;
}

#ydemetbhcz .gt_font_italic {
  font-style: italic;
}

#ydemetbhcz .gt_super {
  font-size: 65%;
}

#ydemetbhcz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ydemetbhcz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ydemetbhcz .gt_indent_1 {
  text-indent: 5px;
}

#ydemetbhcz .gt_indent_2 {
  text-indent: 10px;
}

#ydemetbhcz .gt_indent_3 {
  text-indent: 15px;
}

#ydemetbhcz .gt_indent_4 {
  text-indent: 20px;
}

#ydemetbhcz .gt_indent_5 {
  text-indent: 25px;
}

#ydemetbhcz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ydemetbhcz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border">Location-scale model (dispersion part)</th>
</tr>
<tr class="gt_col_headings even">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="Estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Estimate</th>
<th id="StdError" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Std. Error</th>
<th id="CI_low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (low)</th>
<th id="CI_high" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">95% CI (high)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="Term">(Intercept)</td>
<td class="gt_row gt_center" headers="Estimate">0.839</td>
<td class="gt_row gt_center" headers="StdError">0.260</td>
<td class="gt_row gt_center" headers="CI_low">0.330</td>
<td class="gt_row gt_center" headers="CI_high">1.349</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Term">conditionsupplied</td>
<td class="gt_row gt_center" headers="Estimate">−0.662</td>
<td class="gt_row gt_center" headers="StdError">0.248</td>
<td class="gt_row gt_center" headers="CI_low">−1.148</td>
<td class="gt_row gt_center" headers="CI_high">−0.175</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Term">sexM</td>
<td class="gt_row gt_center" headers="Estimate">0.132</td>
<td class="gt_row gt_center" headers="StdError">0.249</td>
<td class="gt_row gt_center" headers="CI_low">−0.355</td>
<td class="gt_row gt_center" headers="CI_high">0.619</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-5-6" class="tab-pane page-columns page-full" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<p>The <code>Conway-Maxwell-Poisson (CMP)</code> model is a flexible count data model that can handle overdispersion <strong>and</strong> underdispersion.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># CMP model ----</span></span>
<span></span>
<span><span class="va">model_2</span> <span class="op">&lt;-</span>  <span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span>, </span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">compois</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">model_2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">model.sel</span><span class="op">(</span><span class="va">model_0</span>, <span class="va">model_1</span>, <span class="va">model_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: compois  ( log )
Formula:          frequency ~ 1 + condition + sex + (1 | species) + (1 | id)
Dispersion:                 ~condition + sex
Data: dat_pref

      AIC       BIC    logLik -2*log(L)  df.resid 
   2158.4    2184.4   -1071.2    2142.4       182 

Random effects:

Conditional model:
 Groups  Name        Variance Std.Dev.
 species (Intercept) 0.246    0.4960  
 id      (Intercept) 0.151    0.3886  
Number of obs: 190, groups:  species, 12; id, 95

Conditional model:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         4.8614     0.1857  26.178  &lt; 2e-16 ***
conditionsupplied  -0.7823     0.1044  -7.495 6.62e-14 ***
sexM               -0.1099     0.1257  -0.874    0.382    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Dispersion model:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         4.0338     0.4457   9.050   &lt;2e-16 ***
conditionsupplied   1.1965     0.7681   1.558    0.119    
sexM               -0.1428     0.5530  -0.258    0.796    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      2.5 %     97.5 %   Estimate
cond.(Intercept)                  4.4974266  5.2253653  4.8613959
cond.conditionsupplied           -0.9868149 -0.5776988 -0.7822569
cond.sexM                        -0.3562620  0.1364832 -0.1098894
disp.(Intercept)                  3.1602735  4.9074247  4.0338491
disp.conditionsupplied           -0.3089514  2.7019951  1.1965218
disp.sexM                        -1.2266046  0.9409510 -0.1428268
cond.Std.Dev.(Intercept)|species  0.2691415  0.9139714  0.4959714
cond.Std.Dev.(Intercept)|id       0.2503174  0.6033250  0.3886165</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Model selection table 
        cond((Int)) dsp((Int)) cond(cndt) cond(sex) dsp(cndt) dsp(sex) family
model_2       4.861     4.0340          +         +         +        + cm(lg)
model_1       4.874     0.8394          +         +         +        + n2(lg)
model_0       4.841                     +         +                    n2(lg)
        df    logLik   AICc delta weight
model_2  8 -1071.193 2159.2  0.00  0.999
model_1  8 -1078.021 2172.8 13.66  0.001
model_0  6 -1082.155 2176.8 17.59  0.000
Abbreviations:
 family: cm(lg) = 'compois(log)', n2(lg) = 'nbinom2(log)'
Models ranked by AICc(x) 
Random terms (all models): 
  cond(1 | species), cond(1 | id)</code></pre>
</div>
</div>
<p>Here, we compared three generalised linear mixed models. <strong>model_0</strong> was a <code>Negative Binomial (NB)</code> model with a single, overall estimated dispersion parameter (i.e., not modelled as a function of predictors). <strong>model_1</strong> extended this by modelling the <code>NB</code> dispersion parameter as a function of condition and sex. <strong>model_2</strong> further used a <code>Conway-Maxwell-Poisson (CMP)</code> distribution, which can accommodate both under- and over-dispersion, with its dispersion parameter similarly modelled by condition and sex.</p>
<p>Model comparison based on AICc strongly favored the location-scale CMP model (model_2: AICc = 2159.2, model weight = 0.999), with the location-scale NB model (model_1: AICc = 2172.8) and the NB model with a single dispersion parameter (model_0: AICc = 2176.8) performing substantially worse.</p>
<p>In all three models, food-supplied birds showed significantly lower gaze frequencies toward dot stimuli. There was no evidence of sex differences in the location part in any model.</p>
<p>Regarding the dispersion parameter, in the location-scale <code>NB</code> model (model_1), the dispersion part revealed a significant change in residual variance in the food-supplied condition (<span class="math inline">\(\beta_{[\text{conditionSupplied}]}^{(l)}\)</span> = –0.662). Given the parameterization of the Negative Binomial distribution (where a smaller dispersion parameter <span class="math inline">\(\theta\)</span> indicates greater overdispersion), this suggests an increase in overdispersion when food was supplied, implying less consistent behavior across individuals. However, this effect was not statistically significant in the location-scale <code>CMP</code> model (model_2), where the corresponding estimate was 1.20 (p = 0.12). In the <code>CMP</code> model, a positive estimate for the dispersion parameter <span class="math inline">\(\nu\)</span> would imply a decrease in overdispersion (i.e., more consistent behavior) if it were significant.</p>
<p>Random effects in all models consistently showed greater variance among species than among id within species. For example, in the location-scale CMP model, species-level variance was 0.246, while individual-level variance was 0.151.</p>
<section id="comparing-negative-binomial-and-cmp-models" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="comparing-negative-binomial-and-cmp-models">Comparing Negative Binomial and CMP Models</h3>
<p>Below, we compare the Negative Binomial (NB) and Conway-Maxwell-Poisson (CMP) models to assess which better fits the data. Model selection is based on AICc and residual diagnostics.</p>
<div class="cell column-page quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<p>Model comparison of location-only and location-scale models in negative Binomial (NB) and Conway-Maxwell-Poisson (CMP) distributions.</p>
</div>
</div>
</div>
<p>All models passed the <code>DHARMa</code> dispersion and outlier tests, indicating appropriate handling of overall variance and absence of extreme observations. However, the Kolmogorov–Smirnov (KS) test consistently revealed significant deviations from the expected uniform distribution of residuals in all three cases, suggesting remaining misfits in distributional shape. The location-scale <code>CMP</code> model performed best in terms of within-group residual uniformity, showing no significant deviation in any predictor level. In contrast, both the location-only <code>NB</code> model and the location-scale <code>NB</code> model exhibited within-group deviations in some categories. These results collectively suggest that while none of the models perfectly capture the residual structure, the location-scale <code>CMP</code> model may offer the best overall fit among the candidates for the observed data characteristics.</p>
</section>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<p>You can also fit the location-scale model using the <code>brms</code> package. The difference is that in <code>brms</code>, you can specify scale parts using <code>shape</code>. Below, we show how to fit the same location-scale negative binomial model as above using <code>brms</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">formula1</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  <span class="va">shape</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior1</span> <span class="op">&lt;-</span> <span class="fu">default_prior</span><span class="op">(</span><span class="va">formula1</span>, </span>
<span>                        data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>                        family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span>, link_shape <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">model_nb_brms</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span><span class="va">formula1</span>, </span>
<span>            data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>            prior <span class="op">=</span> <span class="va">prior1</span>,</span>
<span>            chains <span class="op">=</span> <span class="fl">2</span>, </span>
<span>            iter <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>            warmup <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>            thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span>, link_shape <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>            <span class="co"># control = list(adapt_delta = 0.95)</span></span>
<span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_nb_brms</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: negbinomial 
  Links: mu = log; shape = log 
Formula: frequency ~ condition + sex + (1 | species) + (1 | id) 
         shape ~ condition + sex
   Data: dat_pref (Number of observations: 190) 
  Draws: 2 chains, each with iter = 5000; warmup = 3000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~id (Number of levels: 95) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.38      0.13     0.08     0.60 1.00      482      563

~species (Number of levels: 12) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.69      0.23     0.36     1.24 1.00      978     1816

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   4.85      0.25     4.35     5.34 1.00     1044
shape_Intercept             0.87      0.28     0.36     1.45 1.00      966
conditionsupplied          -0.84      0.12    -1.09    -0.60 1.00     4843
sexM                       -0.11      0.14    -0.40     0.17 1.00     3632
shape_conditionsupplied    -0.70      0.28    -1.29    -0.19 1.00     2044
shape_sexM                  0.14      0.25    -0.35     0.61 1.00     4208
                        Tail_ESS
Intercept                   1637
shape_Intercept             1938
conditionsupplied           3049
sexM                        3220
shape_conditionsupplied     1777
shape_sexM                  2673

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="comparison-of-location-only-model-and-location-scale-model-3" class="level3"><h3 class="anchored" data-anchor-id="comparison-of-location-only-model-and-location-scale-model-3">Comparison of location-only model and location-scale model</h3>
<ul>
<li><p>Modeling dispersion improves model fit and better captures the structure of the data.</p></li>
<li><p>Location-scale model had a lower AICc (2172.8) than location-only model (2176.8), indicating better model fit. It also had a higher model weight (0.877 vs.&nbsp;0.123), suggesting stronger support for the location-scale model.</p></li>
</ul></section><section id="interpretation-of-location-scale-model-3" class="level3"><h3 class="anchored" data-anchor-id="interpretation-of-location-scale-model-3">Interpretation of location-scale model :</h3>
<p><strong>Location (mean) part:</strong></p>
<ul>
<li>The supplied condition significantly lowers gaze frequency (<span class="math inline">\(\beta_{[\text{conditionSupplied}]}^{(l)}\)</span> = -0.845, 95% CI [-1.08, -0.61]$).</li>
<li>There is no significant sex difference in mean gaze frequency (<span class="math inline">\(\beta_{[\text{sex-male}]}^{(l)}\)</span> = -0.104, 95% CI [-0.37, 0.16]$).</li>
</ul>
<p><strong>Scale (dispersion) part:</strong></p>
<ul>
<li><p>The supplied condition significantly increases residual variance (<span class="math inline">\(\beta_{[\text{deprived–supplied}]}^{(s)}\)</span> = -0.662, 95% CI [1.15, -0.18]$). This suggests more varied gaze behaviour across individuals under the supplied condition.</p></li>
<li><p>There is no significant sex difference in the variability of gaze frequency (<span class="math inline">\(\beta_{[\text{sex-male}]}^{(s)}\)</span> = 0.132, 95% CI [-0.36, 0.62]$).</p></li>
</ul>
<p><strong>Location (mean) random effects:</strong></p>
<ul>
<li>Species-level (<span class="math inline">\(sd_{[\text{species}]}\)</span> = 0.55, 95% CI [0.31, 0.99]$): Indicates some variation in mean gaze frequency among species.</li>
</ul>
<p><strong>Location (dispersion) random effects:</strong> - Individual-level (<span class="math inline">\(sd_{[\text{species}]}\)</span> = 0.34, 95% CI [0.17, 0.68]): Suggests variation among individuals within species, but this is smaller than the variation across species.</p>
</section></section><section id="conclusion-3" class="level2"><h2 class="anchored" data-anchor-id="conclusion-3">Conclusion</h2>
<p><strong>Q1: Do birds gaze at dot patterns more (or less) when food-deprived compared to food-supplied?</strong></p>
<p>Answer: Yes. In the location (mean) part of the model, the coefficient for the supplied condition is significantly negative. This indicates that participants made fewer gazes toward dot stimuli in the food-supplied condition compared to the food-deprived condition. So, the average gaze frequency is lower when food is supplied.</p>
<p><strong>Q2: Does the variability in gaze responses differ between conditions?</strong></p>
<p>Answer: Yes. In the scale (dispersion) part of the model, the coefficient for the food-supplied condition is significantly negative. Since lower θ values imply greater dispersion, this result suggests that individual gaze responses were more variable when food was supplied. In other words, birds showed more consistent gaze responses when food was deprived, and more varied responses when food was available.</p>
</section></section><section id="beyond-gaussian-2" class="level1"><h1>Beyond Gaussian 2</h1>
<p>This dataset comes from <a href="https://doi.org/10.1111/1365-2656.13766">Lundgren et al.&nbsp;(2022)</a>, which examined the activity and impact of feral dunkeys (<em>Equus africanus asinus</em>) between wetlands with and without cougar (<em>Puma concolor</em>) predation.</p>
<p>For this example, we will focus on the effect of cougar predation on the percentage of ground trampled by feral donkeys.</p>
<section id="questions-3" class="level2"><h2 class="anchored" data-anchor-id="questions-3">Questions</h2>
<ol type="1">
<li><strong>Does cougar predation affect the percentage of ground trampled by feral donkeys?</strong></li>
<li><strong>Does cougar predation affect the variability in the percentage of ground trampled by feral donkeys?</strong></li>
</ol>
<section id="variables-included-2" class="level3"><h3 class="anchored" data-anchor-id="variables-included-2">Variables included</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>
<code>cover</code>: Percentage of ground trampled by feral donkeys</li>
<li>
<code>Site</code>: Name of the site where the data was collected</li>
<li>
<code>Access_point</code>: Access point to the sites</li>
<li>
<code>if_kill</code>: Whether a cougar kill (dead donkey) was found at the site (1 = yes, 0 = no)</li>
</ul>
</div>
</div>
</div>
</section></section><section id="visualise-the-dataset-1" class="level2"><h2 class="anchored" data-anchor-id="visualise-the-dataset-1">Visualise the dataset</h2>
<p>iolin plots illustrate the overall density distribution of percentage of trampled Bare Ground for both areas with (Yes) and without (No) donkey kills Each individual empty circle represents the trampled bare ground cover of a single observation. The plot visually highlights individual variability and allows for the comparison of both central tendency (indicated by the black solid line, representing the mean) and spread of trampled bare ground cover between areas where burro kills are absent versus present.</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>,<span class="st">"Lundgren_Cougar_Burro_Trophic_Cascade_Trampled_BareGround.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Site</span>, <span class="va">Pool</span>, <span class="va">if_kill</span>, <span class="va">cover</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Site<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Site</span><span class="op">)</span>,</span>
<span>         if_kill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">if_kill</span><span class="op">)</span>,</span>
<span>         cover<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">cover</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   115 obs. of  4 variables:
 $ Site   : Factor w/ 13 levels "Anvil Spring",..: 1 1 1 1 1 1 1 1 2 2 ...
 $ Pool   : chr  "Anvil Spring" "Anvil Spring" "Anvil Spring" "Anvil Spring" ...
 $ if_kill: Factor w/ 2 levels "burro kills absent",..: 1 1 1 1 1 1 1 1 2 2 ...
 $ cover  : num  1 1 1 1 1 1 1 1 1 0.6 ...</code></pre>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">if_kill</span>, y <span class="op">=</span> <span class="va">cover</span>, fill <span class="op">=</span> <span class="va">if_kill</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">if_kill</span><span class="op">)</span>, <span class="co"># Fill violins based on 'if_kill'</span></span>
<span>    color <span class="op">=</span> <span class="st">"#8B8B83"</span>, <span class="co"># Outline color for violins</span></span>
<span>    width <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">if_kill</span><span class="op">)</span>, <span class="co"># Color jittered points based on 'if_kill'</span></span>
<span>    size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Open circles for jittered points</span></span>
<span>    position <span class="op">=</span> <span class="fu">position_jitterdodge</span><span class="op">(</span>dodge.width <span class="op">=</span> <span class="fl">0.5</span>, jitter.width <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>    geom <span class="op">=</span> <span class="st">"crossbar"</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>, <span class="co"># Black crossbar for mean</span></span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Donkey Trampling by Cougar Kill Presence"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Cougar Kill Presence"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Proportion Trampled Bare Ground"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"burro kills absent"</span> <span class="op">=</span> <span class="st">"cornflowerblue"</span>, <span class="st">"burro kills present"</span> <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span> <span class="co"># Add scale_color_manual for jitter points</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"burro kills absent"</span> <span class="op">=</span> <span class="st">"cornflowerblue"</span>, <span class="st">"burro kills present"</span> <span class="op">=</span> <span class="st">"firebrick"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_discrete</span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"burro kills absent"</span> <span class="op">=</span> <span class="st">"No"</span>, <span class="st">"burro kills present"</span> <span class="op">=</span> <span class="st">"Yes"</span><span class="op">)</span>,</span>
<span>    expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/show_data%20-%20beyond_gaussian2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section><section id="run-models-and-interpret-results-4" class="level2"><h2 class="anchored" data-anchor-id="run-models-and-interpret-results-4">Run models and interpret results</h2>
<p>We will fit two zero-one inflated beta regression models to the data using the <code>brms</code> package. We’ll use the <code>brms</code> package because the <code>glmmTMB</code> (frequentist) approach does not allow for values of ‘1’, while the <code>brms</code> package allows us to fit zero-one inflation models to account for these boundary values. All models incorporate <code>Pool</code> as a random effect to account for non-independence of observations collected at the same wetland access point</p>
<p>The models are as follows:</p>
<ol type="a">
<li>Location-Only Model: This model will estimate the average difference in the percentage of trampled bare ground between areas where “burro kills are absent” and where “burro kills are present.”</li>
<li>Location-Scale Model: This more comprehensive model will estimate both the average difference (location) and any differences in the variability (scale) of the percentage of trampled bare ground between areas with and without burro kills.</li>
</ol>
<section id="model-fitting-2" class="level3"><h3 class="anchored" data-anchor-id="model-fitting-2">Model fitting</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Location-only model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Location-scale model</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">Model Comparison</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><code>zoi ~ if_kill</code> (Zero-One Inflation): This part of the model estimates how if_kill (cougar kill presence) influences the probability that an observation is exactly 0% or exactly 100% trampled bare ground. If <code>if_kill</code> increases the zoi probability, it means that areas with burro kills are more likely to have either no trampled ground or completely trampled ground, compared to areas without burro kills.</p>
<p><code>coi ~ if_kill</code> (Conditional on Inflation): This is where we distinguish between the 0% and 100% boundaries. If an observation is exactly at a boundary (0% or 100% trampled bare ground), the coi part of the model estimates how <code>if_kill</code> influences the probability that this boundary observation is 100% (fully trampled) rather than 0% (no trampled ground). So, if <code>coi</code> increases with <code>if_kill</code>, it suggests that if a site has exact boundary values, the presence of burro kills makes it more likely for that site to be completely trampled (100%) rather than completely untrampled (0%).</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m0</span><span class="op">&lt;-</span><span class="fu">bf</span><span class="op">(</span><span class="va">cover</span> <span class="op">~</span> <span class="va">if_kill</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pool</span><span class="op">)</span>,</span>
<span>       <span class="va">zoi</span><span class="op">~</span>  <span class="va">if_kill</span>, </span>
<span>       <span class="va">coi</span><span class="op">~</span>  <span class="va">if_kill</span><span class="op">)</span> </span>
<span><span class="va">prior1</span><span class="op">&lt;-</span><span class="fu">default_prior</span><span class="op">(</span><span class="va">m0</span>, family<span class="op">=</span><span class="fu">zero_one_inflated_beta</span><span class="op">(</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Since this model is time-consuming, reload without running it:</span></span>
<span><span class="va">rerun</span> <span class="op">&lt;-</span> <span class="cn">F</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">rerun</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>   <span class="va">m0</span>,</span>
<span>   data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>   family <span class="op">=</span> <span class="fu">zero_one_inflated_beta</span><span class="op">(</span><span class="op">)</span>,</span>
<span>   prior <span class="op">=</span> <span class="va">prior1</span>,</span>
<span>   iter <span class="op">=</span> <span class="fl">6000</span>,</span>
<span>   warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>   chains <span class="op">=</span> <span class="fl">2</span>,  cores<span class="op">=</span><span class="fl">2</span>,</span>
<span>   control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>     adapt_delta <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>     max_treedepth <span class="op">=</span> <span class="fl">15</span></span>
<span>   <span class="op">)</span>,</span>
<span>   seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>   refresh <span class="op">=</span> <span class="fl">500</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">fit0</span>, file <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"Rdata"</span>, <span class="st">"fit0_BETA_Burros.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"Rdata"</span>, <span class="st">"fit0_BETA_Burros.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: zero_one_inflated_beta 
  Links: mu = logit; phi = identity; zoi = logit; coi = logit 
Formula: cover ~ if_kill + (1 | Pool) 
         zoi ~ if_kill
         coi ~ if_kill
   Data: dat (Number of observations: 115) 
  Draws: 2 chains, each with iter = 6000; warmup = 1000; thin = 1;
         total post-warmup draws = 10000

Multilevel Hyperparameters:
~Pool (Number of levels: 16) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.42      0.25     0.03     0.98 1.00     2136     2656

Regression Coefficients:
                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                        0.70      0.41    -0.11     1.52 1.00     6799
zoi_Intercept                    0.72      0.33     0.10     1.37 1.00    15641
coi_Intercept                    6.31      2.97     2.51    13.90 1.00     4844
if_killburrokillspresent        -1.02      0.46    -1.95    -0.11 1.00     7279
zoi_if_killburrokillspresent    -1.70      0.42    -2.53    -0.89 1.00    15364
coi_if_killburrokillspresent    -4.24      3.06   -11.91    -0.07 1.00     4529
                             Tail_ESS
Intercept                        6130
zoi_Intercept                    7396
coi_Intercept                    3104
if_killburrokillspresent         6371
zoi_if_killburrokillspresent     7048
coi_if_killburrokillspresent     3118

Further Distributional Parameters:
    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
phi     2.11      0.35     1.51     2.87 1.00     6161     7129

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><code>phi</code> (Precision/Scale Parameter): This part of the model estimates how <code>if_kill</code> (cougar kill presence) influences the variability of the percentage of trampled bare ground for observations that fall between 0% and 100% (i.e., not exactly at the boundaries). A higher <code>phi</code> value indicates lower variability (data points are more tightly clustered around the mean). A lower <code>phi</code> value indicates higher variability (data points are more spread out).</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m1</span><span class="op">&lt;-</span><span class="fu">bf</span><span class="op">(</span><span class="va">cover</span> <span class="op">~</span> <span class="va">if_kill</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">Pool</span><span class="op">)</span>,</span>
<span>       <span class="va">zoi</span><span class="op">~</span>  <span class="va">if_kill</span>, </span>
<span>       <span class="va">coi</span><span class="op">~</span>  <span class="va">if_kill</span>,</span>
<span>       <span class="va">phi</span><span class="op">~</span><span class="va">if_kill</span><span class="op">)</span> </span>
<span><span class="va">prior2</span><span class="op">&lt;-</span><span class="fu">default_prior</span><span class="op">(</span><span class="va">m1</span>, family<span class="op">=</span><span class="fu">zero_one_inflated_beta</span><span class="op">(</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rerun</span> <span class="op">&lt;-</span> <span class="cn">F</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="va">rerun</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>   <span class="va">m1</span>,</span>
<span>   data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>   family <span class="op">=</span> <span class="fu">zero_one_inflated_beta</span><span class="op">(</span><span class="op">)</span>,</span>
<span>   prior <span class="op">=</span> <span class="va">prior2</span>,</span>
<span>   iter <span class="op">=</span> <span class="fl">6000</span>,</span>
<span>   warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>   chains <span class="op">=</span> <span class="fl">2</span>,  cores<span class="op">=</span><span class="fl">2</span>,</span>
<span>   control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>     adapt_delta <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>     max_treedepth <span class="op">=</span> <span class="fl">15</span></span>
<span>   <span class="op">)</span>,</span>
<span>   seed <span class="op">=</span> <span class="fl">123</span>,      <span class="co">#</span></span>
<span>   refresh <span class="op">=</span> <span class="fl">500</span>    <span class="co">#</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">fit1</span>, file <span class="op">=</span> <span class="fu">here</span><span class="op">(</span><span class="st">"Rdata"</span>, <span class="st">"fit1_BETA_Burros.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"Rdata"</span>, <span class="st">"fit1_BETA_Burros.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: zero_one_inflated_beta 
  Links: mu = logit; phi = log; zoi = logit; coi = logit 
Formula: cover ~ if_kill + (1 | Pool) 
         zoi ~ if_kill
         coi ~ if_kill
         phi ~ if_kill
   Data: dat (Number of observations: 115) 
  Draws: 2 chains, each with iter = 6000; warmup = 1000; thin = 1;
         total post-warmup draws = 10000

Multilevel Hyperparameters:
~Pool (Number of levels: 16) 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)     0.63      0.26     0.13     1.19 1.00     2237     2163

Regression Coefficients:
                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                        0.92      0.46     0.01     1.85 1.00     4499
phi_Intercept                    1.73      0.49     0.72     2.61 1.00     3574
zoi_Intercept                    0.72      0.33     0.10     1.39 1.00    12262
coi_Intercept                    6.28      2.95     2.61    14.08 1.00     4100
if_killburrokillspresent        -1.22      0.52    -2.27    -0.18 1.00     4920
phi_if_killburrokillspresent    -1.07      0.51    -2.01    -0.04 1.00     4334
zoi_if_killburrokillspresent    -1.71      0.42    -2.55    -0.89 1.00    11924
coi_if_killburrokillspresent    -4.20      3.05   -12.07    -0.08 1.00     3953
                             Tail_ESS
Intercept                        5041
phi_Intercept                    5090
zoi_Intercept                    7049
coi_Intercept                    2701
if_killburrokillspresent         5730
phi_if_killburrokillspresent     5570
zoi_if_killburrokillspresent     6844
coi_if_killburrokillspresent     2698

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">f0loo</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span></span>
<span><span class="va">f1loo</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fc</span><span class="op">&lt;-</span><span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html">loo_compare</a></span><span class="op">(</span><span class="va">f0loo</span>, <span class="va">f1loo</span><span class="op">)</span></span>
<span><span class="va">fc</span></span>
<span><span class="co">#      elpd_diff se_diff</span></span>
<span><span class="co"># fit1  0.0       0.0   </span></span>
<span><span class="co"># fit0 -2.7       1.6   </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="model-comparison-results" class="level3"><h3 class="anchored" data-anchor-id="model-comparison-results">Model Comparison Results</h3>
<p>Our analysis of the model comparison results shows that the location-scale model is the most supported by the data. This is indicated by its lowest LOO (Leave-One-Out Cross-Validation) information criterion value.</p>
</section><section id="model-interpretation" class="level3"><h3 class="anchored" data-anchor-id="model-interpretation">Model Interpretation</h3>
<p><strong>Location (mean) part:</strong></p>
<p>On average, the log-odds of the mean percentage of trampled bare ground are lower when burro kills are present compared to when they are absent (estimate = -1.22, 95% CI [-2.27, -0.18]). This suggests that the presence of burro kills is associated with a lower average percentage of trampled bare ground.</p>
<p><strong>Scale (dispersion/phi) part:</strong> The log-precision (phi) is lower when burro kills are present, compared to when they are absent (estimate = -1.07, 95% CI [-2.01, -0.04]). Suggesting that the percentage of trampled bare ground exhibits more variation or less consistency in areas where burro kills are present.</p>
<p><strong>Zero-One Inflation (zoi) part:</strong> The log-odds of observing exactly 0% or 100% trampled bare ground are lower when burro kills are present (estimate = -1.71, 95% CI [-2.55, -0.89]). In other words, areas with burro kills are less likely to be at the extreme boundaries of either no trampled ground or entirely trampled ground.</p>
<p><strong>Conditional on Inflation (coi) part:</strong> The log-odds of a boundary observation being 100% rather than 0% are lower when burro kills are present (estimate = -4.20, 95% CI [-12.07, -0.08]). This implies that if a boundary value is encountered with burro kills, it is less likely to be 100% (and potentially more likely to be 0%) compared to the “burro kills absent” scenario.</p>
</section></section><section id="conclusion-4" class="level2"><h2 class="anchored" data-anchor-id="conclusion-4">Conclusion</h2>
<p><strong>Does cougar predation affect the percentage of ground trampled by feral donkeys?</strong></p>
<p>Answer: Yes, cougar predation, affects the average percentage of ground trampled by feral donkeys.</p>
<p><strong>Does cougar predation affect the variability in the percentage of ground trampled by feral donkeys?</strong></p>
<p>Answer: The model provides evidence that cougar predation affects the variability in the percentage of ground trampled by feral donkeys.</p>
</section></section><section id="model-selection" class="level1"><h1>Model selection</h1>
<p>This section outlines general guidelines for model selection and refinement, based on the results from the previous examples (sections XX and Beyond Gaussian 1). These steps can be applied to any model fitting process, whether using <code>glmmTMB</code>, <code>brms</code>, or other packages.</p>
<ol type="1">
<li>
<strong>Identify data type and plot raw data</strong> to understand the distribution and structure of the response variable. This helps in selecting an appropriate model family (e.g., Gaussian, Poisson, Negative Binomial, Beta).</li>
<li>
<strong>Begin with a simpler model</strong> (e.g., a location-only model assuming homoscedasticity) to establish a baseline for interpretation.</li>
<li>
<strong>Check residual diagonostics</strong> to detect possible model misspecification, such as overdispersion or non-uniformity of residuals. If issues are detected, consider more complex models (e.g., location-scale models) that account for heterogeneity in variance.</li>
<li>
<strong>Gradually increase model complexity</strong>: Introduce additional components, such as group-level effects on the scale (variance), and consider estimating correlations between random effects when theoretically or empirically justified—especially when supported by sufficient sample size.</li>
<li>
<strong>Compare models using information criteria</strong>:</li>
</ol>
<ul>
<li>For frequentist models: use <strong>AIC</strong> (Akaike Information Criterion)</li>
<li>For Bayesian models: use <strong>LOO</strong> (Leave-One-Out Cross-Validation) or <strong>WAIC</strong> (Widely Applicable Information Criterion).</li>
</ul>
<p>Ultimately, the goal is not only to improve statistical fit but also to gain biological insights. For example, finding that a scale predictor improves model fit may suggest biologically meaningful heterogeneity.</p>
<p>We demonstrate these steps using the previous examples, where we started with a location-only model and then moved to a location-scale model to account for heterogeneity in variance. We also compared models using AICc and LOO criteria to select the best-fitting model. Although parts of the examples below may repeat content from earlier sections, we present them again here in sequence to illustrate a typical approach to model selection and refinement.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>One important thing to keep in mind is that <code>DHARMa</code> does not work with models fitted using <code>brms</code>. This means that you cannot check residual diagnostics for the location-only double-hierarchical model (model 3) if it was fitted with brms. If you want to use <code>DHARMa</code> for residual diagnostics, you need to run model 2.5 instead - in other words, you cannot include the correlation part.</p>
</div>
</div>
</div>
<!-- ## Example 1
Santi's data

### Step 1: Identify data type and plot raw data
 -->
<section id="example-2" class="level2"><h2 class="anchored" data-anchor-id="example-2">Example 2</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Step 1</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Steps 2 and 3</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">Step 4</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false" href="">Step 5</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<section id="identify-data-type-and-plot-raw-data" class="level4"><h4 class="anchored" data-anchor-id="identify-data-type-and-plot-raw-data">Identify data type and plot raw data</h4>
<!-- This is the same figures as in the previous example - should O skip?? -->
<p>The violin plot by condition and sex shows that gaze frequency is generally higher in the food-deprived condition, with some individuals—especially females—showing very high values (over 500). The faceted line plot by species shows: - Consistent directional trends (e.g., reduced gazing in the supplied condition) - Species-specific differences in variance, suggesting possible heteroscedasticity</p>
<p>These patterns raise two important considerations: 1. Overdispersion is likely present, particularly in the deprived condition, where the spread of counts is large. 2. A phylogenetic effect may be at play, since species vary not only in their average gaze frequencies but also in how consistent individuals are within each species - possibly due to traits shaped by common ancestry.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat_pref</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>,</span>
<span>                     y <span class="op">=</span> <span class="va">frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_violin</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#8B8B83"</span>, fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">1.2</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">sex</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>,</span>
<span>              size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">0.15</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Total frequency of gazes towards dot patterns"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total frequency of gazes (1hr)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_shape_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span> <span class="op">=</span> <span class="fl">17</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span> <span class="op">=</span> <span class="st">"Male"</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span> <span class="op">=</span> <span class="st">"#009ACD"</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="st">"#FF4D4D"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span> <span class="op">=</span> <span class="st">"Male"</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="st">"Female"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#6E7B8B"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/identify_data_type%20-%20eg2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat_pref</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Total frequency of gazes towards dot patterns by species"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Total frequency of gazes (1hr)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"line"</span>, <span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="va">species</span>, color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">species</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/identify_data_type%20-%20eg2-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<section id="begin-with-a-simpler-model-and-heck-residual-diagnostics" class="level4"><h4 class="anchored" data-anchor-id="begin-with-a-simpler-model-and-heck-residual-diagnostics">Begin with a simpler model and heck residual diagnostics</h4>
<p>From the previous analysis, we already know that a location-only model without phylogenetic effects does not adequately capture the structure of the data. However, here we re-examine this model before moving on.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_0</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span>  <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>, <span class="co"># location part (mean)</span></span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">nbinom2</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To evaluate model adequacy, we use the DHARMa package to simulate and visualize residuals. The plots allow us to assess residual uniformity, potential over- or underdispersion, outliers, and leverage.</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># main diagnostic plots</span></span>
<span></span>
<span><span class="va">model0_res</span> <span class="op">&lt;-</span> <span class="fu">simulateResiduals</span><span class="op">(</span><span class="va">model_0</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/residual_diagnostics%20-%20eg2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># formal test for over/underdispersion</span></span>
<span><span class="fu">testDispersion</span><span class="op">(</span><span class="va">model0_res</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="online_tutorial_files/figure-html/residual_diagnostics%20-%20eg2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.45606, p-value = 0.456
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Although the dispersion test (p = 0.456) suggests no clear evidence of overdispersion based on the mean–variance relationship, the KS test indicates that the residuals deviate from a uniform distribution. These two tests assess different aspects of model adequacy: the dispersion test evaluates whether the variance is correctly specified as a function of the mean, while the KS test can detect broader misfits, such as unmodeled structure, zero inflation, or group-specific heteroscedasticity. Thus, even in the absence of overdispersion, the presence of non-uniform residuals supports the need for a more flexible model.</p>
<p>Since we have found the limitations of the model without phylogenetic effects, we now proceed to fit the same model using the <code>brms</code> package, this time including the phylogenetic effect as a random effect to account for the non-independence among species. Including both species and phylogeny as random effects allows us to distinguish between two sources of variation: the phylogenetic effect captures correlations arising from shared evolutionary history, whereas the species-level random intercept absorbs residual species-specific variation not accounted for by the tree—such as ecological or methodological factors. Including both terms helps avoid underestimating heterogeneity at the species level and provides a more accurate partitioning of variance.</p>
<p>First, we run the same model as above, but using the <code>brms</code> package. Then, we will gradually increase the model complexity by adding phylogenetic effects and a scale part to the model.</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">formula_eg2.0</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior_eg2.0</span> <span class="op">&lt;-</span> <span class="fu">default_prior</span><span class="op">(</span><span class="va">formula_eg2.0</span>, </span>
<span>                        data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>                        family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_eg2.0</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span><span class="va">formula_eg2.0</span>, </span>
<span>            data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>            prior <span class="op">=</span> <span class="va">prior_eg2.0</span>,</span>
<span>            chains <span class="op">=</span> <span class="fl">2</span>, </span>
<span>            iter <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>            warmup <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>            thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>            save_pars <span class="op">=</span> <span class="fu">save_pars</span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>            <span class="co"># control = list(adapt_delta = 0.95)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we add the phylogenetic effect as a random effect to the model. This allows us to account for the non-independence among species due to shared evolutionary history.</p>
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">read.nexus</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"AM_est_tree.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tree</span>　<span class="op">&lt;-</span><span class="fu">force.ultrametric</span><span class="op">(</span><span class="va">tree</span>, method <span class="op">=</span> <span class="st">"extend"</span><span class="op">)</span></span>
<span><span class="co"># is.ultrametric(tree)</span></span>
<span></span>
<span><span class="va">tip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lonchura_cantans"</span>,<span class="st">"Uraeginthus_bengalus"</span>,<span class="st">"Neochmia_modesta"</span>,</span>
<span>         <span class="st">"Lonchura_atricapilla"</span>,<span class="st">"Padda_oryzivora"</span>,<span class="st">"Taeniopygia_bichenovii"</span>,</span>
<span>         <span class="st">"Emblema_pictum"</span>,<span class="st">"Neochmia_ruficauda"</span>,<span class="st">"Lonchura_maja"</span>,</span>
<span>         <span class="st">"Taeniopygia_guttata"</span>,<span class="st">"Chloebia_gouldiae"</span>,<span class="st">"Lonchura_castaneothorax"</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">KeepTip</span><span class="op">(</span><span class="va">tree</span>, <span class="va">tip</span>, preorder <span class="op">=</span> <span class="cn">TRUE</span>, check <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create phylogenetic correlation matrix</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/vcv.phylo.html">vcv.phylo</a></span><span class="op">(</span><span class="va">tree</span>, corr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the model formula (location-only)</span></span>
<span><span class="va">formula_eg2.1</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> </span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">a</span> <span class="op">|</span> <span class="fu">gr</span><span class="op">(</span><span class="va">phylo</span>, cov <span class="op">=</span> <span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># phylogenetic random effect</span></span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span>             <span class="co"># non-phylogenetic species-level random effect (ecological factors)</span></span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>                    <span class="co"># individual-level random effect</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior_eg2.1</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/default_prior.html">get_prior</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">formula_eg2.1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>  data2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_eg2.1</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">formula_eg2.1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>  data2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  iter <span class="op">=</span> <span class="fl">12000</span>, </span>
<span>  warmup <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">prior_eg2.1</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  save_pars <span class="op">=</span> <span class="fu">save_pars</span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<section id="gradually-increase-model-complexity" class="level4"><h4 class="anchored" data-anchor-id="gradually-increase-model-complexity">Gradually increase model complexity</h4>
<p>In the previous model, variation in individual gaze frequency was modeled assuming a constant dispersion parameter across all groups. However, visual inspection of the raw data suggests heteroscedasticity (i.e., group-specific variance). To accommodate this, we now fit a location-scale model where the shape (dispersion) parameter is allowed to vary by condition and sex.</p>
<p>This model helps capture structured variability in the data and may reveal whether the precision (or variability) of gaze frequency differs systematically between experimental groups.</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Specify the model formula (location-scale) - the scale part does not include random effects</span></span>
<span><span class="va">formula_eg2.2</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> </span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">a</span> <span class="op">|</span> <span class="fu">gr</span><span class="op">(</span><span class="va">phylo</span>, cov <span class="op">=</span> <span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span>          </span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,              </span>
<span><span class="va">shape</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior_eg2.2</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/default_prior.html">get_prior</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">formula_eg2.2</span>, </span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>  data2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span>, link_shape <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_eg2.2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">formula_eg2.2</span>, </span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>  data2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  iter <span class="op">=</span> <span class="fl">12000</span>, </span>
<span>  warmup <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span>, link_shape <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">prior_eg2.2</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  save_pars <span class="op">=</span> <span class="fu">save_pars</span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># specify the model formula (location-scale)</span></span>
<span><span class="co">## the scale part includes phylogenetic random effects and individual-level random effects</span></span>
<span></span>
<span><span class="va">formula_eg2.3</span> <span class="op">&lt;-</span> <span class="fu">bf</span><span class="op">(</span></span>
<span>  <span class="va">frequency</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> </span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span><span class="va">a</span><span class="op">|</span> <span class="fu">gr</span><span class="op">(</span><span class="va">phylo</span>, cov <span class="op">=</span> <span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># phylogenetic random effect</span></span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span>            <span class="co"># non-phylogenetic species-level random effect (ecological factors)</span></span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,              <span class="co"># individual-level random effect</span></span>
<span><span class="va">shape</span> <span class="op">~</span> <span class="va">condition</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span><span class="va">a</span><span class="op">|</span> <span class="fu">gr</span><span class="op">(</span><span class="va">phylo</span>, cov <span class="op">=</span> <span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>    <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>          </span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">prior_eg2.3</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/default_prior.html">get_prior</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">formula_eg2.3</span>, </span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>  data2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span>, link_shape <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_eg2.3</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">formula_eg2.3</span>, </span>
<span>  data <span class="op">=</span> <span class="va">dat_pref</span>, </span>
<span>  data2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  iter <span class="op">=</span> <span class="fl">12000</span>, </span>
<span>  warmup <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">negbinomial</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span>, link_shape <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">prior_eg2.3</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  save_pars <span class="op">=</span> <span class="fu">save_pars</span><span class="op">(</span>all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_eg2.3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<section id="compare-models-using-information-criteria" class="level4"><h4 class="anchored" data-anchor-id="compare-models-using-information-criteria">Compare models using information criteria</h4>
<p>To assess whether model fit improves with increased complexity, we compare models using Leave-One-Out Cross-Validation (LOO).</p>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>future.globals.maxSize <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">1024</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">loo_eg2.0</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">model_eg2.0</span>, moment_match <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      reloo <span class="op">=</span> <span class="cn">TRUE</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">loo_eg2.1</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">model_eg2.1</span>, moment_match <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                      reloo <span class="op">=</span> <span class="cn">TRUE</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">loo_eg2.2</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">model_eg2.2</span>, moment_match <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      reloo <span class="op">=</span> <span class="cn">TRUE</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">loo_eg2.3</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">model_eg2.3</span>, moment_match <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      reloo <span class="op">=</span> <span class="cn">TRUE</span>, cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fc_eg2</span> <span class="op">&lt;-</span> <span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html">loo_compare</a></span><span class="op">(</span><span class="va">loo_eg2.0</span>, <span class="va">loo_eg2.1</span>, <span class="va">loo_eg2.2</span>, <span class="va">loo_eg2.3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fc_eg2</span><span class="op">)</span></span>
<span><span class="co">#             elpd_diff se_diff</span></span>
<span><span class="co"># model_eg2.3   0.0       0.0  </span></span>
<span><span class="co"># model_eg2.1 -11.5       4.5  </span></span>
<span><span class="co"># model_eg2.2 -11.7       5.3  </span></span>
<span><span class="co"># model_eg2.0 -13.5       4.9  </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_eg2.3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model eg2.3, which includes both phylogenetic and species-level effects on the location and scale parts, performs best (highest elpd).</p>
<p>ELPD stands for Expected Log Predictive Density. It is a measure of out-of-sample predictive accuracy—that is, how well a model is expected to predict new, unseen data. - It is used in Bayesian model comparison, especially when using LOO-CV (Leave-One-Out Cross-Validation). - Higher ELPD means better predictive performance. - It is calculated by taking the log-likelihood of each observation, averaged over posterior draws, and then summed over all observations. - It rewards models that fit the data well without overfitting.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> Family: negbinomial 
  Links: mu = log; shape = log 
Formula: frequency ~ condition + sex + (1 | a | gr(phylo, cov = A)) + (1 | species) + (1 | id) 
         shape ~ condition + sex + (1 | a | gr(phylo, cov = A)) + (1 | species) + (1 | id)
   Data: dat_pref (Number of observations: 190) 
  Draws: 2 chains, each with iter = 12000; warmup = 10000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~id (Number of levels: 95) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)           0.31      0.11     0.05     0.51 1.00      533      501
sd(shape_Intercept)     0.21      0.15     0.01     0.57 1.00     1125     1444

~phylo (Number of levels: 12) 
                               Estimate Est.Error l-95% CI u-95% CI Rhat
sd(Intercept)                      0.49      0.25     0.05     1.04 1.00
sd(shape_Intercept)                0.74      0.38     0.09     1.63 1.00
cor(Intercept,shape_Intercept)     0.51      0.44    -0.64     0.99 1.00
                               Bulk_ESS Tail_ESS
sd(Intercept)                       759      670
sd(shape_Intercept)                1060      983
cor(Intercept,shape_Intercept)      854     1112

~species (Number of levels: 12) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)           0.27      0.20     0.01     0.74 1.00      833     1644
sd(shape_Intercept)     0.46      0.33     0.02     1.24 1.00      826     1519

Regression Coefficients:
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   5.07      0.30     4.46     5.65 1.00     1501
shape_Intercept             0.85      0.50    -0.16     1.84 1.00     1384
conditionsupplied          -0.77      0.11    -0.99    -0.54 1.00     3387
sexM                       -0.15      0.13    -0.40     0.11 1.00     2191
shape_conditionsupplied    -0.70      0.26    -1.22    -0.21 1.00     2251
shape_sexM                  0.12      0.26    -0.40     0.62 1.00     2814
                        Tail_ESS
Intercept                   2213
shape_Intercept             1884
conditionsupplied           2669
sexM                        2480
shape_conditionsupplied     2726
shape_sexM                  2867

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<p>Accounting for phylogeny captures much of the between-species structure, it highlights evolutionary constraints or shared ecological traits. The remaining species-specific variance suggests additional factors (e.g., experimental nuances) not captured by the tree alone.</p>
</section>
</div>
</div>
</div>
</section></section><section id="references" class="level1"><h1>References</h1>
<ul>
<li>Cleasby IR, Burke T, Schroeder J, Nakagawa S. (2011) Food supplements increase adult tarsus length, but not growth rate, in an island population of house sparrows (Passer domesticus). <em>BMC Research Notes</em>. 4:1-1. doi: 10.1186/1756-0500-4-431</li>
<li>Drummond H, Rodriguez C, Ortega S. (2025). Long-Term Insights into Who Benefits from Brood Reduction. <em>Behavioral Ecology</em>. doi: 10.1093/beheco/araf050</li>
<li>Mizuno A, Soma M. (2023) Pre-existing visual preference for white dot patterns in estrildid finches: a comparative study of a multi-species experiment. <em>Royal Society Open Science</em>. 10:231057. doi: 10.1098/rsos.231057</li>
<li>Lundgren EJ, Ramp D, Middleton OS, Wooster EI, Kusch E, Balisi M, Ripple WJ, Hasselerharm CD, Sanchez JN, Mills M, Wallach AD. (2022) A novel trophic cascade between cougars and feral donkeys shapes desert wetlands. <em>Journal of Animal Ecology</em>. 91:2348-57. doi: 10.1111/1365-2656.13766</li>
<li>Aki Vehtari, Andrew Gelman, Daniel Simpson, Bob Carpenter, Paul-Christian Bürkner (2021). Rank-Normalization, Folding, and Localization: An Improved Rhat for Assessing Convergence of MCMC (with Discussion). <em>Bayesian Analysis</em>. 16:667-718. doi: 10.1214/20-BA1221</li>
</ul></section><section id="information-about-r-session" class="level1"><h1>Information about R session</h1>
<p>This section shows the current R session information, including R version, platform, and loaded packages.</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.5

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Edmonton
tzcode source: internal

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] knitr_1.50          kableExtra_1.4.0    here_1.0.1         
 [4] gt_1.0.0            tidybayes_3.0.7     patchwork_1.3.1    
 [7] bayesplot_1.13.0    MuMIn_1.48.11       loo_2.8.0          
[10] DHARMa_0.4.7        TreeTools_1.14.0    rstan_2.32.7       
[13] StanHeaders_2.32.10 phytools_2.4-4      maps_3.4.3         
[16] glmmTMB_1.1.11      emmeans_1.11.1      cmdstanr_0.9.0.9000
[19] broom.mixed_0.2.9.6 brms_2.22.0         Rcpp_1.1.0         
[22] arm_1.14-4          lme4_1.1-37         Matrix_1.7-3       
[25] MASS_7.3-65         ape_5.8-1           lubridate_1.9.4    
[28] forcats_1.0.0       stringr_1.5.1       purrr_1.0.4        
[31] readr_2.1.5         tidyr_1.3.1         ggplot2_3.5.2      
[34] tidyverse_2.0.0     tibble_3.3.0        dplyr_1.1.4        

loaded via a namespace (and not attached):
  [1] svUnit_1.0.6            splines_4.4.2           bitops_1.0-9           
  [4] R.oo_1.27.1             lifecycle_1.0.4         Rdpack_2.6.4           
  [7] doParallel_1.0.17       rprojroot_2.0.4         vroom_1.6.5            
 [10] globals_0.18.0          processx_3.8.6          lattice_0.22-7         
 [13] ggdist_3.3.3            backports_1.5.0         magrittr_2.0.3         
 [16] sass_0.4.10             rmarkdown_2.29          yaml_2.3.10            
 [19] gap_1.6                 pkgbuild_1.4.8          minqa_1.2.8            
 [22] RColorBrewer_1.1-3      multcomp_1.4-28         abind_1.4-8            
 [25] expm_1.0-0              R.cache_0.17.0          quadprog_1.5-8         
 [28] R.utils_2.13.0          RCurl_1.98-1.17         TH.data_1.1-3          
 [31] tensorA_0.36.2.1        sandwich_3.1-1          inline_0.3.21          
 [34] listenv_0.9.1           bridgesampling_1.1-2    parallelly_1.45.0      
 [37] svglite_2.2.1           codetools_0.2-20        xml2_1.3.8             
 [40] tidyselect_1.2.1        farver_2.1.2            matrixStats_1.5.0      
 [43] stats4_4.4.2            jsonlite_2.0.0          survival_3.8-3         
 [46] iterators_1.0.14        systemfonts_1.2.3       foreach_1.5.2          
 [49] tools_4.4.2             glue_1.8.0              mnormt_2.1.1           
 [52] gridExtra_2.3           xfun_0.52               mgcv_1.9-3             
 [55] distributional_0.5.0    withr_3.0.2             numDeriv_2016.8-1.1    
 [58] combinat_0.0-8          fastmap_1.2.0           boot_1.3-31            
 [61] digest_0.6.37           timechange_0.3.0        R6_2.6.1               
 [64] estimability_1.5.1      textshaping_1.0.1       colorspace_2.1-1       
 [67] R.methodsS3_1.8.2       generics_0.1.4          clusterGeneration_1.3.8
 [70] htmlwidgets_1.6.4       scatterplot3d_0.3-44    pkgconfig_2.0.3        
 [73] gtable_0.3.6            furrr_0.3.1             htmltools_0.5.8.1      
 [76] TMB_1.9.17              scales_1.4.0            posterior_1.6.1        
 [79] reformulas_0.4.1        rstudioapi_0.17.1       tzdb_0.5.0             
 [82] reshape2_1.4.4          coda_0.19-4.1           checkmate_2.3.2        
 [85] nlme_3.1-168            curl_6.4.0              nloptr_2.2.1           
 [88] zoo_1.8-14              DEoptim_2.2-8           pillar_1.11.0          
 [91] grid_4.4.2              vctrs_0.6.5             PlotTools_0.3.1        
 [94] arrayhelpers_1.1-0      xtable_1.8-4            evaluate_1.0.4         
 [97] mvtnorm_1.3-3           cli_3.6.5               compiler_4.4.2         
[100] crayon_1.5.3            rlang_1.1.6             rstantools_2.4.0       
[103] labeling_0.4.3          ps_1.9.1                plyr_1.8.9             
[106] gap.datasets_0.0.6      stringi_1.8.7           viridisLite_0.4.2      
[109] QuickJSR_1.8.0          optimParallel_1.0-2     Brobdingnag_1.2-9      
[112] pacman_0.5.1            V8_6.0.4                hms_1.1.3              
[115] bit64_4.6.0-1           future_1.58.0           rbibutils_2.3          
[118] igraph_2.1.4            broom_1.0.8             RcppParallel_5.1.10    
[121] phangorn_2.12.1         fastmatch_1.1-6         bit_4.6.0              </code></pre>
</div>
</div>
<!-- -->

</section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb86" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Location–scale models in ecology: handling heterogeneity in continuous, counts and proportions"</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "step by step online tutorial"</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co"> - name: Shinichi Nakagawa</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="co"> - name: Santiago Ortega </span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co"> - name: Elena Gazzea</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co"> - name: Malgorzata Lagisz</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="co"> - name: Anna Lenz</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co"> - name: Erick Lundgren</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co"> - name: Ayumi Mizuno*</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 6</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-float: true</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-expand: true</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "**CONTENTS**"</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="co">    output-file: "index.html"</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="co">    # embed-resources: true</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="co">    # code-fold: true</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="co">    # number-sections: false</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a><span class="co">    # bibliography: ./bib/ref.bib</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: "12"</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a><span class="co">    mainfont: "Source Sans Pro"</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="co">    monofont: "Fira Code"</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a><span class="co">    # fontcolor: ""</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a><span class="co">    page-layout: article</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a><span class="co">    df_print: paged</span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a><span class="co">    code-line-numbers: false</span></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a><span class="co">    grid:</span></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a><span class="co">      margin-width: 120px</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a><span class="co"># crossref: </span></span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a><span class="co">#   fig-title: Figure     # (default is "Figure")</span></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a><span class="co">#   tbl-title: Table     # (default is "Table")</span></span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   title-delim: "—"     # (default is ":")</span></span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   fig-prefix: Fig.     # (default is "Figure")</span></span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a><span class="co">#   tbl-prefix: Table.   # (default is "Table")</span></span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb86-50"><a href="#cb86-50" aria-hidden="true" tabindex="-1"></a><span class="co">  tidy: true</span></span>
<span id="cb86-51"><a href="#cb86-51" aria-hidden="true" tabindex="-1"></a><span class="co">  # cache: true</span></span>
<span id="cb86-52"><a href="#cb86-52" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb86-53"><a href="#cb86-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-54"><a href="#cb86-54" aria-hidden="true" tabindex="-1"></a>If you have any questions, errors or bug reports, please feel free to contact Ayumi Mizuno (amizuno\@ualberta.ca / ayumi.mizuno5\@gmail.com).</span>
<span id="cb86-55"><a href="#cb86-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-56"><a href="#cb86-56" aria-hidden="true" tabindex="-1"></a>Some of the models in this tutorial take a long time to run. To make the tutorial faster and easier to follow, we have precomputed selected models and saved them as .rds files.</span>
<span id="cb86-57"><a href="#cb86-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-58"><a href="#cb86-58" aria-hidden="true" tabindex="-1"></a>If you would like to re-run the code yourself and reproduce the results shown in the tutorial, please make sure to do the following:</span>
<span id="cb86-59"><a href="#cb86-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-60"><a href="#cb86-60" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Download the following files:</span>
<span id="cb86-61"><a href="#cb86-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-62"><a href="#cb86-62" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>online_tutorial.qmd (the source file for this website)</span>
<span id="cb86-63"><a href="#cb86-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-64"><a href="#cb86-64" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>All datasets in the data folder</span>
<span id="cb86-65"><a href="#cb86-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-66"><a href="#cb86-66" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The precomputed .rds files from Google Drive Google Drive link: <span class="ot">&lt;https://drive.google.com/drive/folders/1CvshmYMowXSB9MdbCprP1LP7llZNxIbe?usp=drive_link&gt;</span></span>
<span id="cb86-67"><a href="#cb86-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-68"><a href="#cb86-68" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Create a folder structure like this on your machine:</span>
<span id="cb86-69"><a href="#cb86-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-72"><a href="#cb86-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-73"><a href="#cb86-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-74"><a href="#cb86-74" aria-hidden="true" tabindex="-1"></a>    your<span class="sc">-</span>project<span class="sc">-</span>folder<span class="sc">/</span></span>
<span id="cb86-75"><a href="#cb86-75" aria-hidden="true" tabindex="-1"></a>    ├── online_tutorial.qmd</span>
<span id="cb86-76"><a href="#cb86-76" aria-hidden="true" tabindex="-1"></a>    ├── data<span class="sc">/</span></span>
<span id="cb86-77"><a href="#cb86-77" aria-hidden="true" tabindex="-1"></a>    │   └── (CSV files)</span>
<span id="cb86-78"><a href="#cb86-78" aria-hidden="true" tabindex="-1"></a>    └── Rdata<span class="sc">/</span></span>
<span id="cb86-79"><a href="#cb86-79" aria-hidden="true" tabindex="-1"></a>        └── (RDS files from Google Drive)</span>
<span id="cb86-80"><a href="#cb86-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-81"><a href="#cb86-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-82"><a href="#cb86-82" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Adjust file paths if your folder structure is different. We use <span class="in">`here::here()`</span>to help make paths more portable, but if you move or rename files/folders, make sure to update functions like <span class="in">`readRDS()`</span> or <span class="in">`read.csv()`</span> accordingly:</span>
<span id="cb86-83"><a href="#cb86-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-86"><a href="#cb86-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-87"><a href="#cb86-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-88"><a href="#cb86-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-89"><a href="#cb86-89" aria-hidden="true" tabindex="-1"></a><span class="co"># this is example</span></span>
<span id="cb86-90"><a href="#cb86-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-91"><a href="#cb86-91" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"XXX.csv"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>) </span>
<span id="cb86-92"><a href="#cb86-92" aria-hidden="true" tabindex="-1"></a>brms_m1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"brms_m1.rds"</span>))</span>
<span id="cb86-93"><a href="#cb86-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-94"><a href="#cb86-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-95"><a href="#cb86-95" aria-hidden="true" tabindex="-1"></a>You will see similar code snippets throughout the tutorial. Feel free to modify them based on your own setup. If everything is placed correctly, the <span class="in">`.qmd`</span> file should run without any issues.</span>
<span id="cb86-96"><a href="#cb86-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-97"><a href="#cb86-97" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb86-98"><a href="#cb86-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-99"><a href="#cb86-99" aria-hidden="true" tabindex="-1"></a>This tutorial provides a step-by-step guide to applying location-scale models in ecology, evolution, and environmental sciences. We focus on practical applications and demonstrate how to implement these models in <span class="in">`R`</span> using the <span class="in">`glmmTMB`</span> and <span class="in">`brms`</span> packages.</span>
<span id="cb86-100"><a href="#cb86-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-101"><a href="#cb86-101" aria-hidden="true" tabindex="-1"></a>After a brief introduction to both modeling frameworks, we present worked examples using real datasets. In the final section, we also discuss approaches for model comparison and selection.</span>
<span id="cb86-102"><a href="#cb86-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-103"><a href="#cb86-103" aria-hidden="true" tabindex="-1"></a><span class="fu"># Preparation</span></span>
<span id="cb86-104"><a href="#cb86-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-105"><a href="#cb86-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load required packages</span></span>
<span id="cb86-106"><a href="#cb86-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-107"><a href="#cb86-107" aria-hidden="true" tabindex="-1"></a>Our tutorial uses <span class="in">`R`</span> statistical software and existing <span class="in">`R`</span> packages, which you will first need to download and install.</span>
<span id="cb86-108"><a href="#cb86-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-109"><a href="#cb86-109" aria-hidden="true" tabindex="-1"></a>This tutorial makes use of several R packages for data manipulation, model fitting, diagnostics, visualisation, and reporting:</span>
<span id="cb86-110"><a href="#cb86-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-111"><a href="#cb86-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`dplyr`</span>, <span class="in">`tibble`</span>, <span class="in">`tidyverse`</span> - for efficient and tidy data manipulation.</span>
<span id="cb86-112"><a href="#cb86-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-113"><a href="#cb86-113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`brms`</span>, <span class="in">`glmmTMB`</span>, <span class="in">`arm`</span> - for fitting generalised linear mixed models.</span>
<span id="cb86-114"><a href="#cb86-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-115"><a href="#cb86-115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cmdstanr`</span> - interfaces with the CmdStan backend to accelerate Bayesian sampling via within-chain parallelisation. is a C++ library for Bayesian inference, in order to enable within-chain parallelisation to speeding up the sampling process.</span>
<span id="cb86-116"><a href="#cb86-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-117"><a href="#cb86-117" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`DHARMa`</span>, <span class="in">`loo`</span>, <span class="in">`MuMIn`</span> - for model diagnostics, cross-validation, and multi-model inference (note that both <span class="in">`loo`</span> and <span class="in">`Mumin`</span> contain functions with the same names, so call them with explicit namespaces, e.g. <span class="in">`loo::loo( )`</span>).</span>
<span id="cb86-118"><a href="#cb86-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-119"><a href="#cb86-119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ggplot2`</span>, <span class="in">`patchwork`</span>, <span class="in">`bayesplot`</span>, <span class="in">`tidybayes`</span> - for flexible and publication-ready visualisations.</span>
<span id="cb86-120"><a href="#cb86-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-121"><a href="#cb86-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`gt`</span>, <span class="in">`kableExtra`</span>, <span class="in">`knitr`</span> - for creating clean tables.</span>
<span id="cb86-122"><a href="#cb86-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-123"><a href="#cb86-123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`here`</span> - for consistent file path management across projects.</span>
<span id="cb86-124"><a href="#cb86-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-125"><a href="#cb86-125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ape`</span>, <span class="in">`TreeTools`</span> - for phylogenetic analyses and tree manipulation.</span>
<span id="cb86-126"><a href="#cb86-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-129"><a href="#cb86-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-130"><a href="#cb86-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load_packages</span></span>
<span id="cb86-131"><a href="#cb86-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-132"><a href="#cb86-132" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb86-133"><a href="#cb86-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-134"><a href="#cb86-134" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb86-135"><a href="#cb86-135" aria-hidden="true" tabindex="-1"></a>  <span class="do">## data manipulation</span></span>
<span id="cb86-136"><a href="#cb86-136" aria-hidden="true" tabindex="-1"></a>  dplyr, tibble, tidyverse,</span>
<span id="cb86-137"><a href="#cb86-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-138"><a href="#cb86-138" aria-hidden="true" tabindex="-1"></a>  <span class="do">## model fitting</span></span>
<span id="cb86-139"><a href="#cb86-139" aria-hidden="true" tabindex="-1"></a>  ape, arm, brms, broom.mixed, cmdstanr, emmeans, glmmTMB, MASS, phytools, rstan, TreeTools,</span>
<span id="cb86-140"><a href="#cb86-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-141"><a href="#cb86-141" aria-hidden="true" tabindex="-1"></a>  <span class="do">## model checking and evaluation</span></span>
<span id="cb86-142"><a href="#cb86-142" aria-hidden="true" tabindex="-1"></a>  DHARMa, loo, MuMIn, parallel,</span>
<span id="cb86-143"><a href="#cb86-143" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-144"><a href="#cb86-144" aria-hidden="true" tabindex="-1"></a>  <span class="do">## visualisation</span></span>
<span id="cb86-145"><a href="#cb86-145" aria-hidden="true" tabindex="-1"></a>  bayesplot, ggplot2, patchwork, tidybayes,</span>
<span id="cb86-146"><a href="#cb86-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-147"><a href="#cb86-147" aria-hidden="true" tabindex="-1"></a>  <span class="do">## reporting and utilities</span></span>
<span id="cb86-148"><a href="#cb86-148" aria-hidden="true" tabindex="-1"></a>  gt, here, kableExtra, knitr</span>
<span id="cb86-149"><a href="#cb86-149" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-150"><a href="#cb86-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-151"><a href="#cb86-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-152"><a href="#cb86-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## `glmmTMB` vs `brms`</span></span>
<span id="cb86-153"><a href="#cb86-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-154"><a href="#cb86-154" aria-hidden="true" tabindex="-1"></a><span class="in">`glmmTMB`</span> is a powerful and flexible <span class="in">`R`</span> package for fitting generalized linear mixed models (GLMMs), including models with random effect structures and scale (dispersion) part. It is built on the Template Model Builder (TMB) framework, which allows fast and efficient maximum likelihood estimation even for large and complex models.</span>
<span id="cb86-155"><a href="#cb86-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-156"><a href="#cb86-156" aria-hidden="true" tabindex="-1"></a><span class="in">`brms`</span> is an <span class="in">`R`</span> package that allows users to fit Bayesian generalized (non-)linear multilevel models using the probabilistic programming language Stan. It provides a user-friendly formula syntax similar to that of <span class="in">`lme4`</span> or <span class="in">`glmmTMB`</span>, and supports a wide range of distributions, link functions, and advanced model components, including location-scale modeling.</span>
<span id="cb86-157"><a href="#cb86-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-158"><a href="#cb86-158" aria-hidden="true" tabindex="-1"></a>Both packages are suitable for fitting location-scale models and are widely used in ecology and its related fields. Therefore, we selected them to illustrate how location-scale models can be practically applied in real data analysis.</span>
<span id="cb86-159"><a href="#cb86-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-160"><a href="#cb86-160" aria-hidden="true" tabindex="-1"></a>While <span class="in">`brms`</span> is a powerful and flexible package for Bayesian regression modeling, some readers may not be familiar with its usage. Below, we provide a brief introduction to fitting models using <span class="in">`brms`</span>, focusing on the basic location-scale structure and key functions relevant to our analysis. You can also find some examples each section…</span>
<span id="cb86-161"><a href="#cb86-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-162"><a href="#cb86-162" aria-hidden="true" tabindex="-1"></a>If you get stuck or are unsure about something, it might be helpful to check the below:</span>
<span id="cb86-163"><a href="#cb86-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-164"><a href="#cb86-164" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://paulbuerkner.com/brms/index.html&gt;</span></span>
<span id="cb86-165"><a href="#cb86-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-166"><a href="#cb86-166" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://discourse.mc-stan.org/&gt;</span></span>
<span id="cb86-167"><a href="#cb86-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-168"><a href="#cb86-168" aria-hidden="true" tabindex="-1"></a>This example shows how to fit a simple location-scale model, where both the mean ($\mu$) and the variability ($\sigma$) of a continuous outcome variable $y$ are modeled as functions of a predictor $x$.</span>
<span id="cb86-169"><a href="#cb86-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-172"><a href="#cb86-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-173"><a href="#cb86-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-174"><a href="#cb86-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-175"><a href="#cb86-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Example dataset</span></span>
<span id="cb86-176"><a href="#cb86-176" aria-hidden="true" tabindex="-1"></a><span class="co"># y is continuous response, x is a predictor</span></span>
<span id="cb86-177"><a href="#cb86-177" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model using bf()</span></span>
<span id="cb86-178"><a href="#cb86-178" aria-hidden="true" tabindex="-1"></a>formula1 <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb86-179"><a href="#cb86-179" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x,  <span class="co"># location part</span></span>
<span id="cb86-180"><a href="#cb86-180" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> x <span class="co"># scale part - specified by sigma</span></span>
<span id="cb86-181"><a href="#cb86-181" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-182"><a href="#cb86-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-183"><a href="#cb86-183" aria-hidden="true" tabindex="-1"></a><span class="co"># generate default priors based on the formula and data</span></span>
<span id="cb86-184"><a href="#cb86-184" aria-hidden="true" tabindex="-1"></a>default_priors <span class="ot">&lt;-</span> <span class="fu">default_prior</span>(</span>
<span id="cb86-185"><a href="#cb86-185" aria-hidden="true" tabindex="-1"></a>                        formula1,</span>
<span id="cb86-186"><a href="#cb86-186" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> dat,                             </span>
<span id="cb86-187"><a href="#cb86-187" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">gaussian</span>()                               </span>
<span id="cb86-188"><a href="#cb86-188" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb86-189"><a href="#cb86-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-190"><a href="#cb86-190" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model - you can change N of iter, warmup (and thin), and also chains.</span></span>
<span id="cb86-191"><a href="#cb86-191" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(formula1,</span>
<span id="cb86-192"><a href="#cb86-192" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dat,           </span>
<span id="cb86-193"><a href="#cb86-193" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">gaussian</span>(),                   </span>
<span id="cb86-194"><a href="#cb86-194" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prior =</span> default_priors,                </span>
<span id="cb86-195"><a href="#cb86-195" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iter =</span> <span class="dv">2000</span>,   <span class="co"># total iterations per Markov-chain (i.e., how many posterior samples are drawn, including warm-up)</span></span>
<span id="cb86-196"><a href="#cb86-196" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb86-197"><a href="#cb86-197" aria-hidden="true" tabindex="-1"></a>                  <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="co"># number of early draws used only for adapting the sampler (step-size, mass matrix). These samples are discarded</span></span>
<span id="cb86-198"><a href="#cb86-198" aria-hidden="true" tabindex="-1"></a>                  <span class="at">thin =</span> <span class="dv">1</span>,      <span class="co"># keep every n-th post-warm-up draw. 1 means keep all draws                    </span></span>
<span id="cb86-199"><a href="#cb86-199" aria-hidden="true" tabindex="-1"></a>                  <span class="at">chains =</span> <span class="dv">2</span>,    <span class="co">#  number of independent MCMC chains run in parallel. Provides a convergence check (via Rhat)                    </span></span>
<span id="cb86-200"><a href="#cb86-200" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb86-201"><a href="#cb86-201" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span>
<span id="cb86-202"><a href="#cb86-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-203"><a href="#cb86-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-204"><a href="#cb86-204" aria-hidden="true" tabindex="-1"></a>After fitting the model, you can use <span class="in">`summary(m1)`</span> to inspect the estimated coefficients and sigma with 95% Credible Intervals, along with diagnostic statistics such as Rhat and effective sample size. To better understand how to interpret the model output, please refer to the “**Bonus - brms**” part in the next section.</span>
<span id="cb86-205"><a href="#cb86-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-206"><a href="#cb86-206" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parallel Processing</span></span>
<span id="cb86-207"><a href="#cb86-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-208"><a href="#cb86-208" aria-hidden="true" tabindex="-1"></a>Before fitting our models with <span class="in">`brms`</span>, we configure some global options to optimize sampling speed using parallel processing:</span>
<span id="cb86-209"><a href="#cb86-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-210"><a href="#cb86-210" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span><span class="in">`parallel::detectCores()`</span>: This function automatically detects the number of logical CPU cores available on your machine. This is a convenient way to ensure your code adapts to different computing environments.</span>
<span id="cb86-211"><a href="#cb86-211" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span><span class="in">`options(mc.cores = parallel::detectCores())`</span>: The mc.cores option is a global setting primarily used by rstan (the engine behind brms). It controls the number of MCMC chains that will be run in parallel. By setting it to <span class="in">`detectCores()`</span>, you are telling brms to run as many chains concurrently as your CPU allows, significantly speeding up the overall sampling process.</span>
<span id="cb86-212"><a href="#cb86-212" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span><span class="in">`options(brms.threads = 6)`</span>: The brms.threads option specifies the number of CPU threads that Stan's internal operations can utilize within a single MCMC chain. This enables within-chain parallelisation, further accelerating computations, especially for complex or large datasets. The value 6 is an example; you can adjust this based on your specific CPU architecture and memory.</span>
<span id="cb86-213"><a href="#cb86-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-214"><a href="#cb86-214" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="simple" icon="false"}</span>
<span id="cb86-215"><a href="#cb86-215" aria-hidden="true" tabindex="-1"></a>Threading is a powerful feature that enables you to split a chain into multiple parallel threads, significantly reducing computation time. However, it requires installing both <span class="in">`cmdstanr`</span> and the underlying <span class="in">`CmdStan`</span> backend.</span>
<span id="cb86-216"><a href="#cb86-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-219"><a href="#cb86-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-220"><a href="#cb86-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb86-221"><a href="#cb86-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-222"><a href="#cb86-222" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Set up CmdStan and confirm proper installation</span></span>
<span id="cb86-223"><a href="#cb86-223" aria-hidden="true" tabindex="-1"></a>cmdstanr<span class="sc">::</span><span class="fu">install_cmdstan</span>()</span>
<span id="cb86-224"><a href="#cb86-224" aria-hidden="true" tabindex="-1"></a>cmdstanr<span class="sc">::</span><span class="fu">check_cmdstan_toolchain</span>()</span>
<span id="cb86-225"><a href="#cb86-225" aria-hidden="true" tabindex="-1"></a>cmdstanr<span class="sc">::</span><span class="fu">cmdstan_version</span>()</span>
<span id="cb86-226"><a href="#cb86-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-227"><a href="#cb86-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-228"><a href="#cb86-228" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-229"><a href="#cb86-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-230"><a href="#cb86-230" aria-hidden="true" tabindex="-1"></a>These settings are crucial for making Bayesian model fitting with <span class="in">`brms`</span> more efficient, particularly for complex models or large datasets.</span>
<span id="cb86-231"><a href="#cb86-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-234"><a href="#cb86-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-235"><a href="#cb86-235" aria-hidden="true" tabindex="-1"></a>parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb86-236"><a href="#cb86-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-237"><a href="#cb86-237" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb86-238"><a href="#cb86-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-239"><a href="#cb86-239" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">brms.threads =</span> <span class="dv">6</span>)  <span class="co"># Set global default</span></span>
<span id="cb86-240"><a href="#cb86-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-241"><a href="#cb86-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-242"><a href="#cb86-242" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="simple" icon="false"}</span>
<span id="cb86-243"><a href="#cb86-243" aria-hidden="true" tabindex="-1"></a><span class="in">`brms`</span> models can be computationally intensive and take a significant amount of time to run. To streamline your workflow, we provide the pre-fit models in RDS files, allowing you to load them directly without needing to re-run the lengthy estimation process.</span>
<span id="cb86-244"><a href="#cb86-244" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-245"><a href="#cb86-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-246"><a href="#cb86-246" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specifying the Scale Component</span></span>
<span id="cb86-247"><a href="#cb86-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-248"><a href="#cb86-248" aria-hidden="true" tabindex="-1"></a>Here's how the scale component is handled in <span class="in">`glmmTMB`</span> and <span class="in">`brms`</span>, along with common parameter names for various distributions:</span>
<span id="cb86-249"><a href="#cb86-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-250"><a href="#cb86-250" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Distribution <span class="pp">|</span> Scale Parameter (Example) <span class="pp">|</span> <span class="in">`glmmTMB`</span> Specification <span class="pp">|</span> <span class="in">`brms`</span> Specification (Example) <span class="pp">|</span></span>
<span id="cb86-251"><a href="#cb86-251" aria-hidden="true" tabindex="-1"></a><span class="pp">|:-----------------|:-----------------|:-----------------|:-----------------|</span></span>
<span id="cb86-252"><a href="#cb86-252" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Gaussian <span class="pp">|</span> $\sigma$ <span class="pp">|</span> <span class="in">`dispformula = ~ ...`</span> <span class="pp">|</span> <span class="in">`bf(..., sigma ~ ...)`</span> <span class="pp">|</span></span>
<span id="cb86-253"><a href="#cb86-253" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Negative Binomial <span class="pp">|</span> $\theta$ <span class="pp">|</span> <span class="in">`dispformula = ~ ...`</span> <span class="pp">|</span> <span class="in">`bf(..., shape ~ ...)`</span> <span class="pp">|</span></span>
<span id="cb86-254"><a href="#cb86-254" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Conway-Maxwell-Poisson <span class="pp">|</span> $\nu$ <span class="pp">|</span> <span class="in">`dispformula = ~ ...`</span> <span class="pp">|</span> <span class="in">`bf(..., nu ~ ...)`</span> <span class="pp">|</span></span>
<span id="cb86-255"><a href="#cb86-255" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Beta-Binomial <span class="pp">|</span> $\phi$ <span class="pp">|</span> <span class="in">`dispformula = ~ ...`</span> <span class="pp">|</span> <span class="in">`bf(..., phi ~ ...)`</span> <span class="pp">|</span></span>
<span id="cb86-256"><a href="#cb86-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-257"><a href="#cb86-257" aria-hidden="true" tabindex="-1"></a>*Note: In `glmmTMB`, `dispformula` is generally used to model the dispersion or scale parameter, regardless of its specific Greek letter notation, which varies by distribution.*</span>
<span id="cb86-258"><a href="#cb86-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-259"><a href="#cb86-259" aria-hidden="true" tabindex="-1"></a>The scale part varies depending on the distribution: for example, $\sigma$ for Gaussian or $\theta$ for negative binomial, $\nu$ for Conway–Maxwell–Poisson, $\phi$ for beta- binomial distribution (see the main text).</span>
<span id="cb86-260"><a href="#cb86-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-261"><a href="#cb86-261" aria-hidden="true" tabindex="-1"></a><span class="fu"># Fixed-effects location–scale model (model 1)</span></span>
<span id="cb86-262"><a href="#cb86-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-263"><a href="#cb86-263" aria-hidden="true" tabindex="-1"></a>Model 1 is a fixed-effects location-scale model, which allows us to model both the mean (location) and variance (scale) of a response variable simultaneously. This is particularly useful when we suspect that the variance of the response variable may differ across groups or treatments.</span>
<span id="cb86-264"><a href="#cb86-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-265"><a href="#cb86-265" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dataset overview</span></span>
<span id="cb86-266"><a href="#cb86-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-267"><a href="#cb86-267" aria-hidden="true" tabindex="-1"></a>This dataset comes from a study by <span class="co">[</span><span class="ot">Cleasby et al. (2011)</span><span class="co">](https://doi.org/10.1186/1756-0500-4-431)</span>, which investigated the effects of early-life food supplementation on adult morphology in a wild population of house sparrows (*Passer domesticus*). In particular, we focus on adult tarsus length as a measure of skeletal size. The dataset includes adult birds that either received supplemental food as chicks or not, and compares their tarsus length by treatment and sex.</span>
<span id="cb86-268"><a href="#cb86-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-269"><a href="#cb86-269" aria-hidden="true" tabindex="-1"></a><span class="fu">### Questions</span></span>
<span id="cb86-270"><a href="#cb86-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-271"><a href="#cb86-271" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Does early-life food supplementation increase adult size? Specifically, does it increase the average tarsus length in adulthood?**</span>
<span id="cb86-272"><a href="#cb86-272" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Does early-life food supplementation lead to lower variation in adult tarsus length?**</span>
<span id="cb86-273"><a href="#cb86-273" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Are there sex-specific effects of food supplementation? Do the effects on mean or variance differ between males and females?**</span>
<span id="cb86-274"><a href="#cb86-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-275"><a href="#cb86-275" aria-hidden="true" tabindex="-1"></a>**Variables included**</span>
<span id="cb86-276"><a href="#cb86-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-277"><a href="#cb86-277" aria-hidden="true" tabindex="-1"></a>The dataset includes adult birds that either received supplemental food as chicks or not, and compares their tarsus length by treatment and sex. We use the following variables:</span>
<span id="cb86-278"><a href="#cb86-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-279"><a href="#cb86-279" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple" icon="false"}</span>
<span id="cb86-280"><a href="#cb86-280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Sex`</span>: Biological sex of the bird (“Male” or “Female”)</span>
<span id="cb86-281"><a href="#cb86-281" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`AdTarsus`</span>: Adult tarsus length (mm)</span>
<span id="cb86-282"><a href="#cb86-282" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Treatment`</span>: Whether the bird received food supplementation as a chick (<span class="in">`Fed`</span>) or not (<span class="in">`Control`</span>)</span>
<span id="cb86-283"><a href="#cb86-283" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-284"><a href="#cb86-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-285"><a href="#cb86-285" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualise the datasets</span></span>
<span id="cb86-286"><a href="#cb86-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-287"><a href="#cb86-287" aria-hidden="true" tabindex="-1"></a>The plot shows how adult tarsus length varies by treatment (early-life food supplementation) and sex. Boxplots summarise the central tendency and spread, while the jittered points reveal the distribution of individual values. As shown in the plot, there is a clear tendency for reduced variability in the **male treatment group** (<span class="in">`Fed`</span>), suggesting that early-life food supplementation may lead to more canalised development in males.</span>
<span id="cb86-288"><a href="#cb86-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-291"><a href="#cb86-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-292"><a href="#cb86-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show_data - model1</span></span>
<span id="cb86-293"><a href="#cb86-293" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb86-294"><a href="#cb86-294" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-295"><a href="#cb86-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-296"><a href="#cb86-296" aria-hidden="true" tabindex="-1"></a><span class="co"># load the datasets　----</span></span>
<span id="cb86-297"><a href="#cb86-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-298"><a href="#cb86-298" aria-hidden="true" tabindex="-1"></a>dat_tarsus <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"SparrowTarsusData.csv"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-299"><a href="#cb86-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-300"><a href="#cb86-300" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_tarsus, <span class="fu">aes</span>(<span class="at">x =</span> Treatment, <span class="at">y =</span> AdTarsus, <span class="at">fill =</span> Sex)) <span class="sc">+</span></span>
<span id="cb86-301"><a href="#cb86-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb86-302"><a href="#cb86-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb86-303"><a href="#cb86-303" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> Sex),</span>
<span id="cb86-304"><a href="#cb86-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb86-305"><a href="#cb86-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">jitter.width =</span> <span class="fl">0.2</span>, <span class="at">dodge.width =</span> <span class="fl">0.8</span>)</span>
<span id="cb86-306"><a href="#cb86-306" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-307"><a href="#cb86-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Male"</span> <span class="ot">=</span> <span class="st">"#1f78b4"</span>, <span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"#e31a1c"</span>)) <span class="sc">+</span> </span>
<span id="cb86-308"><a href="#cb86-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Male"</span> <span class="ot">=</span> <span class="st">"#1f78b4"</span>, <span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"#e31a1c"</span>)) <span class="sc">+</span></span>
<span id="cb86-309"><a href="#cb86-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Adult tarsus length by treatment and sex"</span>,</span>
<span id="cb86-310"><a href="#cb86-310" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Treatment"</span>, <span class="at">y =</span> <span class="st">"Tarsus length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb86-311"><a href="#cb86-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb86-312"><a href="#cb86-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb86-313"><a href="#cb86-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-314"><a href="#cb86-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-315"><a href="#cb86-315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Run models and interpret results</span></span>
<span id="cb86-316"><a href="#cb86-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-317"><a href="#cb86-317" aria-hidden="true" tabindex="-1"></a>We fit and compare two types of models to understand the structure of adult tarsus length:</span>
<span id="cb86-318"><a href="#cb86-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-319"><a href="#cb86-319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Location-only model: Estimates the mean of adult tarsus length as a function of sex and early-life food supplementation (treatment).</span>
<span id="cb86-320"><a href="#cb86-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-321"><a href="#cb86-321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Location-scale model: Estimates both the mean and the variability (residual dispersion) of adult tarsus length, allowing us to examine whether treatment and sex influence not only the average trait value but also its individual variation.</span>
<span id="cb86-322"><a href="#cb86-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-323"><a href="#cb86-323" aria-hidden="true" tabindex="-1"></a>This approach enables us to detect subtle patterns, such as sex-specific canalisation, that may not be captured when modeling the mean alone.</span>
<span id="cb86-324"><a href="#cb86-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-325"><a href="#cb86-325" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model fitting</span></span>
<span id="cb86-326"><a href="#cb86-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-327"><a href="#cb86-327" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb86-328"><a href="#cb86-328" aria-hidden="true" tabindex="-1"></a><span class="fu">## Location model</span></span>
<span id="cb86-329"><a href="#cb86-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-330"><a href="#cb86-330" aria-hidden="true" tabindex="-1"></a>First, we fit a location-only model as the baseline model.</span>
<span id="cb86-331"><a href="#cb86-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-334"><a href="#cb86-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-335"><a href="#cb86-335" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting1 - gaussian model1</span></span>
<span id="cb86-336"><a href="#cb86-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-337"><a href="#cb86-337" aria-hidden="true" tabindex="-1"></a><span class="co"># location-only model ----</span></span>
<span id="cb86-338"><a href="#cb86-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-339"><a href="#cb86-339" aria-hidden="true" tabindex="-1"></a><span class="do">## log-transformation was applied to AdTarsus to reduce skewness and stabilize residual variance.</span></span>
<span id="cb86-340"><a href="#cb86-340" aria-hidden="true" tabindex="-1"></a>model_0 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb86-341"><a href="#cb86-341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(AdTarsus) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Sex <span class="sc">+</span> Treatment <span class="sc">+</span> Sex<span class="sc">:</span>Treatment,</span>
<span id="cb86-342"><a href="#cb86-342" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dat_tarsus, </span>
<span id="cb86-343"><a href="#cb86-343" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> gaussian)</span>
<span id="cb86-344"><a href="#cb86-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-345"><a href="#cb86-345" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_0)</span>
<span id="cb86-346"><a href="#cb86-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-347"><a href="#cb86-347" aria-hidden="true" tabindex="-1"></a><span class="do">## to quantify the uncertainty in parameter estimates, we computed 95% confidence intervals using the confint() function.</span></span>
<span id="cb86-348"><a href="#cb86-348" aria-hidden="true" tabindex="-1"></a><span class="do">## this function returns the lower and upper bounds for each fixed/random effect parameters. If a confidence interval does not include zero, it suggests that the corresponding predictor has a statistically significant effect (at approximately the 0.05 level).</span></span>
<span id="cb86-349"><a href="#cb86-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-350"><a href="#cb86-350" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_0) <span class="co"># check 95%CI</span></span>
<span id="cb86-351"><a href="#cb86-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-352"><a href="#cb86-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-353"><a href="#cb86-353" aria-hidden="true" tabindex="-1"></a><span class="fu">## Residual diagnostics</span></span>
<span id="cb86-354"><a href="#cb86-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-355"><a href="#cb86-355" aria-hidden="true" tabindex="-1"></a>We can check the residuals of the model to assess the model fit and assumptions. The Q-Q plot should show points falling along a straight line.</span>
<span id="cb86-356"><a href="#cb86-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-359"><a href="#cb86-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-360"><a href="#cb86-360" aria-hidden="true" tabindex="-1"></a><span class="co"># | label: model0_diagnostics - model1</span></span>
<span id="cb86-361"><a href="#cb86-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-362"><a href="#cb86-362" aria-hidden="true" tabindex="-1"></a><span class="co"># plot a q-q plot of residuals to visually assess the normality assumption</span></span>
<span id="cb86-363"><a href="#cb86-363" aria-hidden="true" tabindex="-1"></a><span class="co"># the data points should fail approximately along the reference line</span></span>
<span id="cb86-364"><a href="#cb86-364" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_0)</span>
<span id="cb86-365"><a href="#cb86-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-366"><a href="#cb86-366" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res) <span class="co"># visual check for normality of residuals</span></span>
<span id="cb86-367"><a href="#cb86-367" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(res) <span class="co"># reference line for normal distribution</span></span>
<span id="cb86-368"><a href="#cb86-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-369"><a href="#cb86-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-370"><a href="#cb86-370" aria-hidden="true" tabindex="-1"></a>The residuals mostly follow a straight line in the Q-Q plot, but there are some deviations, particularly at the lower and upper ends. This suggests that the model may not fully capture the distribution of the data, indicating some potential issues with normality or heteroscedasticity.</span>
<span id="cb86-371"><a href="#cb86-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-372"><a href="#cb86-372" aria-hidden="true" tabindex="-1"></a><span class="fu">## Location-scale model</span></span>
<span id="cb86-373"><a href="#cb86-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-374"><a href="#cb86-374" aria-hidden="true" tabindex="-1"></a>Then, we fit a location-scale model.</span>
<span id="cb86-375"><a href="#cb86-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-378"><a href="#cb86-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-379"><a href="#cb86-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting2 - model1</span></span>
<span id="cb86-380"><a href="#cb86-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-381"><a href="#cb86-381" aria-hidden="true" tabindex="-1"></a><span class="co"># location-scale model ---- </span></span>
<span id="cb86-382"><a href="#cb86-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-383"><a href="#cb86-383" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb86-384"><a href="#cb86-384" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(AdTarsus) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Sex <span class="sc">+</span> Treatment <span class="sc">+</span> Sex<span class="sc">:</span>Treatment, <span class="co"># location part</span></span>
<span id="cb86-385"><a href="#cb86-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">dispformula =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Sex <span class="sc">+</span> Treatment <span class="sc">+</span> Sex<span class="sc">:</span>Treatment, <span class="co"># scale part</span></span>
<span id="cb86-386"><a href="#cb86-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dat_tarsus, </span>
<span id="cb86-387"><a href="#cb86-387" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> gaussian</span>
<span id="cb86-388"><a href="#cb86-388" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-389"><a href="#cb86-389" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)</span>
<span id="cb86-390"><a href="#cb86-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-391"><a href="#cb86-391" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_1) </span>
<span id="cb86-392"><a href="#cb86-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-393"><a href="#cb86-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-394"><a href="#cb86-394" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model comparison</span></span>
<span id="cb86-395"><a href="#cb86-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-396"><a href="#cb86-396" aria-hidden="true" tabindex="-1"></a>Now we can compare the two models to see if the location-scale model provides a better fit to the data than the location-only model. We can use the <span class="in">`anova()`</span> function to compare the two models based on their AIC values. Alternatively, we can use the <span class="in">`model.sel()`</span> function from the <span class="in">`MuMIn`</span> package to compare AICc values, which is more appropriate for small sample sizes.</span>
<span id="cb86-397"><a href="#cb86-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-400"><a href="#cb86-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-401"><a href="#cb86-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_comparison - model1</span></span>
<span id="cb86-402"><a href="#cb86-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-403"><a href="#cb86-403" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models ----</span></span>
<span id="cb86-404"><a href="#cb86-404" aria-hidden="true" tabindex="-1"></a><span class="do">## we can use the anova() function to compare the two models of AIC </span></span>
<span id="cb86-405"><a href="#cb86-405" aria-hidden="true" tabindex="-1"></a><span class="do">## model.sel() from the MuMIn package can be used to compare AICc values.</span></span>
<span id="cb86-406"><a href="#cb86-406" aria-hidden="true" tabindex="-1"></a><span class="fu">model.sel</span>(model_0, model_1)</span>
<span id="cb86-407"><a href="#cb86-407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-408"><a href="#cb86-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-409"><a href="#cb86-409" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of model results</span></span>
<span id="cb86-410"><a href="#cb86-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-411"><a href="#cb86-411" aria-hidden="true" tabindex="-1"></a>The results of the location-only model (Model 0) and the location-scale model (Model 1) are summarised below.</span>
<span id="cb86-412"><a href="#cb86-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-415"><a href="#cb86-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-416"><a href="#cb86-416" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-417"><a href="#cb86-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model0_results</span></span>
<span id="cb86-418"><a href="#cb86-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-419"><a href="#cb86-419" aria-hidden="true" tabindex="-1"></a><span class="co"># Location-only model (Model 0) ----</span></span>
<span id="cb86-420"><a href="#cb86-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-421"><a href="#cb86-421" aria-hidden="true" tabindex="-1"></a><span class="do">## extract fixed effect estimates/95CIs from the model</span></span>
<span id="cb86-422"><a href="#cb86-422" aria-hidden="true" tabindex="-1"></a>coefs_0 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_0)<span class="sc">$</span>coefficients<span class="sc">$</span>cond</span>
<span id="cb86-423"><a href="#cb86-423" aria-hidden="true" tabindex="-1"></a>conf_0 <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_0)</span>
<span id="cb86-424"><a href="#cb86-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-425"><a href="#cb86-425" aria-hidden="true" tabindex="-1"></a><span class="do">## remove the "cond." prefix from row names to match with coefficient names, </span></span>
<span id="cb86-426"><a href="#cb86-426" aria-hidden="true" tabindex="-1"></a><span class="do">## keep only the rows that match the location model term, and match the row order between coefficients and confidence intervals</span></span>
<span id="cb86-427"><a href="#cb86-427" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(conf_0) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"^cond</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, <span class="fu">rownames</span>(conf_0))</span>
<span id="cb86-428"><a href="#cb86-428" aria-hidden="true" tabindex="-1"></a>conf_0 <span class="ot">&lt;-</span> conf_0[<span class="fu">rownames</span>(conf_0) <span class="sc">%in%</span> <span class="fu">rownames</span>(coefs_0), ]</span>
<span id="cb86-429"><a href="#cb86-429" aria-hidden="true" tabindex="-1"></a>match_0 <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(coefs_0), <span class="fu">rownames</span>(conf_0))</span>
<span id="cb86-430"><a href="#cb86-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-431"><a href="#cb86-431" aria-hidden="true" tabindex="-1"></a><span class="do">## create a data frame </span></span>
<span id="cb86-432"><a href="#cb86-432" aria-hidden="true" tabindex="-1"></a>results_0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb86-433"><a href="#cb86-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coefs_0),</span>
<span id="cb86-434"><a href="#cb86-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coefs_0[, <span class="st">"Estimate"</span>],</span>
<span id="cb86-435"><a href="#cb86-435" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdError =</span> coefs_0[, <span class="st">"Std. Error"</span>],</span>
<span id="cb86-436"><a href="#cb86-436" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span> <span class="ot">=</span> conf_0[match_0, <span class="st">"2.5 %"</span>],</span>
<span id="cb86-437"><a href="#cb86-437" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">97.5%</span><span class="st">`</span> <span class="ot">=</span> conf_0[match_0, <span class="st">"97.5 %"</span>]</span>
<span id="cb86-438"><a href="#cb86-438" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-439"><a href="#cb86-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-440"><a href="#cb86-440" aria-hidden="true" tabindex="-1"></a><span class="do">## rename 95%CI columns to avoid issues with special characters in column names </span></span>
<span id="cb86-441"><a href="#cb86-441" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_0)[<span class="fu">which</span>(<span class="fu">names</span>(results_0) <span class="sc">==</span> <span class="st">"X2.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_low"</span></span>
<span id="cb86-442"><a href="#cb86-442" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_0)[<span class="fu">which</span>(<span class="fu">names</span>(results_0) <span class="sc">==</span> <span class="st">"X97.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_high"</span></span>
<span id="cb86-443"><a href="#cb86-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-444"><a href="#cb86-444" aria-hidden="true" tabindex="-1"></a><span class="do">## display results ----</span></span>
<span id="cb86-445"><a href="#cb86-445" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(results_0) <span class="sc">%&gt;%</span></span>
<span id="cb86-446"><a href="#cb86-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Location-only model"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-447"><a href="#cb86-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">everything</span>(), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-448"><a href="#cb86-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb86-449"><a href="#cb86-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> <span class="st">"Term"</span>,</span>
<span id="cb86-450"><a href="#cb86-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb86-451"><a href="#cb86-451" aria-hidden="true" tabindex="-1"></a>    <span class="at">StdError =</span> <span class="st">"Std. Error"</span>,</span>
<span id="cb86-452"><a href="#cb86-452" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_low =</span> <span class="st">"95% CI (low)"</span>,</span>
<span id="cb86-453"><a href="#cb86-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_high =</span> <span class="st">"95% CI (high)"</span></span>
<span id="cb86-454"><a href="#cb86-454" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-455"><a href="#cb86-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>())</span>
<span id="cb86-456"><a href="#cb86-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-457"><a href="#cb86-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-460"><a href="#cb86-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-461"><a href="#cb86-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model1_results</span></span>
<span id="cb86-462"><a href="#cb86-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-463"><a href="#cb86-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-464"><a href="#cb86-464" aria-hidden="true" tabindex="-1"></a><span class="co"># Location-scale model (Model 1) ----</span></span>
<span id="cb86-465"><a href="#cb86-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-466"><a href="#cb86-466" aria-hidden="true" tabindex="-1"></a><span class="do">## extract fixed effect estimates/95%CIs from the model</span></span>
<span id="cb86-467"><a href="#cb86-467" aria-hidden="true" tabindex="-1"></a>summary_1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_1)</span>
<span id="cb86-468"><a href="#cb86-468" aria-hidden="true" tabindex="-1"></a>conf_1 <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_1)</span>
<span id="cb86-469"><a href="#cb86-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-470"><a href="#cb86-470" aria-hidden="true" tabindex="-1"></a><span class="co"># location part ----</span></span>
<span id="cb86-471"><a href="#cb86-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-472"><a href="#cb86-472" aria-hidden="true" tabindex="-1"></a>coefs_1_loc <span class="ot">&lt;-</span> summary_1<span class="sc">$</span>coefficients<span class="sc">$</span>cond</span>
<span id="cb86-473"><a href="#cb86-473" aria-hidden="true" tabindex="-1"></a>conf_1_loc <span class="ot">&lt;-</span> conf_1[<span class="fu">grep</span>(<span class="st">"^cond"</span>, <span class="fu">rownames</span>(conf_1)), ]</span>
<span id="cb86-474"><a href="#cb86-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-475"><a href="#cb86-475" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(conf_1_loc) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"^cond</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, <span class="fu">rownames</span>(conf_1_loc))</span>
<span id="cb86-476"><a href="#cb86-476" aria-hidden="true" tabindex="-1"></a>conf_1_loc <span class="ot">&lt;-</span> conf_1_loc[<span class="fu">rownames</span>(conf_1_loc) <span class="sc">%in%</span> <span class="fu">rownames</span>(coefs_1_loc), ]</span>
<span id="cb86-477"><a href="#cb86-477" aria-hidden="true" tabindex="-1"></a>match_loc <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(coefs_1_loc), <span class="fu">rownames</span>(conf_1_loc))</span>
<span id="cb86-478"><a href="#cb86-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-479"><a href="#cb86-479" aria-hidden="true" tabindex="-1"></a>results_1_loc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb86-480"><a href="#cb86-480" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coefs_1_loc),</span>
<span id="cb86-481"><a href="#cb86-481" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coefs_1_loc[, <span class="st">"Estimate"</span>],</span>
<span id="cb86-482"><a href="#cb86-482" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdError =</span> coefs_1_loc[, <span class="st">"Std. Error"</span>],</span>
<span id="cb86-483"><a href="#cb86-483" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_low =</span> conf_1_loc[match_loc, <span class="st">"2.5 %"</span>],</span>
<span id="cb86-484"><a href="#cb86-484" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_high =</span> conf_1_loc[match_loc, <span class="st">"97.5 %"</span>]</span>
<span id="cb86-485"><a href="#cb86-485" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-486"><a href="#cb86-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-487"><a href="#cb86-487" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_1_loc)[<span class="fu">which</span>(<span class="fu">names</span>(results_1_loc) <span class="sc">==</span> <span class="st">"X2.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_low"</span></span>
<span id="cb86-488"><a href="#cb86-488" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_1_loc)[<span class="fu">which</span>(<span class="fu">names</span>(results_1_loc) <span class="sc">==</span> <span class="st">"X97.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_high"</span></span>
<span id="cb86-489"><a href="#cb86-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-490"><a href="#cb86-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-491"><a href="#cb86-491" aria-hidden="true" tabindex="-1"></a><span class="co"># dispersion part ----</span></span>
<span id="cb86-492"><a href="#cb86-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-493"><a href="#cb86-493" aria-hidden="true" tabindex="-1"></a>coefs_1_disp <span class="ot">&lt;-</span> summary_1<span class="sc">$</span>coefficients<span class="sc">$</span>disp</span>
<span id="cb86-494"><a href="#cb86-494" aria-hidden="true" tabindex="-1"></a>conf_1_disp <span class="ot">&lt;-</span> conf_1[<span class="fu">grep</span>(<span class="st">"^disp"</span>, <span class="fu">rownames</span>(conf_1)), ]</span>
<span id="cb86-495"><a href="#cb86-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-496"><a href="#cb86-496" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(conf_1_disp) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"^disp</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, <span class="fu">rownames</span>(conf_1_disp))</span>
<span id="cb86-497"><a href="#cb86-497" aria-hidden="true" tabindex="-1"></a>conf_1_disp <span class="ot">&lt;-</span> conf_1_disp[<span class="fu">rownames</span>(conf_1_disp) <span class="sc">%in%</span> <span class="fu">rownames</span>(coefs_1_disp), ]</span>
<span id="cb86-498"><a href="#cb86-498" aria-hidden="true" tabindex="-1"></a>match_disp <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(coefs_1_disp), <span class="fu">rownames</span>(conf_1_disp))</span>
<span id="cb86-499"><a href="#cb86-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-500"><a href="#cb86-500" aria-hidden="true" tabindex="-1"></a>results_1_disp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb86-501"><a href="#cb86-501" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coefs_1_disp),</span>
<span id="cb86-502"><a href="#cb86-502" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coefs_1_disp[, <span class="st">"Estimate"</span>],</span>
<span id="cb86-503"><a href="#cb86-503" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdError =</span> coefs_1_disp[, <span class="st">"Std. Error"</span>],</span>
<span id="cb86-504"><a href="#cb86-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_low =</span> conf_1_disp[match_disp, <span class="st">"2.5 %"</span>],</span>
<span id="cb86-505"><a href="#cb86-505" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_high =</span> conf_1_disp[match_disp, <span class="st">"97.5 %"</span>]</span>
<span id="cb86-506"><a href="#cb86-506" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-507"><a href="#cb86-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-508"><a href="#cb86-508" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_1_loc)[<span class="fu">which</span>(<span class="fu">names</span>(results_1_disp) <span class="sc">==</span> <span class="st">"X2.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_low"</span></span>
<span id="cb86-509"><a href="#cb86-509" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_1_loc)[<span class="fu">which</span>(<span class="fu">names</span>(results_1_disp) <span class="sc">==</span> <span class="st">"X97.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_high"</span></span>
<span id="cb86-510"><a href="#cb86-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-511"><a href="#cb86-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-512"><a href="#cb86-512" aria-hidden="true" tabindex="-1"></a><span class="co"># display results ----</span></span>
<span id="cb86-513"><a href="#cb86-513" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(results_1_loc) <span class="sc">%&gt;%</span></span>
<span id="cb86-514"><a href="#cb86-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Location-scale model (location part)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-515"><a href="#cb86-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">everything</span>(), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-516"><a href="#cb86-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb86-517"><a href="#cb86-517" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> <span class="st">"Term"</span>,</span>
<span id="cb86-518"><a href="#cb86-518" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb86-519"><a href="#cb86-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">StdError =</span> <span class="st">"Std. Error"</span>,</span>
<span id="cb86-520"><a href="#cb86-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_low =</span> <span class="st">"95% CI (low)"</span>,</span>
<span id="cb86-521"><a href="#cb86-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_high =</span> <span class="st">"95% CI (high)"</span></span>
<span id="cb86-522"><a href="#cb86-522" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-523"><a href="#cb86-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>())</span>
<span id="cb86-524"><a href="#cb86-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-525"><a href="#cb86-525" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(results_1_disp) <span class="sc">%&gt;%</span></span>
<span id="cb86-526"><a href="#cb86-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Location-scale model (dispersion part)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-527"><a href="#cb86-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">everything</span>(), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-528"><a href="#cb86-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb86-529"><a href="#cb86-529" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> <span class="st">"Term"</span>,</span>
<span id="cb86-530"><a href="#cb86-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb86-531"><a href="#cb86-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">StdError =</span> <span class="st">"Std. Error"</span>,</span>
<span id="cb86-532"><a href="#cb86-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_low =</span> <span class="st">"95% CI (low)"</span>,</span>
<span id="cb86-533"><a href="#cb86-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_high =</span> <span class="st">"95% CI (high)"</span></span>
<span id="cb86-534"><a href="#cb86-534" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-535"><a href="#cb86-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>())</span>
<span id="cb86-536"><a href="#cb86-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-537"><a href="#cb86-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-538"><a href="#cb86-538" aria-hidden="true" tabindex="-1"></a><span class="fu">## bonus - `brms`</span></span>
<span id="cb86-539"><a href="#cb86-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-540"><a href="#cb86-540" aria-hidden="true" tabindex="-1"></a>Of course, we can also fit the location–scale model using the <span class="in">`brms`</span>! Here we show how to fit the same model as above using <span class="in">`brms`</span>. The results should be similar to those obtained with <span class="in">`glmmTMB`</span>.</span>
<span id="cb86-541"><a href="#cb86-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-544"><a href="#cb86-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-545"><a href="#cb86-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting3 - brms model1</span></span>
<span id="cb86-546"><a href="#cb86-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-547"><a href="#cb86-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-548"><a href="#cb86-548" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model using bf()</span></span>
<span id="cb86-549"><a href="#cb86-549" aria-hidden="true" tabindex="-1"></a>formula1 <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb86-550"><a href="#cb86-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(AdTarsus) <span class="sc">~</span>  <span class="dv">1</span> <span class="sc">+</span> Sex <span class="sc">+</span> Treatment <span class="sc">+</span> Sex<span class="sc">:</span>Treatment, </span>
<span id="cb86-551"><a href="#cb86-551" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Sex <span class="sc">+</span> Treatment <span class="sc">+</span> Sex<span class="sc">:</span>Treatment</span>
<span id="cb86-552"><a href="#cb86-552" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-553"><a href="#cb86-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-554"><a href="#cb86-554" aria-hidden="true" tabindex="-1"></a><span class="co"># generate default priors based on the formula and data</span></span>
<span id="cb86-555"><a href="#cb86-555" aria-hidden="true" tabindex="-1"></a>default_priors <span class="ot">&lt;-</span> <span class="fu">default_prior</span>(</span>
<span id="cb86-556"><a href="#cb86-556" aria-hidden="true" tabindex="-1"></a>                        formula1,</span>
<span id="cb86-557"><a href="#cb86-557" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> dat_tarsus,                             </span>
<span id="cb86-558"><a href="#cb86-558" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">gaussian</span>() <span class="co"># default link function for gaussian family                                 </span></span>
<span id="cb86-559"><a href="#cb86-559" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb86-560"><a href="#cb86-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-561"><a href="#cb86-561" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model - you can change N of iter, warmup, thin, and also chains.</span></span>
<span id="cb86-562"><a href="#cb86-562" aria-hidden="true" tabindex="-1"></a><span class="co"># adapt_delta = 0.95 helps to reduce divergent transitions</span></span>
<span id="cb86-563"><a href="#cb86-563" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb86-564"><a href="#cb86-564" aria-hidden="true" tabindex="-1"></a>  brms_g1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(formula1,</span>
<span id="cb86-565"><a href="#cb86-565" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dat_tarsus,           </span>
<span id="cb86-566"><a href="#cb86-566" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">gaussian</span>(),                   </span>
<span id="cb86-567"><a href="#cb86-567" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prior =</span> default_priors,                </span>
<span id="cb86-568"><a href="#cb86-568" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iter =</span> <span class="dv">2000</span>,                          </span>
<span id="cb86-569"><a href="#cb86-569" aria-hidden="true" tabindex="-1"></a>                  <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb86-570"><a href="#cb86-570" aria-hidden="true" tabindex="-1"></a>                  <span class="at">thin =</span> <span class="dv">1</span>,                              </span>
<span id="cb86-571"><a href="#cb86-571" aria-hidden="true" tabindex="-1"></a>                  <span class="at">chains =</span> <span class="dv">2</span>,                            </span>
<span id="cb86-572"><a href="#cb86-572" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>) </span>
<span id="cb86-573"><a href="#cb86-573" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb86-574"><a href="#cb86-574" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-575"><a href="#cb86-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-576"><a href="#cb86-576" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(brms_g1)</span>
<span id="cb86-577"><a href="#cb86-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-578"><a href="#cb86-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-579"><a href="#cb86-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-582"><a href="#cb86-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-583"><a href="#cb86-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_result - brms model1 (SN)</span></span>
<span id="cb86-584"><a href="#cb86-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-585"><a href="#cb86-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-586"><a href="#cb86-586" aria-hidden="true" tabindex="-1"></a>brms_g1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"brms_SN1.rds"</span>))</span>
<span id="cb86-587"><a href="#cb86-587" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(brms_g1)</span>
<span id="cb86-588"><a href="#cb86-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-589"><a href="#cb86-589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-590"><a href="#cb86-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-591"><a href="#cb86-591" aria-hidden="true" tabindex="-1"></a>First, you need to check the effective sample size (<span class="in">`\*\*\_ESS`</span>) and <span class="in">`Rhat`</span> values. ESS should be greater than **400** ([Vehtari et al. 2021](https://doi.org/10.1214/20-BA1221)), and R-hat should be close to **1.0** (ideally <span class="sc">\&lt;</span> 1.01). If these conditions are not met, you may need to increase the number of iterations or adjust the model specification.</span>
<span id="cb86-592"><a href="#cb86-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-593"><a href="#cb86-593" aria-hidden="true" tabindex="-1"></a>Then, we can check the output - it is divided into two parts: **Location (mean) part** (how the average changes) and **Scale (dispersion) part** (how the variability changes - in Gaussian data, the scale part is $\sigma$)</span>
<span id="cb86-594"><a href="#cb86-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-595"><a href="#cb86-595" aria-hidden="true" tabindex="-1"></a>Here is the explanation of the output table:</span>
<span id="cb86-596"><a href="#cb86-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-597"><a href="#cb86-597" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb86-598"><a href="#cb86-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-599"><a href="#cb86-599" aria-hidden="true" tabindex="-1"></a><span class="in">`Estimate`</span>: posterior mean</span>
<span id="cb86-600"><a href="#cb86-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-601"><a href="#cb86-601" aria-hidden="true" tabindex="-1"></a><span class="in">`Est.Err`</span>: standard error of posterior mean</span>
<span id="cb86-602"><a href="#cb86-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-603"><a href="#cb86-603" aria-hidden="true" tabindex="-1"></a><span class="in">`l-95% CI`</span> and <span class="in">`u-95% CI`</span>: Lower and upper bounds of the 95% **credible interval** (range where the true value lies with 95% probability, given the model and data)</span>
<span id="cb86-604"><a href="#cb86-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-605"><a href="#cb86-605" aria-hidden="true" tabindex="-1"></a><span class="in">`Rhat`</span>: Convergence diagnostic. Should be close to 1.00. If <span class="sc">\&gt;</span>1.01, convergence may be poor.</span>
<span id="cb86-606"><a href="#cb86-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-607"><a href="#cb86-607" aria-hidden="true" tabindex="-1"></a><span class="in">`Bulk_ESS`</span> and <span class="in">`Tail_ESS`</span>: Effective sample sizes for bulk and tail distributions. Should be <span class="sc">\&gt;</span>400 for reliable estimates (larger is better).</span>
<span id="cb86-608"><a href="#cb86-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-609"><a href="#cb86-609" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb86-610"><a href="#cb86-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-611"><a href="#cb86-611" aria-hidden="true" tabindex="-1"></a>Now, you can find the results from <span class="in">`glmmTMB`</span> and <span class="in">`brms`</span> are very close to each other, but there are some differences in the estimates and standard errors. This came from the different estimation methods used by the two packages. <span class="in">`glmmTMB`</span> uses maximum likelihood estimation, while <span class="in">`brms`</span> uses Bayesian estimation with Markov Chain Monte Carlo (MCMC) sampling...</span>
<span id="cb86-612"><a href="#cb86-612" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-613"><a href="#cb86-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-614"><a href="#cb86-614" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison of location-only model and location-scale model</span></span>
<span id="cb86-615"><a href="#cb86-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-616"><a href="#cb86-616" aria-hidden="true" tabindex="-1"></a>There was no significant difference in the fit of the two models. location-scale model (model 1) had a lower AICc (-221.0) than location-only model (model 0: -220.0), with an AIC weight of 0.662 vs. 0.338 (see <span class="in">`Model comparison`</span> tab).　</span>
<span id="cb86-617"><a href="#cb86-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-618"><a href="#cb86-618" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple" icon="false"}</span>
<span id="cb86-619"><a href="#cb86-619" aria-hidden="true" tabindex="-1"></a><span class="fu">## Note on `AIC` vs `AICc`:</span></span>
<span id="cb86-620"><a href="#cb86-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-621"><a href="#cb86-621" aria-hidden="true" tabindex="-1"></a>While both <span class="in">`AIC`</span> (Akaike Information Criterion) and <span class="in">`AICc`</span> (AIC with correction) assess model fit by balancing goodness of fit and model complexity, AICc includes an additional correction for small sample sizes. When the sample size is limited relative to the number of estimated parameters, AICc is generally preferred because it reduces the risk of overfitting. As a result, AIC and AICc values may differ slightly, and model rankings based on them may also vary.</span>
<span id="cb86-622"><a href="#cb86-622" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-623"><a href="#cb86-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-624"><a href="#cb86-624" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation of location-scale model :</span></span>
<span id="cb86-625"><a href="#cb86-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-626"><a href="#cb86-626" aria-hidden="true" tabindex="-1"></a>**Location (mean) part:**</span>
<span id="cb86-627"><a href="#cb86-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-628"><a href="#cb86-628" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There was no significant effect of treatment, sex, or their interaction on the mean of <span class="in">`log(AdTarsus)`</span> (all 95% CIs include 0).</span>
<span id="cb86-629"><a href="#cb86-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-630"><a href="#cb86-630" aria-hidden="true" tabindex="-1"></a>**Scale (dispersion) part:**</span>
<span id="cb86-631"><a href="#cb86-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-632"><a href="#cb86-632" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There are a significant negative interaction between sex and treatment (<span class="in">`SexMale:TreatmentFed`</span>; $\beta_{<span class="co">[</span><span class="ot">\text{interaction}</span><span class="co">]</span>}^{(s)}$ = -0.95, 95% CI = <span class="sc">\[</span>-1.66, -0.24<span class="sc">\]</span>). The estimate -0.95 in the dispersion model indicates that the residual variance in <span class="in">`log(AdTarsus)`</span> is significantly lower in Fed males than in Control males.</span>
<span id="cb86-633"><a href="#cb86-633" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This indicates that variance in adult tarsus length was significantly reduced among males that received food supplementation as chicks.</span>
<span id="cb86-634"><a href="#cb86-634" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Neither treatment nor sex alone had a significant effect on variance (i.e., the reduction was specific to supplemented males).</span>
<span id="cb86-635"><a href="#cb86-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-636"><a href="#cb86-636" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb86-637"><a href="#cb86-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-638"><a href="#cb86-638" aria-hidden="true" tabindex="-1"></a>**Q1. Does early-life food supplementation increase adult size? Specifically, does it increase the average tarsus length in adulthood?**</span>
<span id="cb86-639"><a href="#cb86-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-640"><a href="#cb86-640" aria-hidden="true" tabindex="-1"></a>Answer: No clear evidence. In both the location-only and location-scale models, the effect of feeding (treatment) on the mean adult tarsus length was small and not statistically significant. This suggests that food supplementation did not lead to a measurable increase in average tarsus length.</span>
<span id="cb86-641"><a href="#cb86-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-642"><a href="#cb86-642" aria-hidden="true" tabindex="-1"></a>**Q2. Does early-life food supplementation lead to lower variation in adult tarsus length??**</span>
<span id="cb86-643"><a href="#cb86-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-644"><a href="#cb86-644" aria-hidden="true" tabindex="-1"></a>Answer: Partically yes - especially in males. The location-scale model revealed a significant reduction in variance in the male treatment group (Fed) compared to the male control group. This was supported by a significant negative interaction between sex and treatment in the dispersion model. In contrast, females showed no significant difference in variance between treatment groups. This indicates that early-life food supplementation reduced size variation only in males, not across all individuals.</span>
<span id="cb86-645"><a href="#cb86-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-646"><a href="#cb86-646" aria-hidden="true" tabindex="-1"></a>**Q3. Are there sex-specific effects of food supplementation? Do the effects on mean or variance differ between males and females?**</span>
<span id="cb86-647"><a href="#cb86-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-648"><a href="#cb86-648" aria-hidden="true" tabindex="-1"></a>Answer: Yes. The male treatment group (<span class="in">`Fed`</span>) showed significantly reduced variance in adult tarsus length compared to the control group <span class="in">`(Control)`</span>, while females did not show a significant difference in variance between treatment groups. There were no significant differences in mean tarsus length between sexes or treatments. This pattern suggests that early-life food supplementation may canalise trait development in males, leading to more uniform adult morphology under favourable nutritional conditions.</span>
<span id="cb86-649"><a href="#cb86-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-650"><a href="#cb86-650" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb86-651"><a href="#cb86-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-652"><a href="#cb86-652" aria-hidden="true" tabindex="-1"></a>Although the model comparison did not show a strong difference in overall fit between the location-only and location-scale models ($\Delta AICc = 1.3$), the location-scale model revealed an important and previously overlooked pattern:</span>
<span id="cb86-653"><a href="#cb86-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-654"><a href="#cb86-654" aria-hidden="true" tabindex="-1"></a>*Early-life food supplementation significantly reduced trait variance in males, but not in females.*</span>
<span id="cb86-655"><a href="#cb86-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-656"><a href="#cb86-656" aria-hidden="true" tabindex="-1"></a>This result would have been missed in a traditional location-only analysis that focuses solely on mean differences. By modeling both the mean and the dispersion, we were able to detect a sex-specific canalisation effect, highlighting the value of using location-scale models when investigating trait variability and developmental plasticity.</span>
<span id="cb86-657"><a href="#cb86-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-658"><a href="#cb86-658" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- need to fix the Santi's sections - add glmmTMB?? --&gt;</span></span>
<span id="cb86-659"><a href="#cb86-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-660"><a href="#cb86-660" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- for now, I downloaded all RDS files in my computer --&gt;</span></span>
<span id="cb86-661"><a href="#cb86-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-662"><a href="#cb86-662" aria-hidden="true" tabindex="-1"></a><span class="fu"># Adding random effects in the location part only (model 2)</span></span>
<span id="cb86-663"><a href="#cb86-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-664"><a href="#cb86-664" aria-hidden="true" tabindex="-1"></a>Model 2 is a location-scale model with random effects in the location part only. This allows us to account for individual-level variation in the mean response while still modeling the dispersion separately.</span>
<span id="cb86-665"><a href="#cb86-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-666"><a href="#cb86-666" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dataset overview</span></span>
<span id="cb86-667"><a href="#cb86-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-668"><a href="#cb86-668" aria-hidden="true" tabindex="-1"></a>This dataset comes from <span class="co">[</span><span class="ot">Drummond et al (2025)</span><span class="co">](https://doi.org/10.1093/beheco/araf050)</span>, which examined the benefits of brood reduction in the blue-footed booby (*Sula nebouxii*).Focusing on two-chick broods, the research explored whether the death of one chick (brood reduction) primarily benefits the surviving sibling (via increased resource acquisition) or the parents (by lessening parental investment). In this species, older chicks establish a strong dominance hierarchy over their younger siblings. Under stressful environmental conditions, this often results in the death of the second-hatched chick, with parental intervention being extremely rare.</span>
<span id="cb86-669"><a href="#cb86-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-670"><a href="#cb86-670" aria-hidden="true" tabindex="-1"></a>For this tutorial, we will specifically examine data from two-chick broods where both chicks survived to fledging. Our analysis will focus on how hatching order influences the body condition of chicks at fledging.</span>
<span id="cb86-671"><a href="#cb86-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-672"><a href="#cb86-672" aria-hidden="true" tabindex="-1"></a><span class="fu">### Questions</span></span>
<span id="cb86-673"><a href="#cb86-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-674"><a href="#cb86-674" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Do first hatched chicks have a higher body mass than second-hatched chicks?**</span>
<span id="cb86-675"><a href="#cb86-675" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Does the variability in body mass differ between first and second-hatched chicks?**</span>
<span id="cb86-676"><a href="#cb86-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-677"><a href="#cb86-677" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variables included</span></span>
<span id="cb86-678"><a href="#cb86-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-679"><a href="#cb86-679" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple" icon="false"}</span>
<span id="cb86-680"><a href="#cb86-680" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`SMI`</span>: Scaled Mass Index, a measure that accounts for body mass relative to size</span>
<span id="cb86-681"><a href="#cb86-681" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`RANK`</span>: The order in which chicks hatched (1 for first-hatched, 2 for second-hatched)</span>
<span id="cb86-682"><a href="#cb86-682" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`NEST_ID`</span>: Identifier for the nest where the chicks were raised</span>
<span id="cb86-683"><a href="#cb86-683" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`YEAR`</span>: The year in which the chicks were born</span>
<span id="cb86-684"><a href="#cb86-684" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-685"><a href="#cb86-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-686"><a href="#cb86-686" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualise the dataset</span></span>
<span id="cb86-687"><a href="#cb86-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-688"><a href="#cb86-688" aria-hidden="true" tabindex="-1"></a>The plot displays the distribution of body condition, measured as Scaled Mass Index (SMI), for blue-footed booby chicks based on their <span class="in">`hatching order`</span>. Violin plots illustrate the overall density distribution of SMI for both "First-Hatched" and "Second-Hatched" chicks. Each individual empty circle represents the SMI of a single chick. The plot visually highlights individual variability and allows for the comparison of both central tendency (black solid line) and spread of body condition between the two hatching orders.</span>
<span id="cb86-689"><a href="#cb86-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-692"><a href="#cb86-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-693"><a href="#cb86-693" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show_data - model2</span></span>
<span id="cb86-694"><a href="#cb86-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb86-695"><a href="#cb86-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-696"><a href="#cb86-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-697"><a href="#cb86-697" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"SMI_Drummond_et_al_2025.csv"</span>)) <span class="sc">%&gt;%</span><span class="fu">subset</span>(REDUCTION <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb86-698"><a href="#cb86-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-699"><a href="#cb86-699" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">&lt;-</span> dat<span class="sc">%&gt;%</span></span>
<span id="cb86-700"><a href="#cb86-700" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>TIME, <span class="sc">-</span>ST_DATE, <span class="sc">-</span>HATCHING_DATE,<span class="sc">-</span>REDUCTION,<span class="sc">-</span>RING) <span class="sc">%&gt;%</span></span>
<span id="cb86-701"><a href="#cb86-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SMI =</span> <span class="fu">as.numeric</span>(SMI), <span class="co"># Scaled mass index</span></span>
<span id="cb86-702"><a href="#cb86-702" aria-hidden="true" tabindex="-1"></a>         <span class="at">NEST =</span> <span class="fu">as.factor</span>(NEST), </span>
<span id="cb86-703"><a href="#cb86-703" aria-hidden="true" tabindex="-1"></a>         <span class="at">WORKYEAR =</span> <span class="fu">as.factor</span>(WORKYEAR),</span>
<span id="cb86-704"><a href="#cb86-704" aria-hidden="true" tabindex="-1"></a>         <span class="at">RANK =</span> <span class="fu">factor</span>(RANK, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>)))</span>
<span id="cb86-705"><a href="#cb86-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-706"><a href="#cb86-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-707"><a href="#cb86-707" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> RANK, <span class="at">y =</span> SMI, <span class="at">fill =</span> RANK, <span class="at">color =</span> RANK)) <span class="sc">+</span></span>
<span id="cb86-708"><a href="#cb86-708" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> RANK),</span>
<span id="cb86-709"><a href="#cb86-709" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#8B8B83"</span>,</span>
<span id="cb86-710"><a href="#cb86-710" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.8</span>, </span>
<span id="cb86-711"><a href="#cb86-711" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb86-712"><a href="#cb86-712" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb86-713"><a href="#cb86-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color =</span> RANK),</span>
<span id="cb86-714"><a href="#cb86-714" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb86-715"><a href="#cb86-715" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb86-716"><a href="#cb86-716" aria-hidden="true" tabindex="-1"></a>              <span class="at">shape =</span> <span class="dv">1</span>,</span>
<span id="cb86-717"><a href="#cb86-717" aria-hidden="true" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">dodge.width =</span> <span class="fl">0.5</span>, <span class="at">jitter.width =</span> <span class="fl">0.15</span>)) <span class="sc">+</span> </span>
<span id="cb86-718"><a href="#cb86-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,              </span>
<span id="cb86-719"><a href="#cb86-719" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"crossbar"</span>,       </span>
<span id="cb86-720"><a href="#cb86-720" aria-hidden="true" tabindex="-1"></a>               <span class="at">width =</span> <span class="fl">0.1</span>,             </span>
<span id="cb86-721"><a href="#cb86-721" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>,         </span>
<span id="cb86-722"><a href="#cb86-722" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.5</span>,         </span>
<span id="cb86-723"><a href="#cb86-723" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>))<span class="sc">+</span></span>
<span id="cb86-724"><a href="#cb86-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-725"><a href="#cb86-725" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Body Condition (SMI) by Hatching Order"</span>,</span>
<span id="cb86-726"><a href="#cb86-726" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hatching Order"</span>,</span>
<span id="cb86-727"><a href="#cb86-727" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Scaled Mass Index (g)"</span></span>
<span id="cb86-728"><a href="#cb86-728" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-729"><a href="#cb86-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb86-730"><a href="#cb86-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#1F78B4"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#E31A1C"</span>) <span class="co"># </span></span>
<span id="cb86-731"><a href="#cb86-731" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-732"><a href="#cb86-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb86-733"><a href="#cb86-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#1F78B4"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#E31A1C"</span>) <span class="co"># </span></span>
<span id="cb86-734"><a href="#cb86-734" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-735"><a href="#cb86-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb86-736"><a href="#cb86-736" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"First-Hatched"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Second-Hatched"</span>),</span>
<span id="cb86-737"><a href="#cb86-737" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fl">0.5</span>)</span>
<span id="cb86-738"><a href="#cb86-738" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-739"><a href="#cb86-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb86-740"><a href="#cb86-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb86-741"><a href="#cb86-741" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb86-742"><a href="#cb86-742" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb86-743"><a href="#cb86-743" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb86-744"><a href="#cb86-744" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb86-745"><a href="#cb86-745" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-746"><a href="#cb86-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-747"><a href="#cb86-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-748"><a href="#cb86-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-749"><a href="#cb86-749" aria-hidden="true" tabindex="-1"></a><span class="fu">## Run models and interpret results</span></span>
<span id="cb86-750"><a href="#cb86-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-751"><a href="#cb86-751" aria-hidden="true" tabindex="-1"></a>We will fit three progressively complex Bayesian models to the data using the <span class="in">`brms`</span> package. All models incorporate <span class="in">`NEST_ID`</span> and <span class="in">`YEAR`</span> random effects to account for non-independence of chicks within the same nest and observations within the same year.</span>
<span id="cb86-752"><a href="#cb86-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-753"><a href="#cb86-753" aria-hidden="true" tabindex="-1"></a>The models are as follows:</span>
<span id="cb86-754"><a href="#cb86-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-755"><a href="#cb86-755" aria-hidden="true" tabindex="-1"></a>a.  Location-only model: Estimates the average difference in Scaled Mass Index (SMI) between the two hatching orders.</span>
<span id="cb86-756"><a href="#cb86-756" aria-hidden="true" tabindex="-1"></a>b.  Location-scale model: Estimates both the average difference (location) and differences in the variability (scale) of SMI between hatching orders.</span>
<span id="cb86-757"><a href="#cb86-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-758"><a href="#cb86-758" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb86-759"><a href="#cb86-759" aria-hidden="true" tabindex="-1"></a><span class="fu">## Location model</span></span>
<span id="cb86-760"><a href="#cb86-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-761"><a href="#cb86-761" aria-hidden="true" tabindex="-1"></a>Following the previous section, we first fit a location-only model as our baseline and applied a log-transformation to <span class="in">`SMI`</span>.</span>
<span id="cb86-762"><a href="#cb86-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-765"><a href="#cb86-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-766"><a href="#cb86-766" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting2-model1</span></span>
<span id="cb86-767"><a href="#cb86-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-768"><a href="#cb86-768" aria-hidden="true" tabindex="-1"></a>model2_1<span class="ot">&lt;-</span><span class="fu">glmmTMB</span>(<span class="fu">log</span>(SMI) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> RANK <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>NEST)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>WORKYEAR),</span>
<span id="cb86-769"><a href="#cb86-769" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">gaussian</span>(),<span class="at">data=</span>dat)</span>
<span id="cb86-770"><a href="#cb86-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-771"><a href="#cb86-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-772"><a href="#cb86-772" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_1)</span>
<span id="cb86-773"><a href="#cb86-773" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model2_1)</span>
<span id="cb86-774"><a href="#cb86-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-775"><a href="#cb86-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-776"><a href="#cb86-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-777"><a href="#cb86-777" aria-hidden="true" tabindex="-1"></a>Then we use the 'DHARMa' package to simulate residuals and plot them automatically. This step is crucial for checking the model's assumptions, such as normality and homoscedasticity of residuals.</span>
<span id="cb86-778"><a href="#cb86-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-781"><a href="#cb86-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-782"><a href="#cb86-782" aria-hidden="true" tabindex="-1"></a><span class="co"># | label: model_diagnostics - model0</span></span>
<span id="cb86-783"><a href="#cb86-783" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> model2_1, <span class="at">plot =</span> F)</span>
<span id="cb86-784"><a href="#cb86-784" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simulationOutput)</span>
<span id="cb86-785"><a href="#cb86-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-786"><a href="#cb86-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-787"><a href="#cb86-787" aria-hidden="true" tabindex="-1"></a>The QQ plot and Kolmogorov-Smirnov (KS) test reveal that the model's residuals aren't uniformly distributed, hinting at potential issues with the chosen distribution or the model's underlying structure. While tests for overdispersion and outliers showed no significant concerns, the boxplots and Levene test highlight a lack of uniformity within residual groups and non-homogeneous variances. This suggests the model doesn't fully capture the data's complexity and might benefit from adjustments, perhaps by incorporating a location-scale model to better handle varying dispersion.</span>
<span id="cb86-788"><a href="#cb86-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-789"><a href="#cb86-789" aria-hidden="true" tabindex="-1"></a><span class="fu">## Location-scale model</span></span>
<span id="cb86-790"><a href="#cb86-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-793"><a href="#cb86-793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-794"><a href="#cb86-794" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting2 - model2 - glmmtmb</span></span>
<span id="cb86-795"><a href="#cb86-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-796"><a href="#cb86-796" aria-hidden="true" tabindex="-1"></a><span class="co"># location-scale model ---- </span></span>
<span id="cb86-797"><a href="#cb86-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-798"><a href="#cb86-798" aria-hidden="true" tabindex="-1"></a>model2_2 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb86-799"><a href="#cb86-799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(SMI) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> RANK <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>NEST)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">|</span>WORKYEAR),</span>
<span id="cb86-800"><a href="#cb86-800" aria-hidden="true" tabindex="-1"></a>    <span class="at">dispformula =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> RANK,     </span>
<span id="cb86-801"><a href="#cb86-801" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dat, </span>
<span id="cb86-802"><a href="#cb86-802" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> gaussian</span>
<span id="cb86-803"><a href="#cb86-803" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-804"><a href="#cb86-804" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_2)</span>
<span id="cb86-805"><a href="#cb86-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-806"><a href="#cb86-806" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model2_2)</span>
<span id="cb86-807"><a href="#cb86-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-808"><a href="#cb86-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-809"><a href="#cb86-809" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model comparison</span></span>
<span id="cb86-810"><a href="#cb86-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-811"><a href="#cb86-811" aria-hidden="true" tabindex="-1"></a>Finally, we compare the location-scale model with the location-only model based on AICc values (<span class="in">`model.sel()`</span> from the <span class="in">`MuMIn`</span> package).</span>
<span id="cb86-812"><a href="#cb86-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-815"><a href="#cb86-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-816"><a href="#cb86-816" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_comparison - model2 - glmmtmb</span></span>
<span id="cb86-817"><a href="#cb86-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-818"><a href="#cb86-818" aria-hidden="true" tabindex="-1"></a><span class="fu">model.sel</span>(model2_1, model2_2)</span>
<span id="cb86-819"><a href="#cb86-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-820"><a href="#cb86-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-821"><a href="#cb86-821" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of model results</span></span>
<span id="cb86-822"><a href="#cb86-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-823"><a href="#cb86-823" aria-hidden="true" tabindex="-1"></a>The results of the location-only model (Model 0) and the location-scale model (Model 1) are summarized below.</span>
<span id="cb86-824"><a href="#cb86-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-827"><a href="#cb86-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-828"><a href="#cb86-828" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-829"><a href="#cb86-829" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model2_1_results - glmmtmb</span></span>
<span id="cb86-830"><a href="#cb86-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-831"><a href="#cb86-831" aria-hidden="true" tabindex="-1"></a><span class="do">## Ask Erick for a simpler way of making tables</span></span>
<span id="cb86-832"><a href="#cb86-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-833"><a href="#cb86-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-836"><a href="#cb86-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-837"><a href="#cb86-837" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-838"><a href="#cb86-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model2_2_results - glmmtmb</span></span>
<span id="cb86-839"><a href="#cb86-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-840"><a href="#cb86-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-841"><a href="#cb86-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-842"><a href="#cb86-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-843"><a href="#cb86-843" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bonus</span></span>
<span id="cb86-844"><a href="#cb86-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-845"><a href="#cb86-845" aria-hidden="true" tabindex="-1"></a>Here is how to fit the same location-scale model using the <span class="in">`brms`</span> package for comparison.</span>
<span id="cb86-846"><a href="#cb86-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-847"><a href="#cb86-847" aria-hidden="true" tabindex="-1"></a><span class="fu">### Location-only model</span></span>
<span id="cb86-848"><a href="#cb86-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-849"><a href="#cb86-849" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- I will remove the commentout results. --&gt;</span></span>
<span id="cb86-850"><a href="#cb86-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-853"><a href="#cb86-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-854"><a href="#cb86-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting1 - model2 - brms</span></span>
<span id="cb86-855"><a href="#cb86-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-856"><a href="#cb86-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-857"><a href="#cb86-857" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">bf</span>(<span class="fu">log</span>(SMI) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> RANK <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>NEST) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>WORKYEAR))</span>
<span id="cb86-858"><a href="#cb86-858" aria-hidden="true" tabindex="-1"></a>prior1<span class="ot">&lt;-</span><span class="fu">default_prior</span>(m1, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb86-859"><a href="#cb86-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-860"><a href="#cb86-860" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb86-861"><a href="#cb86-861" aria-hidden="true" tabindex="-1"></a>  m1,</span>
<span id="cb86-862"><a href="#cb86-862" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> prior1,</span>
<span id="cb86-863"><a href="#cb86-863" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb86-864"><a href="#cb86-864" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb86-865"><a href="#cb86-865" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">6000</span>,     </span>
<span id="cb86-866"><a href="#cb86-866" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,   </span>
<span id="cb86-867"><a href="#cb86-867" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,  <span class="at">cores=</span><span class="dv">4</span>,</span>
<span id="cb86-868"><a href="#cb86-868" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb86-869"><a href="#cb86-869" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb86-870"><a href="#cb86-870" aria-hidden="true" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,  <span class="co"># Keep high if you have divergent transitions</span></span>
<span id="cb86-871"><a href="#cb86-871" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_treedepth =</span> <span class="dv">15</span>   <span class="co"># Keep high if hitting max_treedepth warnings</span></span>
<span id="cb86-872"><a href="#cb86-872" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-873"><a href="#cb86-873" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,      </span>
<span id="cb86-874"><a href="#cb86-874" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>    <span class="co"># Less frequent progress updates (reduces overhead)</span></span>
<span id="cb86-875"><a href="#cb86-875" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-876"><a href="#cb86-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-877"><a href="#cb86-877" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb86-878"><a href="#cb86-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-879"><a href="#cb86-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-882"><a href="#cb86-882" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-883"><a href="#cb86-883" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model1_result - model2 - brms</span></span>
<span id="cb86-884"><a href="#cb86-884" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-885"><a href="#cb86-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-886"><a href="#cb86-886" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>,<span class="st">"mod1RED.rds"</span>))</span>
<span id="cb86-887"><a href="#cb86-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-888"><a href="#cb86-888" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb86-889"><a href="#cb86-889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-890"><a href="#cb86-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-891"><a href="#cb86-891" aria-hidden="true" tabindex="-1"></a><span class="fu">### Location-scale model</span></span>
<span id="cb86-892"><a href="#cb86-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-895"><a href="#cb86-895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-896"><a href="#cb86-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting2 - model2 - brms</span></span>
<span id="cb86-897"><a href="#cb86-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-898"><a href="#cb86-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-899"><a href="#cb86-899" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">bf</span>(<span class="fu">log</span>(SMI) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> RANK <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>NEST) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>WORKYEAR),</span>
<span id="cb86-900"><a href="#cb86-900" aria-hidden="true" tabindex="-1"></a>         sigma<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> RANK)</span>
<span id="cb86-901"><a href="#cb86-901" aria-hidden="true" tabindex="-1"></a>prior2 <span class="ot">&lt;-</span> <span class="fu">default_prior</span>(m2,<span class="at">data =</span> dat,<span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb86-902"><a href="#cb86-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-903"><a href="#cb86-903" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb86-904"><a href="#cb86-904" aria-hidden="true" tabindex="-1"></a> m2,</span>
<span id="cb86-905"><a href="#cb86-905" aria-hidden="true" tabindex="-1"></a> <span class="at">prior=</span> prior2,</span>
<span id="cb86-906"><a href="#cb86-906" aria-hidden="true" tabindex="-1"></a> <span class="at">data =</span> dat,</span>
<span id="cb86-907"><a href="#cb86-907" aria-hidden="true" tabindex="-1"></a> <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb86-908"><a href="#cb86-908" aria-hidden="true" tabindex="-1"></a> <span class="at">iter =</span> <span class="dv">6000</span>,     </span>
<span id="cb86-909"><a href="#cb86-909" aria-hidden="true" tabindex="-1"></a> <span class="at">warmup =</span> <span class="dv">1000</span>,   </span>
<span id="cb86-910"><a href="#cb86-910" aria-hidden="true" tabindex="-1"></a> <span class="at">chains =</span> <span class="dv">4</span>,  <span class="at">cores=</span><span class="dv">4</span>,</span>
<span id="cb86-911"><a href="#cb86-911" aria-hidden="true" tabindex="-1"></a> <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb86-912"><a href="#cb86-912" aria-hidden="true" tabindex="-1"></a> <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb86-913"><a href="#cb86-913" aria-hidden="true" tabindex="-1"></a>   <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,  <span class="co"># Keep high if you have divergent transitions</span></span>
<span id="cb86-914"><a href="#cb86-914" aria-hidden="true" tabindex="-1"></a>   <span class="at">max_treedepth =</span> <span class="dv">15</span>   <span class="co"># Keep high if hitting max_treedepth warnings</span></span>
<span id="cb86-915"><a href="#cb86-915" aria-hidden="true" tabindex="-1"></a> ),</span>
<span id="cb86-916"><a href="#cb86-916" aria-hidden="true" tabindex="-1"></a> <span class="at">seed =</span> <span class="dv">123</span>,      </span>
<span id="cb86-917"><a href="#cb86-917" aria-hidden="true" tabindex="-1"></a> <span class="at">refresh =</span> <span class="dv">500</span>    <span class="co"># Less frequent progress updates (reduces overhead)</span></span>
<span id="cb86-918"><a href="#cb86-918" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-919"><a href="#cb86-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-920"><a href="#cb86-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-921"><a href="#cb86-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-924"><a href="#cb86-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-925"><a href="#cb86-925" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model2_result - model2 - brms</span></span>
<span id="cb86-926"><a href="#cb86-926" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-927"><a href="#cb86-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-928"><a href="#cb86-928" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>,<span class="st">"mod2RED.rds"</span>))</span>
<span id="cb86-929"><a href="#cb86-929" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span>
<span id="cb86-930"><a href="#cb86-930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-931"><a href="#cb86-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-932"><a href="#cb86-932" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model comparison</span></span>
<span id="cb86-933"><a href="#cb86-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-934"><a href="#cb86-934" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Once I finalised the online tutorial, I will remove the `eval: false` option so that the models will be fitted and the results will be displayed in the online tutorial. For now, I will keep the `eval: false` option to avoid errors. --&gt;</span></span>
<span id="cb86-935"><a href="#cb86-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-938"><a href="#cb86-938" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-939"><a href="#cb86-939" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_comparison - model2 - brms</span></span>
<span id="cb86-940"><a href="#cb86-940" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-941"><a href="#cb86-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-942"><a href="#cb86-942" aria-hidden="true" tabindex="-1"></a>f1loo <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(fit1)</span>
<span id="cb86-943"><a href="#cb86-943" aria-hidden="true" tabindex="-1"></a>f2loo <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(fit2)</span>
<span id="cb86-944"><a href="#cb86-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-945"><a href="#cb86-945" aria-hidden="true" tabindex="-1"></a><span class="co">#Model comparison </span></span>
<span id="cb86-946"><a href="#cb86-946" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo_compare</span>(f1loo, f2loo)</span>
<span id="cb86-947"><a href="#cb86-947" aria-hidden="true" tabindex="-1"></a>fc</span>
<span id="cb86-948"><a href="#cb86-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-949"><a href="#cb86-949" aria-hidden="true" tabindex="-1"></a><span class="co">#     elpd_diff se_diff</span></span>
<span id="cb86-950"><a href="#cb86-950" aria-hidden="true" tabindex="-1"></a><span class="co"># fit2   0.0       0.0  </span></span>
<span id="cb86-951"><a href="#cb86-951" aria-hidden="true" tabindex="-1"></a><span class="co"># fit1 -10.3       7.6  </span></span>
<span id="cb86-952"><a href="#cb86-952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-953"><a href="#cb86-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-954"><a href="#cb86-954" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary of brms model results</span></span>
<span id="cb86-955"><a href="#cb86-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-956"><a href="#cb86-956" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Once I finalised the online tutorial, I will remove the `eval: false` option so that the models will be fitted and the results will be displayed in the online tutorial. For now, I will keep the `eval: false` option to avoid errors. --&gt;</span></span>
<span id="cb86-957"><a href="#cb86-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-960"><a href="#cb86-960" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-961"><a href="#cb86-961" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fit1_results - model2 - brms</span></span>
<span id="cb86-962"><a href="#cb86-962" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-963"><a href="#cb86-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-964"><a href="#cb86-964" aria-hidden="true" tabindex="-1"></a>results_df1 <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit1) <span class="sc">%&gt;%</span></span>
<span id="cb86-965"><a href="#cb86-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb86-966"><a href="#cb86-966" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-967"><a href="#cb86-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^b_|^sd_|^cor_"</span>, term) <span class="sc">|</span> term <span class="sc">==</span> <span class="st">"sigma"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-968"><a href="#cb86-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"b_sigma_Intercept"</span>, <span class="st">"b_sigma_RANK2"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-969"><a href="#cb86-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-970"><a href="#cb86-970" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term_Display =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-971"><a href="#cb86-971" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_Intercept"</span> <span class="sc">~</span> <span class="st">"Intercept"</span>,</span>
<span id="cb86-972"><a href="#cb86-972" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_RANK2"</span> <span class="sc">~</span> <span class="st">"Second hatched chick"</span>,</span>
<span id="cb86-973"><a href="#cb86-973" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__Intercept"</span> <span class="sc">~</span> <span class="st">"Nest ID "</span>, </span>
<span id="cb86-974"><a href="#cb86-974" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__Intercept"</span> <span class="sc">~</span> <span class="st">"Year "</span>,  </span>
<span id="cb86-975"><a href="#cb86-975" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="st">"Sigma"</span>, </span>
<span id="cb86-976"><a href="#cb86-976" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> term </span>
<span id="cb86-977"><a href="#cb86-977" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-978"><a href="#cb86-978" aria-hidden="true" tabindex="-1"></a>    <span class="at">Order_Rank =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-979"><a href="#cb86-979" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_Intercept"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb86-980"><a href="#cb86-980" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_RANK2"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb86-981"><a href="#cb86-981" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__Intercept"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb86-982"><a href="#cb86-982" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__Intercept"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb86-983"><a href="#cb86-983" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb86-984"><a href="#cb86-984" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb86-985"><a href="#cb86-985" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">99</span> </span>
<span id="cb86-986"><a href="#cb86-986" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-987"><a href="#cb86-987" aria-hidden="true" tabindex="-1"></a>    <span class="at">Submodel =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-988"><a href="#cb86-988" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">"Location Model"</span>, </span>
<span id="cb86-989"><a href="#cb86-989" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"Random Effects"</span>,</span>
<span id="cb86-990"><a href="#cb86-990" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Residual Standard Deviation"</span>, </span>
<span id="cb86-991"><a href="#cb86-991" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> </span>
<span id="cb86-992"><a href="#cb86-992" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-993"><a href="#cb86-993" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-994"><a href="#cb86-994" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-995"><a href="#cb86-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Submodel)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-996"><a href="#cb86-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Order_Rank) <span class="sc">%&gt;%</span></span>
<span id="cb86-997"><a href="#cb86-997" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb86-998"><a href="#cb86-998" aria-hidden="true" tabindex="-1"></a>    Submodel, </span>
<span id="cb86-999"><a href="#cb86-999" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> Term_Display,</span>
<span id="cb86-1000"><a href="#cb86-1000" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> Estimate,</span>
<span id="cb86-1001"><a href="#cb86-1001" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Std.error</span><span class="st">`</span> <span class="ot">=</span> Est.Error,</span>
<span id="cb86-1002"><a href="#cb86-1002" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (low)</span><span class="st">`</span> <span class="ot">=</span> Q2<span class="fl">.5</span>,</span>
<span id="cb86-1003"><a href="#cb86-1003" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (high)</span><span class="st">`</span> <span class="ot">=</span> Q97<span class="fl">.5</span></span>
<span id="cb86-1004"><a href="#cb86-1004" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1005"><a href="#cb86-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"Submodel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1006"><a href="#cb86-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb86-1007"><a href="#cb86-1007" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model 1: Posterior Summary"</span></span>
<span id="cb86-1008"><a href="#cb86-1008" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1009"><a href="#cb86-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb86-1010"><a href="#cb86-1010" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Estimate, <span class="st">`</span><span class="at">Std.error</span><span class="st">`</span>, <span class="st">`</span><span class="at">95% CI (low)</span><span class="st">`</span>, <span class="st">`</span><span class="at">95% CI (high)</span><span class="st">`</span>),</span>
<span id="cb86-1011"><a href="#cb86-1011" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb86-1012"><a href="#cb86-1012" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1013"><a href="#cb86-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb86-1014"><a href="#cb86-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb86-1015"><a href="#cb86-1015" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb86-1016"><a href="#cb86-1016" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1017"><a href="#cb86-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1018"><a href="#cb86-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1019"><a href="#cb86-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1022"><a href="#cb86-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1023"><a href="#cb86-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fit2_results - model2 - brms</span></span>
<span id="cb86-1024"><a href="#cb86-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1025"><a href="#cb86-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1026"><a href="#cb86-1026" aria-hidden="true" tabindex="-1"></a>results_df2 <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit2) <span class="sc">%&gt;%</span></span>
<span id="cb86-1027"><a href="#cb86-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb86-1028"><a href="#cb86-1028" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1029"><a href="#cb86-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^b_|^sd_|^cor_"</span>, term)) <span class="sc">%&gt;%</span></span>
<span id="cb86-1030"><a href="#cb86-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-1031"><a href="#cb86-1031" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term_Display =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1032"><a href="#cb86-1032" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_Intercept"</span> <span class="sc">~</span> <span class="st">"Intercept"</span>,</span>
<span id="cb86-1033"><a href="#cb86-1033" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_sigma_Intercept"</span> <span class="sc">~</span> <span class="st">"Intercept (sigma)"</span>,</span>
<span id="cb86-1034"><a href="#cb86-1034" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_RANK2"</span> <span class="sc">~</span> <span class="st">"Second hatched chick"</span>,</span>
<span id="cb86-1035"><a href="#cb86-1035" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_sigma_RANK2"</span> <span class="sc">~</span> <span class="st">"Second hatched chick (sigma)"</span>,</span>
<span id="cb86-1036"><a href="#cb86-1036" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__Intercept"</span> <span class="sc">~</span> <span class="st">"Nest ID"</span>,</span>
<span id="cb86-1037"><a href="#cb86-1037" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__Intercept"</span> <span class="sc">~</span> <span class="st">"Year"</span>,</span>
<span id="cb86-1038"><a href="#cb86-1038" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> term</span>
<span id="cb86-1039"><a href="#cb86-1039" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1040"><a href="#cb86-1040" aria-hidden="true" tabindex="-1"></a>    <span class="at">Order_Rank =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1041"><a href="#cb86-1041" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_Intercept"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb86-1042"><a href="#cb86-1042" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_RANK2"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb86-1043"><a href="#cb86-1043" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb86-1044"><a href="#cb86-1044" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^b_"</span>, term) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"sigma"</span>, term) <span class="sc">~</span> <span class="dv">3</span>, <span class="co"># Other fixed effects (no sigma)</span></span>
<span id="cb86-1045"><a href="#cb86-1045" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_sigma_Intercept"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb86-1046"><a href="#cb86-1046" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_sigma_RANK2"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb86-1047"><a href="#cb86-1047" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__Intercept"</span> <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb86-1048"><a href="#cb86-1048" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__Intercept"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb86-1049"><a href="#cb86-1049" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">99</span></span>
<span id="cb86-1050"><a href="#cb86-1050" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1051"><a href="#cb86-1051" aria-hidden="true" tabindex="-1"></a>    <span class="at">Submodel =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1052"><a href="#cb86-1052" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">"Location Submodel"</span>,</span>
<span id="cb86-1053"><a href="#cb86-1053" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Scale Submodel"</span>,</span>
<span id="cb86-1054"><a href="#cb86-1054" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span> <span class="sc">~</span> <span class="st">"Random effects"</span>,</span>
<span id="cb86-1055"><a href="#cb86-1055" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb86-1056"><a href="#cb86-1056" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> <span class="co"># No subtitle for other terms (SDs), though in this filter they might all fall into a category</span></span>
<span id="cb86-1057"><a href="#cb86-1057" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-1058"><a href="#cb86-1058" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1059"><a href="#cb86-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Order_Rank) <span class="sc">%&gt;%</span></span>
<span id="cb86-1060"><a href="#cb86-1060" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb86-1061"><a href="#cb86-1061" aria-hidden="true" tabindex="-1"></a>    Submodel, <span class="co"># Include Submodel column</span></span>
<span id="cb86-1062"><a href="#cb86-1062" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> Term_Display,</span>
<span id="cb86-1063"><a href="#cb86-1063" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> Estimate,</span>
<span id="cb86-1064"><a href="#cb86-1064" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Std.error</span><span class="st">`</span> <span class="ot">=</span> Est.Error,</span>
<span id="cb86-1065"><a href="#cb86-1065" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (low)</span><span class="st">`</span> <span class="ot">=</span> Q2<span class="fl">.5</span>,</span>
<span id="cb86-1066"><a href="#cb86-1066" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (high)</span><span class="st">`</span> <span class="ot">=</span> Q97<span class="fl">.5</span></span>
<span id="cb86-1067"><a href="#cb86-1067" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1068"><a href="#cb86-1068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"Submodel"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-1069"><a href="#cb86-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb86-1070"><a href="#cb86-1070" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model 2: Posterior Summary"</span></span>
<span id="cb86-1071"><a href="#cb86-1071" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1072"><a href="#cb86-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb86-1073"><a href="#cb86-1073" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Estimate, <span class="st">`</span><span class="at">Std.error</span><span class="st">`</span>, <span class="st">`</span><span class="at">95% CI (low)</span><span class="st">`</span>, <span class="st">`</span><span class="at">95% CI (high)</span><span class="st">`</span>),</span>
<span id="cb86-1074"><a href="#cb86-1074" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb86-1075"><a href="#cb86-1075" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1076"><a href="#cb86-1076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb86-1077"><a href="#cb86-1077" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb86-1078"><a href="#cb86-1078" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb86-1079"><a href="#cb86-1079" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1080"><a href="#cb86-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1081"><a href="#cb86-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1082"><a href="#cb86-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1085"><a href="#cb86-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1086"><a href="#cb86-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: result_summaries - model2 - brms</span></span>
<span id="cb86-1087"><a href="#cb86-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1088"><a href="#cb86-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1089"><a href="#cb86-1089" aria-hidden="true" tabindex="-1"></a>results_df1</span>
<span id="cb86-1090"><a href="#cb86-1090" aria-hidden="true" tabindex="-1"></a>results_df2</span>
<span id="cb86-1091"><a href="#cb86-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1092"><a href="#cb86-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1093"><a href="#cb86-1093" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1094"><a href="#cb86-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1095"><a href="#cb86-1095" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison of location-only model and location-scale model</span></span>
<span id="cb86-1096"><a href="#cb86-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1097"><a href="#cb86-1097" aria-hidden="true" tabindex="-1"></a>The location-scale model (Model 2) was the most-supported model based on AICc values (-8070.8) compared to the location-only model (-8048.8; see <span class="in">`Model comparison`</span> tab for details).</span>
<span id="cb86-1098"><a href="#cb86-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1099"><a href="#cb86-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation of location-scale model :</span></span>
<span id="cb86-1100"><a href="#cb86-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1101"><a href="#cb86-1101" aria-hidden="true" tabindex="-1"></a>**Location (mean) part:**</span>
<span id="cb86-1102"><a href="#cb86-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1103"><a href="#cb86-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There was a conclusive effect of hatching order on the mean of <span class="in">`log(SMI)`</span>, with second-hatched chicks having a lower SMI than first-hatched chicks ($\beta_{<span class="co">[</span><span class="ot">\text{first-second}</span><span class="co">]</span>}^{(l)}$ = -0.018, 95% CI = <span class="sc">\[</span>-0.024, -0.013<span class="sc">\]</span>).</span>
<span id="cb86-1104"><a href="#cb86-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1105"><a href="#cb86-1105" aria-hidden="true" tabindex="-1"></a>**Scale (dispersion) part:**</span>
<span id="cb86-1106"><a href="#cb86-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1107"><a href="#cb86-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The scale component revealed a conclusive difference in the variability of SMI between hatching orders. The second-hatched chicks exhibited greater variability in SMI compared to first-hatched chicks ($\beta_{<span class="co">[</span><span class="ot">\text{first-second}</span><span class="co">]</span>}^{(s)}$ = 0.130, 95% CI = <span class="sc">\[</span>0.077, 0.183<span class="sc">\]</span>).</span>
<span id="cb86-1108"><a href="#cb86-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1109"><a href="#cb86-1109" aria-hidden="true" tabindex="-1"></a>**Location (mean) random effects:**</span>
<span id="cb86-1110"><a href="#cb86-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1111"><a href="#cb86-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There is very little variation in the average body condition across different nests ($\sigma_{<span class="co">[</span><span class="ot">\text{Nest\_ID}</span><span class="co">]</span>}^{(l)}$ = 0.049, 95% CI <span class="sc">\[</span>0.044, 0.054<span class="sc">\]</span>), suggesting that most nests have similar average body conditions for their chicks.</span>
<span id="cb86-1112"><a href="#cb86-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1113"><a href="#cb86-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There is also very little variation in the average body condition across different years ($\sigma_{<span class="co">[</span><span class="ot">\text{Year}</span><span class="co">]</span>}^{(l)}$ = 0.092, 95% CI <span class="sc">\[</span>0.069, 0.124<span class="sc">\]</span>),implying generally consistent average body conditions from year to year.</span>
<span id="cb86-1114"><a href="#cb86-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1115"><a href="#cb86-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb86-1116"><a href="#cb86-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1117"><a href="#cb86-1117" aria-hidden="true" tabindex="-1"></a>**Do first hatched chicks have a higher body mass than second-hatched chicks?**</span>
<span id="cb86-1118"><a href="#cb86-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1119"><a href="#cb86-1119" aria-hidden="true" tabindex="-1"></a>Answer: Answer: Yes, first-hatched chicks have a significantly higher Scaled Mass Index (SMI) than second-hatched chicks at fledging, with a mean difference of approximately 0.018 on the log scale.</span>
<span id="cb86-1120"><a href="#cb86-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1121"><a href="#cb86-1121" aria-hidden="true" tabindex="-1"></a>**Does the variability in body mass differ between first and second-hatched chicks?**</span>
<span id="cb86-1122"><a href="#cb86-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1123"><a href="#cb86-1123" aria-hidden="true" tabindex="-1"></a>Answer: Yes, the variability in body mass (SMI) is significantly greater in second-hatched chicks compared to first-hatched chicks. This indicates that second-hatched chicks show more variation in their body condition at fledging.</span>
<span id="cb86-1124"><a href="#cb86-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1125"><a href="#cb86-1125" aria-hidden="true" tabindex="-1"></a><span class="fu"># Double-hierarchical location-scale model (Model 3)</span></span>
<span id="cb86-1126"><a href="#cb86-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1127"><a href="#cb86-1127" aria-hidden="true" tabindex="-1"></a>Following up on the previous example analyzing the scaled mass index (SMI) at fledging <span class="co">[</span><span class="ot">Drummond et al(2025)</span><span class="co">](https://doi.org/10.1093/beheco/araf050)</span>, we now extend our approach by fitting a double-hierarchical Gaussian location-scale model. This extends Model 2 by introducing nest identity as a correlated random effect in both the location (mean) and scale (variance) components. This extension allows us to examine not only how average <span class="in">`log(SMI)`</span> and its variability differ across nests, but also whether these two forms of nest-level variation are correlated. The main distinction between Model 2 and Model 3 lies in how they handle variation. Model 2 includes random effects only for the mean, assuming constant variance across groups. In contrast, Model 3 accounts for group-level variability by including random effects in both the mean and the variance components. This makes Model 3 particularly useful when:</span>
<span id="cb86-1128"><a href="#cb86-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1129"><a href="#cb86-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Group-level variability (heteroscedasticity) is present</span>
<span id="cb86-1130"><a href="#cb86-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1131"><a href="#cb86-1131" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb86-1132"><a href="#cb86-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1133"><a href="#cb86-1133" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There may be a correlation between group-level means and variances (e.g., nests with higher average SMI also show more variability)</span>
<span id="cb86-1134"><a href="#cb86-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1135"><a href="#cb86-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Both the average and variability are biologically meaningful or expected to vary across groups</span>
<span id="cb86-1136"><a href="#cb86-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1137"><a href="#cb86-1137" aria-hidden="true" tabindex="-1"></a>By modeling variation explicitly, Model 3 can yield better fit and more nuanced inference, especially in ecological or evolutionary contexts where both central tendencies and dispersion carry important signals.</span>
<span id="cb86-1138"><a href="#cb86-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1139"><a href="#cb86-1139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dataset overview</span></span>
<span id="cb86-1140"><a href="#cb86-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1141"><a href="#cb86-1141" aria-hidden="true" tabindex="-1"></a>We use the same dataset as in Model 2, but extend the location-scale framework by moving from Model 2 to Model 3, a double-hierarchical location-scale model. This extension allows us to model group-level variation in both the mean (location) and the variance (scale), as well as their potential correlation.</span>
<span id="cb86-1142"><a href="#cb86-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1143"><a href="#cb86-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">### Question</span></span>
<span id="cb86-1144"><a href="#cb86-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1145"><a href="#cb86-1145" aria-hidden="true" tabindex="-1"></a>**Variation between and within nests** Do nests with generally healthier (heavier) chicks also tend to have chicks that are more similar in their body condition?</span>
<span id="cb86-1146"><a href="#cb86-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1147"><a href="#cb86-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Run models and interpret results</span></span>
<span id="cb86-1148"><a href="#cb86-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1149"><a href="#cb86-1149" aria-hidden="true" tabindex="-1"></a>In this section, we compare Model 1 and Model 3 using the <span class="in">`brms`</span> package, since <span class="in">`glmmTMB`</span> does not support estimating correlations between random effects in the location and scale components. Model 3 - the double-hierarchical location-scale model - extends Model 2 by incorporating random effects for NEST_ID in both the mean and the variability of SMI. Crucially, it also estimates the correlation between these nest-level effects. For instance, a positive correlation would indicate that nests with higher average SMI also exhibit greater variability in SMI.</span>
<span id="cb86-1150"><a href="#cb86-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1151"><a href="#cb86-1151" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb86-1152"><a href="#cb86-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Double-hierarchical Location-scale model</span></span>
<span id="cb86-1153"><a href="#cb86-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1156"><a href="#cb86-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1157"><a href="#cb86-1157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting - model3</span></span>
<span id="cb86-1158"><a href="#cb86-1158" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-1159"><a href="#cb86-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1160"><a href="#cb86-1160" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">bf</span>(<span class="fu">log</span>(SMI) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> RANK<span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q<span class="sc">|</span>NEST) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>WORKYEAR),</span>
<span id="cb86-1161"><a href="#cb86-1161" aria-hidden="true" tabindex="-1"></a>         sigma<span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> RANK <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>q<span class="sc">|</span>NEST) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>WORKYEAR))</span>
<span id="cb86-1162"><a href="#cb86-1162" aria-hidden="true" tabindex="-1"></a>prior3<span class="ot">&lt;-</span><span class="fu">default_prior</span>(m3,<span class="at">data =</span> dat,<span class="at">family =</span> <span class="fu">gaussian</span>())</span>
<span id="cb86-1163"><a href="#cb86-1163" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb86-1164"><a href="#cb86-1164" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb86-1165"><a href="#cb86-1165" aria-hidden="true" tabindex="-1"></a>  m3,</span>
<span id="cb86-1166"><a href="#cb86-1166" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior=</span> prior3,</span>
<span id="cb86-1167"><a href="#cb86-1167" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb86-1168"><a href="#cb86-1168" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb86-1169"><a href="#cb86-1169" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">6000</span>,     </span>
<span id="cb86-1170"><a href="#cb86-1170" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">1000</span>,   </span>
<span id="cb86-1171"><a href="#cb86-1171" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,  </span>
<span id="cb86-1172"><a href="#cb86-1172" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores=</span><span class="dv">4</span>,</span>
<span id="cb86-1173"><a href="#cb86-1173" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb86-1174"><a href="#cb86-1174" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb86-1175"><a href="#cb86-1175" aria-hidden="true" tabindex="-1"></a>    <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,  </span>
<span id="cb86-1176"><a href="#cb86-1176" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_treedepth =</span> <span class="dv">15</span>  </span>
<span id="cb86-1177"><a href="#cb86-1177" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1178"><a href="#cb86-1178" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">123</span>,      </span>
<span id="cb86-1179"><a href="#cb86-1179" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">500</span>)</span>
<span id="cb86-1180"><a href="#cb86-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1181"><a href="#cb86-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1182"><a href="#cb86-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1185"><a href="#cb86-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1186"><a href="#cb86-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_results - model3</span></span>
<span id="cb86-1187"><a href="#cb86-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1188"><a href="#cb86-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1189"><a href="#cb86-1189" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"mod3RED.rds"</span>))</span>
<span id="cb86-1190"><a href="#cb86-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span>
<span id="cb86-1191"><a href="#cb86-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1192"><a href="#cb86-1192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1193"><a href="#cb86-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1194"><a href="#cb86-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model comparison</span></span>
<span id="cb86-1195"><a href="#cb86-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1196"><a href="#cb86-1196" aria-hidden="true" tabindex="-1"></a>We compare the double-hierarchical location-scale model (Model 3) with the previous location-only model (Model 1) to examine whether the added complexity of Model 3 leads to a better fit to the data.</span>
<span id="cb86-1197"><a href="#cb86-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1200"><a href="#cb86-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1201"><a href="#cb86-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_comparison - model3</span></span>
<span id="cb86-1202"><a href="#cb86-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-1203"><a href="#cb86-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1204"><a href="#cb86-1204" aria-hidden="true" tabindex="-1"></a>f1loo <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(fit1)</span>
<span id="cb86-1205"><a href="#cb86-1205" aria-hidden="true" tabindex="-1"></a>f3loo <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(fit3)</span>
<span id="cb86-1206"><a href="#cb86-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1207"><a href="#cb86-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#Model comparison </span></span>
<span id="cb86-1208"><a href="#cb86-1208" aria-hidden="true" tabindex="-1"></a>fc2 <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo_compare</span>(f1loo, f3loo)</span>
<span id="cb86-1209"><a href="#cb86-1209" aria-hidden="true" tabindex="-1"></a>fc2</span>
<span id="cb86-1210"><a href="#cb86-1210" aria-hidden="true" tabindex="-1"></a><span class="co">#  elpd_diff se_diff</span></span>
<span id="cb86-1211"><a href="#cb86-1211" aria-hidden="true" tabindex="-1"></a><span class="co"># fit3    0.0       0.0 </span></span>
<span id="cb86-1212"><a href="#cb86-1212" aria-hidden="true" tabindex="-1"></a><span class="co"># fit1 -357.2      37.4 </span></span>
<span id="cb86-1213"><a href="#cb86-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1214"><a href="#cb86-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1215"><a href="#cb86-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of model results</span></span>
<span id="cb86-1216"><a href="#cb86-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1217"><a href="#cb86-1217" aria-hidden="true" tabindex="-1"></a>The impact of including random effects in the scale component becomes clear when comparing the results of Model 1 with those of the double-hierarchical location-scale model (Model 3).</span>
<span id="cb86-1218"><a href="#cb86-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1221"><a href="#cb86-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1222"><a href="#cb86-1222" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fit1_results - again- model3</span></span>
<span id="cb86-1223"><a href="#cb86-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1224"><a href="#cb86-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1225"><a href="#cb86-1225" aria-hidden="true" tabindex="-1"></a>results_df1 <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit1) <span class="sc">%&gt;%</span></span>
<span id="cb86-1226"><a href="#cb86-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb86-1227"><a href="#cb86-1227" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1228"><a href="#cb86-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^b_|^sd_|^cor_"</span>, term) <span class="sc">|</span> term <span class="sc">==</span> <span class="st">"sigma"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-1229"><a href="#cb86-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>term <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"b_sigma_Intercept"</span>, <span class="st">"b_sigma_RANK2"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-1230"><a href="#cb86-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-1231"><a href="#cb86-1231" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term_Display =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1232"><a href="#cb86-1232" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_Intercept"</span> <span class="sc">~</span> <span class="st">"Intercept"</span>,</span>
<span id="cb86-1233"><a href="#cb86-1233" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_RANK2"</span> <span class="sc">~</span> <span class="st">"Second hatched chick"</span>,</span>
<span id="cb86-1234"><a href="#cb86-1234" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__Intercept"</span> <span class="sc">~</span> <span class="st">"Nest ID "</span>, </span>
<span id="cb86-1235"><a href="#cb86-1235" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__Intercept"</span> <span class="sc">~</span> <span class="st">"Year "</span>,  </span>
<span id="cb86-1236"><a href="#cb86-1236" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="st">"Sigma"</span>, </span>
<span id="cb86-1237"><a href="#cb86-1237" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> term </span>
<span id="cb86-1238"><a href="#cb86-1238" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1239"><a href="#cb86-1239" aria-hidden="true" tabindex="-1"></a>    <span class="at">Order_Rank =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1240"><a href="#cb86-1240" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_Intercept"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb86-1241"><a href="#cb86-1241" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_RANK2"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb86-1242"><a href="#cb86-1242" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__Intercept"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb86-1243"><a href="#cb86-1243" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__Intercept"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb86-1244"><a href="#cb86-1244" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb86-1245"><a href="#cb86-1245" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb86-1246"><a href="#cb86-1246" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">99</span> </span>
<span id="cb86-1247"><a href="#cb86-1247" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1248"><a href="#cb86-1248" aria-hidden="true" tabindex="-1"></a>    <span class="at">Submodel =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1249"><a href="#cb86-1249" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">"Location Model"</span>, </span>
<span id="cb86-1250"><a href="#cb86-1250" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">~</span> <span class="st">"Random Effects"</span>,</span>
<span id="cb86-1251"><a href="#cb86-1251" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"Residual Standard Deviation"</span>, </span>
<span id="cb86-1252"><a href="#cb86-1252" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> </span>
<span id="cb86-1253"><a href="#cb86-1253" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-1254"><a href="#cb86-1254" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1255"><a href="#cb86-1255" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-1256"><a href="#cb86-1256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Submodel)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-1257"><a href="#cb86-1257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Order_Rank) <span class="sc">%&gt;%</span></span>
<span id="cb86-1258"><a href="#cb86-1258" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb86-1259"><a href="#cb86-1259" aria-hidden="true" tabindex="-1"></a>    Submodel, </span>
<span id="cb86-1260"><a href="#cb86-1260" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> Term_Display,</span>
<span id="cb86-1261"><a href="#cb86-1261" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> Estimate,</span>
<span id="cb86-1262"><a href="#cb86-1262" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Std.error</span><span class="st">`</span> <span class="ot">=</span> Est.Error,</span>
<span id="cb86-1263"><a href="#cb86-1263" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (low)</span><span class="st">`</span> <span class="ot">=</span> Q2<span class="fl">.5</span>,</span>
<span id="cb86-1264"><a href="#cb86-1264" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (high)</span><span class="st">`</span> <span class="ot">=</span> Q97<span class="fl">.5</span></span>
<span id="cb86-1265"><a href="#cb86-1265" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1266"><a href="#cb86-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"Submodel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1267"><a href="#cb86-1267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb86-1268"><a href="#cb86-1268" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model 1: Posterior Summary"</span></span>
<span id="cb86-1269"><a href="#cb86-1269" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1270"><a href="#cb86-1270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb86-1271"><a href="#cb86-1271" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Estimate, <span class="st">`</span><span class="at">Std.error</span><span class="st">`</span>, <span class="st">`</span><span class="at">95% CI (low)</span><span class="st">`</span>, <span class="st">`</span><span class="at">95% CI (high)</span><span class="st">`</span>),</span>
<span id="cb86-1272"><a href="#cb86-1272" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb86-1273"><a href="#cb86-1273" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1274"><a href="#cb86-1274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb86-1275"><a href="#cb86-1275" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb86-1276"><a href="#cb86-1276" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb86-1277"><a href="#cb86-1277" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1278"><a href="#cb86-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1279"><a href="#cb86-1279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1280"><a href="#cb86-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1283"><a href="#cb86-1283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1284"><a href="#cb86-1284" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fit3_results - model3</span></span>
<span id="cb86-1285"><a href="#cb86-1285" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1286"><a href="#cb86-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1287"><a href="#cb86-1287" aria-hidden="true" tabindex="-1"></a>results_df3 <span class="ot">&lt;-</span> <span class="fu">posterior_summary</span>(fit3) <span class="sc">%&gt;%</span></span>
<span id="cb86-1288"><a href="#cb86-1288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb86-1289"><a href="#cb86-1289" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"term"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1290"><a href="#cb86-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^b_|^sd_|^cor_"</span>, term)) <span class="sc">%&gt;%</span></span>
<span id="cb86-1291"><a href="#cb86-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-1292"><a href="#cb86-1292" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term_Display =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1293"><a href="#cb86-1293" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_Intercept"</span> <span class="sc">~</span> <span class="st">"Intercept"</span>,</span>
<span id="cb86-1294"><a href="#cb86-1294" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_sigma_Intercept"</span> <span class="sc">~</span> <span class="st">"Intercept "</span>,</span>
<span id="cb86-1295"><a href="#cb86-1295" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_RANK2"</span> <span class="sc">~</span> <span class="st">"Second hatched chick"</span>,</span>
<span id="cb86-1296"><a href="#cb86-1296" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_sigma_RANK2"</span> <span class="sc">~</span> <span class="st">"Second hatched chick "</span>,</span>
<span id="cb86-1297"><a href="#cb86-1297" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__Intercept"</span> <span class="sc">~</span> <span class="st">"Nest ID"</span>,</span>
<span id="cb86-1298"><a href="#cb86-1298" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__sigma_Intercept"</span> <span class="sc">~</span> <span class="st">"Nest ID (sigma)"</span>,</span>
<span id="cb86-1299"><a href="#cb86-1299" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__Intercept"</span> <span class="sc">~</span> <span class="st">"Year"</span>,</span>
<span id="cb86-1300"><a href="#cb86-1300" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__sigma_Intercept"</span> <span class="sc">~</span> <span class="st">"Year (sigma)"</span>,</span>
<span id="cb86-1301"><a href="#cb86-1301" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"cor_NEST__Intercept__sigma_Intercept"</span> <span class="sc">~</span> <span class="st">"Nest ID with NEST ID (sigma)"</span>,</span>
<span id="cb86-1302"><a href="#cb86-1302" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> term</span>
<span id="cb86-1303"><a href="#cb86-1303" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1304"><a href="#cb86-1304" aria-hidden="true" tabindex="-1"></a>    <span class="at">Order_Rank =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1305"><a href="#cb86-1305" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_Intercept"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb86-1306"><a href="#cb86-1306" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_RANK2"</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb86-1307"><a href="#cb86-1307" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^b_"</span>, term) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"sigma"</span>, term) <span class="sc">~</span> <span class="dv">3</span>, <span class="co"># Other fixed effects (no sigma)</span></span>
<span id="cb86-1308"><a href="#cb86-1308" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_sigma_Intercept"</span> <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb86-1309"><a href="#cb86-1309" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"b_sigma_RANK2"</span> <span class="sc">~</span> <span class="dv">5</span>,</span>
<span id="cb86-1310"><a href="#cb86-1310" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__Intercept"</span> <span class="sc">~</span> <span class="dv">6</span>, <span class="co"># &lt;-- Added comma here</span></span>
<span id="cb86-1311"><a href="#cb86-1311" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__Intercept"</span> <span class="sc">~</span> <span class="dv">7</span>,</span>
<span id="cb86-1312"><a href="#cb86-1312" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_NEST__sigma_Intercept"</span> <span class="sc">~</span> <span class="dv">8</span>,</span>
<span id="cb86-1313"><a href="#cb86-1313" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"sd_WORKYEAR__sigma_Intercept"</span> <span class="sc">~</span> <span class="dv">9</span>,</span>
<span id="cb86-1314"><a href="#cb86-1314" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^b_"</span>, term) <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">"sigma"</span>, term) <span class="sc">~</span> <span class="dv">10</span>,  <span class="co"># Other fixed effects (sigma)</span></span>
<span id="cb86-1315"><a href="#cb86-1315" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^sd_"</span>, term) <span class="sc">~</span> <span class="dv">11</span>, <span class="co"># Other SD terms</span></span>
<span id="cb86-1316"><a href="#cb86-1316" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"^cor_"</span>, term) <span class="sc">~</span> <span class="dv">12</span>, <span class="co"># Correlation</span></span>
<span id="cb86-1317"><a href="#cb86-1317" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">99</span></span>
<span id="cb86-1318"><a href="#cb86-1318" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-1319"><a href="#cb86-1319" aria-hidden="true" tabindex="-1"></a>    <span class="at">Submodel =</span> <span class="fu">case_when</span>(</span>
<span id="cb86-1320"><a href="#cb86-1320" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">"Location Submodel"</span>,</span>
<span id="cb86-1321"><a href="#cb86-1321" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"Scale Submodel"</span>,</span>
<span id="cb86-1322"><a href="#cb86-1322" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">%in%</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">~</span> <span class="st">"Random effects"</span>,</span>
<span id="cb86-1323"><a href="#cb86-1323" aria-hidden="true" tabindex="-1"></a>      Order_Rank <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"Correlation"</span>,</span>
<span id="cb86-1324"><a href="#cb86-1324" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb86-1325"><a href="#cb86-1325" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-1326"><a href="#cb86-1326" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1327"><a href="#cb86-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Order_Rank) <span class="sc">%&gt;%</span></span>
<span id="cb86-1328"><a href="#cb86-1328" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb86-1329"><a href="#cb86-1329" aria-hidden="true" tabindex="-1"></a>    Submodel,</span>
<span id="cb86-1330"><a href="#cb86-1330" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> Term_Display,</span>
<span id="cb86-1331"><a href="#cb86-1331" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> Estimate,</span>
<span id="cb86-1332"><a href="#cb86-1332" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Std.error</span><span class="st">`</span> <span class="ot">=</span> Est.Error,</span>
<span id="cb86-1333"><a href="#cb86-1333" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (low)</span><span class="st">`</span> <span class="ot">=</span> Q2<span class="fl">.5</span>,</span>
<span id="cb86-1334"><a href="#cb86-1334" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (high)</span><span class="st">`</span> <span class="ot">=</span> Q97<span class="fl">.5</span></span>
<span id="cb86-1335"><a href="#cb86-1335" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1336"><a href="#cb86-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">groupname_col =</span> <span class="st">"Submodel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1337"><a href="#cb86-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb86-1338"><a href="#cb86-1338" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model 3: Posterior Summary"</span></span>
<span id="cb86-1339"><a href="#cb86-1339" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1340"><a href="#cb86-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb86-1341"><a href="#cb86-1341" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Estimate, <span class="st">`</span><span class="at">Std.error</span><span class="st">`</span>, <span class="st">`</span><span class="at">95% CI (low)</span><span class="st">`</span>, <span class="st">`</span><span class="at">95% CI (high)</span><span class="st">`</span>),</span>
<span id="cb86-1342"><a href="#cb86-1342" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb86-1343"><a href="#cb86-1343" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1344"><a href="#cb86-1344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb86-1345"><a href="#cb86-1345" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb86-1346"><a href="#cb86-1346" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">everything</span>()</span>
<span id="cb86-1347"><a href="#cb86-1347" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1348"><a href="#cb86-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1349"><a href="#cb86-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1350"><a href="#cb86-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1351"><a href="#cb86-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1354"><a href="#cb86-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1355"><a href="#cb86-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: result_summaries - model3</span></span>
<span id="cb86-1356"><a href="#cb86-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1357"><a href="#cb86-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-1358"><a href="#cb86-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1359"><a href="#cb86-1359" aria-hidden="true" tabindex="-1"></a>results_df1</span>
<span id="cb86-1360"><a href="#cb86-1360" aria-hidden="true" tabindex="-1"></a>results_df3</span>
<span id="cb86-1361"><a href="#cb86-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1362"><a href="#cb86-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1363"><a href="#cb86-1363" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1364"><a href="#cb86-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1365"><a href="#cb86-1365" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison of location-only model and location-scale model</span></span>
<span id="cb86-1366"><a href="#cb86-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1367"><a href="#cb86-1367" aria-hidden="true" tabindex="-1"></a>The model comparison results indicate that the double-hierarchical location-scale model (Model 3) is the most supported by the data, as it has the lowest LOO (Leave-One-Out Cross-Validation) information criterion value. This suggests that this model provides the best fit to the data while accounting for both the average differences in body condition and the variability in body condition between first and second-hatched chicks.</span>
<span id="cb86-1368"><a href="#cb86-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1369"><a href="#cb86-1369" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation of location-scale model :</span></span>
<span id="cb86-1370"><a href="#cb86-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1371"><a href="#cb86-1371" aria-hidden="true" tabindex="-1"></a>**Scale (dispersion) random effects:**</span>
<span id="cb86-1372"><a href="#cb86-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1373"><a href="#cb86-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There is notable variation in body condition within nests ($\sigma_{<span class="co">[</span><span class="ot">\text{Nest\_ID}</span><span class="co">]</span>}^{(s)}$ = 0.37, 95% CI <span class="sc">\[</span>0.316, 0.399<span class="sc">\]</span>). This indicates that some nests consistently produce chicks with more consistent body conditions than others.</span>
<span id="cb86-1374"><a href="#cb86-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1375"><a href="#cb86-1375" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The consistency of chick body conditions varies notably across work years ($\sigma_{<span class="co">[</span><span class="ot">\text{Year}</span><span class="co">]</span>}^{(s)}$ = 0.277, 95% CI <span class="sc">\[</span>0.183, 0.411<span class="sc">\]</span>), implying some years yield chicks with more consistent body conditions than others.</span>
<span id="cb86-1376"><a href="#cb86-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1377"><a href="#cb86-1377" aria-hidden="true" tabindex="-1"></a>**Correlation between location and scale random effects:**</span>
<span id="cb86-1378"><a href="#cb86-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1379"><a href="#cb86-1379" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The correlation between the nest-specific random effects for the average body condition and the variability in body condition is negative ($\rho_{<span class="co">[</span><span class="ot">\text{Nest\_ID}</span><span class="co">]</span>}$ = -0.457, 95% CI <span class="sc">\[</span>-0.584, -0.326<span class="sc">\]</span>). This suggests that nests with higher average body conditions tend to produce chicks with more consistent body condition values (less dispersion).</span>
<span id="cb86-1380"><a href="#cb86-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1381"><a href="#cb86-1381" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb86-1382"><a href="#cb86-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1383"><a href="#cb86-1383" aria-hidden="true" tabindex="-1"></a>**Do nests with generally healthier (heavier) chicks also tend to have chicks that are more similar in their body condition?**</span>
<span id="cb86-1384"><a href="#cb86-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1385"><a href="#cb86-1385" aria-hidden="true" tabindex="-1"></a>Answer: Yes, there's a tendency for nests with higher average chick body condition to also exhibit greater consistency among their chicks' body conditions. This is supported by a negative correlation between nest-specific average body condition and its variability.</span>
<span id="cb86-1386"><a href="#cb86-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1387"><a href="#cb86-1387" aria-hidden="true" tabindex="-1"></a><span class="fu"># Beyond Gaussian 1</span></span>
<span id="cb86-1388"><a href="#cb86-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1389"><a href="#cb86-1389" aria-hidden="true" tabindex="-1"></a>This dataset comes from <span class="co">[</span><span class="ot">Mizuno and Soma (2023)</span><span class="co">](https://doi.org/10.1098/rsos.231057)</span>, which investigates the visual preferences of estrildid finches. The study measured how often birds gazed at different visual stimuli (white dots vs. white stripes) under two conditions: food-deprived and food-supplied. The research originally tested the sensory bias hypothesis, which suggests that a pre-existing preference for whitish, round objects (like seeds) may have influenced the evolution of plumage patterns.</span>
<span id="cb86-1390"><a href="#cb86-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1391"><a href="#cb86-1391" aria-hidden="true" tabindex="-1"></a>Here, to keep things simple, we use only a subset of the data related to the white dot pattern stimulus. We analyse how gaze frequency toward dot stimuli differs between the two conditions (food-deprived vs. food-supplied), using a location-scale model with a negative binomial distribution.</span>
<span id="cb86-1392"><a href="#cb86-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1393"><a href="#cb86-1393" aria-hidden="true" tabindex="-1"></a>Although this model includes two random effects (individual and species), it follows the same basic structure as Model 2 - the only difference is that we use a non-Gaussian distribution (negative binomial) instead of a Gaussian one.</span>
<span id="cb86-1394"><a href="#cb86-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1395"><a href="#cb86-1395" aria-hidden="true" tabindex="-1"></a><span class="fu">### Questions</span></span>
<span id="cb86-1396"><a href="#cb86-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1397"><a href="#cb86-1397" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Do birds gaze at dot patterns more (or less) when food-deprived compared to food-supplied?**</span>
<span id="cb86-1398"><a href="#cb86-1398" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Does the variability in gaze responses differ between conditions?**</span>
<span id="cb86-1399"><a href="#cb86-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1400"><a href="#cb86-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variables included</span></span>
<span id="cb86-1401"><a href="#cb86-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1402"><a href="#cb86-1402" aria-hidden="true" tabindex="-1"></a>The dataset contains the following variables:</span>
<span id="cb86-1403"><a href="#cb86-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1404"><a href="#cb86-1404" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple" icon="false"}</span>
<span id="cb86-1405"><a href="#cb86-1405" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`species`</span> and <span class="in">`phylo`</span>: The species of the bird (12 species).</span>
<span id="cb86-1406"><a href="#cb86-1406" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`id`</span>: The individual bird's ID.</span>
<span id="cb86-1407"><a href="#cb86-1407" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sex`</span>: Male or female.</span>
<span id="cb86-1408"><a href="#cb86-1408" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`condition`</span>: The condition under which the data was collected (food-deprived or food-supplied).</span>
<span id="cb86-1409"><a href="#cb86-1409" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`frequency`</span>: The total frequency of gazes towards the stimulus over a 1-hour period.</span>
<span id="cb86-1410"><a href="#cb86-1410" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`p_dot`</span>: Having plumage dot patterns or not.</span>
<span id="cb86-1411"><a href="#cb86-1411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`termite`</span>: The presence of termite-eating diet.</span>
<span id="cb86-1412"><a href="#cb86-1412" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1413"><a href="#cb86-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1414"><a href="#cb86-1414" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualise the datasets</span></span>
<span id="cb86-1415"><a href="#cb86-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1416"><a href="#cb86-1416" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb86-1417"><a href="#cb86-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">## Condition</span></span>
<span id="cb86-1418"><a href="#cb86-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1419"><a href="#cb86-1419" aria-hidden="true" tabindex="-1"></a>First, we visualise the data to understand how gaze frequency varies by condition and species.</span>
<span id="cb86-1420"><a href="#cb86-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1423"><a href="#cb86-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1424"><a href="#cb86-1424" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show_data</span></span>
<span id="cb86-1425"><a href="#cb86-1425" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb86-1426"><a href="#cb86-1426" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1427"><a href="#cb86-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1428"><a href="#cb86-1428" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) </span>
<span id="cb86-1429"><a href="#cb86-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1430"><a href="#cb86-1430" aria-hidden="true" tabindex="-1"></a><span class="co"># load the dataset ----</span></span>
<span id="cb86-1431"><a href="#cb86-1431" aria-hidden="true" tabindex="-1"></a>dat_pref <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"AM_preference.csv"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-1432"><a href="#cb86-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1433"><a href="#cb86-1433" aria-hidden="true" tabindex="-1"></a>dat_pref <span class="ot">&lt;-</span> dat_pref <span class="sc">%&gt;%</span></span>
<span id="cb86-1434"><a href="#cb86-1434" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>stripe, <span class="sc">-</span>full, <span class="sc">-</span>subset) <span class="sc">%&gt;%</span></span>
<span id="cb86-1435"><a href="#cb86-1435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">frequency =</span> dot) <span class="sc">%&gt;%</span></span>
<span id="cb86-1436"><a href="#cb86-1436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species =</span> phylo, <span class="fu">across</span>(<span class="fu">c</span>(condition, sex), as.factor))</span>
<span id="cb86-1437"><a href="#cb86-1437" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-1438"><a href="#cb86-1438" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_pref, <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb86-1439"><a href="#cb86-1439" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> frequency)) <span class="sc">+</span></span>
<span id="cb86-1440"><a href="#cb86-1440" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="at">color =</span> <span class="st">"#8B8B83"</span>, <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb86-1441"><a href="#cb86-1441" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb86-1442"><a href="#cb86-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">shape =</span> sex, <span class="at">color =</span> sex),</span>
<span id="cb86-1443"><a href="#cb86-1443" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb86-1444"><a href="#cb86-1444" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb86-1445"><a href="#cb86-1445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-1446"><a href="#cb86-1446" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total frequency of gazes towards dot patterns"</span>,</span>
<span id="cb86-1447"><a href="#cb86-1447" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb86-1448"><a href="#cb86-1448" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total frequency of gazes (1hr)"</span></span>
<span id="cb86-1449"><a href="#cb86-1449" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1450"><a href="#cb86-1450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="dv">17</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="dv">16</span>),</span>
<span id="cb86-1451"><a href="#cb86-1451" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"Male"</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"Female"</span>)) <span class="sc">+</span></span>
<span id="cb86-1452"><a href="#cb86-1452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"#009ACD"</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"#FF4D4D"</span>),</span>
<span id="cb86-1453"><a href="#cb86-1453" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"Male"</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"Female"</span>)) <span class="sc">+</span></span>
<span id="cb86-1454"><a href="#cb86-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb86-1455"><a href="#cb86-1455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb86-1456"><a href="#cb86-1456" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb86-1457"><a href="#cb86-1457" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb86-1458"><a href="#cb86-1458" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>),</span>
<span id="cb86-1459"><a href="#cb86-1459" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>),</span>
<span id="cb86-1460"><a href="#cb86-1460" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb86-1461"><a href="#cb86-1461" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb86-1462"><a href="#cb86-1462" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1463"><a href="#cb86-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1464"><a href="#cb86-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1465"><a href="#cb86-1465" aria-hidden="true" tabindex="-1"></a><span class="fu">## Species</span></span>
<span id="cb86-1466"><a href="#cb86-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1467"><a href="#cb86-1467" aria-hidden="true" tabindex="-1"></a>The plot breaks down the same gaze data by species. Each point is a bird’s gaze frequency under a condition. Colored lines represent species-specific means across conditions, helping to visualise - how different species vary in their average gazing behaviour, whether species respond differently to food deprivation. Faceting by species can help compare species-level patterns.</span>
<span id="cb86-1468"><a href="#cb86-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1471"><a href="#cb86-1471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1472"><a href="#cb86-1472" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show_data2</span></span>
<span id="cb86-1473"><a href="#cb86-1473" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb86-1474"><a href="#cb86-1474" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1475"><a href="#cb86-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1476"><a href="#cb86-1476" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_pref, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> frequency)) <span class="sc">+</span></span>
<span id="cb86-1477"><a href="#cb86-1477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb86-1478"><a href="#cb86-1478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-1479"><a href="#cb86-1479" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total frequency of gazes towards dot patterns by species"</span>,</span>
<span id="cb86-1480"><a href="#cb86-1480" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb86-1481"><a href="#cb86-1481" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total frequency of gazes (1hr)"</span></span>
<span id="cb86-1482"><a href="#cb86-1482" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1483"><a href="#cb86-1483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">group =</span> species, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb86-1484"><a href="#cb86-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb86-1485"><a href="#cb86-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species)</span>
<span id="cb86-1486"><a href="#cb86-1486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1487"><a href="#cb86-1487" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1488"><a href="#cb86-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1489"><a href="#cb86-1489" aria-hidden="true" tabindex="-1"></a><span class="fu">## Run models and interpret results</span></span>
<span id="cb86-1490"><a href="#cb86-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1491"><a href="#cb86-1491" aria-hidden="true" tabindex="-1"></a>We fit and compare two types of models to analyse gaze frequency toward white dot patterns using the <span class="in">`glmmTMB`</span> package:</span>
<span id="cb86-1492"><a href="#cb86-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1493"><a href="#cb86-1493" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Location-only model: Estimates how the mean gaze frequency varies between the two experimental conditions (<span class="in">`food-deprived`</span> vs. <span class="in">`food-supplied`</span>).</span>
<span id="cb86-1494"><a href="#cb86-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1495"><a href="#cb86-1495" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Location-scale model: Estimates how both the mean and the variability (<span class="in">`dispersion`</span>) of gaze frequency vary between conditions.</span>
<span id="cb86-1496"><a href="#cb86-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1497"><a href="#cb86-1497" aria-hidden="true" tabindex="-1"></a>These models help us examine whether internal states such as hunger (represented by food deprivation) influence not only the average number of gazes, but also the species/individual variability in gaze behaviour. Such variability may reflect differences in exploratory tendencies among species/individuals. Please note that in this section, species are not modelled with phylogenetic relatedness. For an example of how to fit a location–scale phylogenetic regression model, see *Section Model selection (example 2)*.</span>
<span id="cb86-1498"><a href="#cb86-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1499"><a href="#cb86-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model fitting</span></span>
<span id="cb86-1500"><a href="#cb86-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1501"><a href="#cb86-1501" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb86-1502"><a href="#cb86-1502" aria-hidden="true" tabindex="-1"></a><span class="fu">## Location model</span></span>
<span id="cb86-1503"><a href="#cb86-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1504"><a href="#cb86-1504" aria-hidden="true" tabindex="-1"></a>We use negative binomial model here, as the response variable <span class="in">`frequency`</span> is a count of gazes and may exhibit overdispersion. In The <span class="in">`glmmTMB`</span> package, we can specify the family as <span class="in">`nbinom2`</span> for negative binomial distribution with a log link function.</span>
<span id="cb86-1505"><a href="#cb86-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1508"><a href="#cb86-1508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1509"><a href="#cb86-1509" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting1 - nb model</span></span>
<span id="cb86-1510"><a href="#cb86-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1511"><a href="#cb86-1511" aria-hidden="true" tabindex="-1"></a><span class="co"># location model ----</span></span>
<span id="cb86-1512"><a href="#cb86-1512" aria-hidden="true" tabindex="-1"></a><span class="do">## the mean (location) of gaze frequency with condition and sex as fixed effects; assumes constant variance.</span></span>
<span id="cb86-1513"><a href="#cb86-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1514"><a href="#cb86-1514" aria-hidden="true" tabindex="-1"></a>model_0 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb86-1515"><a href="#cb86-1515" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span>  condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="co"># location part (mean)</span></span>
<span id="cb86-1516"><a href="#cb86-1516" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref,</span>
<span id="cb86-1517"><a href="#cb86-1517" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb86-1518"><a href="#cb86-1518" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1519"><a href="#cb86-1519" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb86-1520"><a href="#cb86-1520" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_0)</span>
<span id="cb86-1521"><a href="#cb86-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1522"><a href="#cb86-1522" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_0)</span>
<span id="cb86-1523"><a href="#cb86-1523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1524"><a href="#cb86-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1525"><a href="#cb86-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">## Residual diagnostics</span></span>
<span id="cb86-1526"><a href="#cb86-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1527"><a href="#cb86-1527" aria-hidden="true" tabindex="-1"></a>For Gaussian models, we can use the Q-Q plot to show whether the residuals fall along a straight line. However, for non-Gaussian models, we can use the <span class="in">`DHARMa`</span> package to check the residuals. The <span class="in">`DHARMa`</span> package provides a set of diagnostic tools for generalized linear mixed models (GLMMs) and allows us to simulate residuals and check for overdispersion, outliers, and uniformity.</span>
<span id="cb86-1528"><a href="#cb86-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1531"><a href="#cb86-1531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1532"><a href="#cb86-1532" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: residual_diagnostics - nb model</span></span>
<span id="cb86-1533"><a href="#cb86-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1534"><a href="#cb86-1534" aria-hidden="true" tabindex="-1"></a><span class="co"># location-only model (NB) ----</span></span>
<span id="cb86-1535"><a href="#cb86-1535" aria-hidden="true" tabindex="-1"></a><span class="co"># main diagnostic plots</span></span>
<span id="cb86-1536"><a href="#cb86-1536" aria-hidden="true" tabindex="-1"></a>model0_res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(model_0, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb86-1537"><a href="#cb86-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1538"><a href="#cb86-1538" aria-hidden="true" tabindex="-1"></a><span class="co"># formal test for over/underdispersion</span></span>
<span id="cb86-1539"><a href="#cb86-1539" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(model0_res) </span>
<span id="cb86-1540"><a href="#cb86-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1541"><a href="#cb86-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1542"><a href="#cb86-1542" aria-hidden="true" tabindex="-1"></a>The <span class="in">`DHARMa`</span> diagnostics indicate no issues with overdispersion or outliers (Dispersion test: <span class="in">`p = 0.456`</span>; Outlier test: <span class="in">`p = 0.88`</span>). However, the KS test for uniformity is significant (<span class="in">`p = 2e-05`</span>), suggesting deviation from the expected residual distribution. Additionally, residuals show non-uniform patterns across levels of the categorical predictor (catPred), and the Levene’s test indicates heterogeneity of variance among groups. These results suggest that the model may not fully capture the structure associated with the categorical predictor.</span>
<span id="cb86-1543"><a href="#cb86-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1544"><a href="#cb86-1544" aria-hidden="true" tabindex="-1"></a><span class="fu">## Location-scale model</span></span>
<span id="cb86-1545"><a href="#cb86-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1546"><a href="#cb86-1546" aria-hidden="true" tabindex="-1"></a>The result from<span class="in">`DHARMa`</span> diagnostics suggests that the location-only model may not fully capture the structure of the data. Therefore, we can fit a location-scale model to account for both the mean and variance of the response variable.</span>
<span id="cb86-1547"><a href="#cb86-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1550"><a href="#cb86-1550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1551"><a href="#cb86-1551" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting 2 - nb model</span></span>
<span id="cb86-1552"><a href="#cb86-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1553"><a href="#cb86-1553" aria-hidden="true" tabindex="-1"></a><span class="co"># location-scale model ---- </span></span>
<span id="cb86-1554"><a href="#cb86-1554" aria-hidden="true" tabindex="-1"></a><span class="co"># both the mean (location) and the variance (scale) as functions of condition and sex.</span></span>
<span id="cb86-1555"><a href="#cb86-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1556"><a href="#cb86-1556" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb86-1557"><a href="#cb86-1557" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb86-1558"><a href="#cb86-1558" aria-hidden="true" tabindex="-1"></a>   <span class="at">dispformula =</span> <span class="sc">~</span> condition <span class="sc">+</span> sex,     </span>
<span id="cb86-1559"><a href="#cb86-1559" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref,                          </span>
<span id="cb86-1560"><a href="#cb86-1560" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb86-1561"><a href="#cb86-1561" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1562"><a href="#cb86-1562" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_1)</span>
<span id="cb86-1563"><a href="#cb86-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1564"><a href="#cb86-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_1)</span>
<span id="cb86-1565"><a href="#cb86-1565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1566"><a href="#cb86-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1567"><a href="#cb86-1567" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model comparison</span></span>
<span id="cb86-1568"><a href="#cb86-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1569"><a href="#cb86-1569" aria-hidden="true" tabindex="-1"></a>Let's compare the two models to see if the location-scale model provides a better fit to the data than the location-only model.</span>
<span id="cb86-1570"><a href="#cb86-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1573"><a href="#cb86-1573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1574"><a href="#cb86-1574" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_comparison - nb model</span></span>
<span id="cb86-1575"><a href="#cb86-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1576"><a href="#cb86-1576" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models ----</span></span>
<span id="cb86-1577"><a href="#cb86-1577" aria-hidden="true" tabindex="-1"></a><span class="fu">model.sel</span>(model_0, model_1)</span>
<span id="cb86-1578"><a href="#cb86-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1579"><a href="#cb86-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1580"><a href="#cb86-1580" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of model results</span></span>
<span id="cb86-1581"><a href="#cb86-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1582"><a href="#cb86-1582" aria-hidden="true" tabindex="-1"></a>You can quickly check the results of the location-only model (model 0) and the location-scale model (model 1) below.</span>
<span id="cb86-1583"><a href="#cb86-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1586"><a href="#cb86-1586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1587"><a href="#cb86-1587" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1588"><a href="#cb86-1588" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model0_results - nb model</span></span>
<span id="cb86-1589"><a href="#cb86-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1590"><a href="#cb86-1590" aria-hidden="true" tabindex="-1"></a><span class="co"># Location-only model (Model 0) ----</span></span>
<span id="cb86-1591"><a href="#cb86-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1592"><a href="#cb86-1592" aria-hidden="true" tabindex="-1"></a>coefs_0 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_0)<span class="sc">$</span>coefficients<span class="sc">$</span>cond</span>
<span id="cb86-1593"><a href="#cb86-1593" aria-hidden="true" tabindex="-1"></a>conf_0 <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_0)</span>
<span id="cb86-1594"><a href="#cb86-1594" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(conf_0) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"^cond</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, <span class="fu">rownames</span>(conf_0))</span>
<span id="cb86-1595"><a href="#cb86-1595" aria-hidden="true" tabindex="-1"></a>conf_0 <span class="ot">&lt;-</span> conf_0[<span class="fu">rownames</span>(conf_0) <span class="sc">%in%</span> <span class="fu">rownames</span>(coefs_0), ]</span>
<span id="cb86-1596"><a href="#cb86-1596" aria-hidden="true" tabindex="-1"></a>match_0 <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(coefs_0), <span class="fu">rownames</span>(conf_0))</span>
<span id="cb86-1597"><a href="#cb86-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1598"><a href="#cb86-1598" aria-hidden="true" tabindex="-1"></a>results_0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb86-1599"><a href="#cb86-1599" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coefs_0),</span>
<span id="cb86-1600"><a href="#cb86-1600" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coefs_0[, <span class="st">"Estimate"</span>],</span>
<span id="cb86-1601"><a href="#cb86-1601" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdError =</span> coefs_0[, <span class="st">"Std. Error"</span>],</span>
<span id="cb86-1602"><a href="#cb86-1602" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span> <span class="ot">=</span> conf_0[match_0, <span class="st">"2.5 %"</span>],</span>
<span id="cb86-1603"><a href="#cb86-1603" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">97.5%</span><span class="st">`</span> <span class="ot">=</span> conf_0[match_0, <span class="st">"97.5 %"</span>]</span>
<span id="cb86-1604"><a href="#cb86-1604" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1605"><a href="#cb86-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1606"><a href="#cb86-1606" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_0)[<span class="fu">which</span>(<span class="fu">names</span>(results_0) <span class="sc">==</span> <span class="st">"X2.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_low"</span></span>
<span id="cb86-1607"><a href="#cb86-1607" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_0)[<span class="fu">which</span>(<span class="fu">names</span>(results_0) <span class="sc">==</span> <span class="st">"X97.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_high"</span></span>
<span id="cb86-1608"><a href="#cb86-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1609"><a href="#cb86-1609" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(results_0) <span class="sc">%&gt;%</span></span>
<span id="cb86-1610"><a href="#cb86-1610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Location-only model"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1611"><a href="#cb86-1611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">everything</span>(), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1612"><a href="#cb86-1612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb86-1613"><a href="#cb86-1613" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> <span class="st">"Term"</span>,</span>
<span id="cb86-1614"><a href="#cb86-1614" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb86-1615"><a href="#cb86-1615" aria-hidden="true" tabindex="-1"></a>    <span class="at">StdError =</span> <span class="st">"Std. Error"</span>,</span>
<span id="cb86-1616"><a href="#cb86-1616" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_low =</span> <span class="st">"95% CI (low)"</span>,</span>
<span id="cb86-1617"><a href="#cb86-1617" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_high =</span> <span class="st">"95% CI (high)"</span></span>
<span id="cb86-1618"><a href="#cb86-1618" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1619"><a href="#cb86-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>())</span>
<span id="cb86-1620"><a href="#cb86-1620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1621"><a href="#cb86-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1624"><a href="#cb86-1624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1625"><a href="#cb86-1625" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1626"><a href="#cb86-1626" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model1_results - nb model</span></span>
<span id="cb86-1627"><a href="#cb86-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1628"><a href="#cb86-1628" aria-hidden="true" tabindex="-1"></a><span class="co"># Location-scale model (Model 1) ----</span></span>
<span id="cb86-1629"><a href="#cb86-1629" aria-hidden="true" tabindex="-1"></a>summary_1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_1)</span>
<span id="cb86-1630"><a href="#cb86-1630" aria-hidden="true" tabindex="-1"></a>conf_1 <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_1)</span>
<span id="cb86-1631"><a href="#cb86-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1632"><a href="#cb86-1632" aria-hidden="true" tabindex="-1"></a><span class="do">## location part ----</span></span>
<span id="cb86-1633"><a href="#cb86-1633" aria-hidden="true" tabindex="-1"></a>coefs_1_loc <span class="ot">&lt;-</span> summary_1<span class="sc">$</span>coefficients<span class="sc">$</span>cond</span>
<span id="cb86-1634"><a href="#cb86-1634" aria-hidden="true" tabindex="-1"></a>conf_1_loc <span class="ot">&lt;-</span> conf_1[<span class="fu">grep</span>(<span class="st">"^cond"</span>, <span class="fu">rownames</span>(conf_1)), ]</span>
<span id="cb86-1635"><a href="#cb86-1635" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(conf_1_loc) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"^cond</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, <span class="fu">rownames</span>(conf_1_loc))</span>
<span id="cb86-1636"><a href="#cb86-1636" aria-hidden="true" tabindex="-1"></a>conf_1_loc <span class="ot">&lt;-</span> conf_1_loc[<span class="fu">rownames</span>(conf_1_loc) <span class="sc">%in%</span> <span class="fu">rownames</span>(coefs_1_loc), ]</span>
<span id="cb86-1637"><a href="#cb86-1637" aria-hidden="true" tabindex="-1"></a>match_loc <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(coefs_1_loc), <span class="fu">rownames</span>(conf_1_loc))</span>
<span id="cb86-1638"><a href="#cb86-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1639"><a href="#cb86-1639" aria-hidden="true" tabindex="-1"></a>results_1_loc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb86-1640"><a href="#cb86-1640" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coefs_1_loc),</span>
<span id="cb86-1641"><a href="#cb86-1641" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coefs_1_loc[, <span class="st">"Estimate"</span>],</span>
<span id="cb86-1642"><a href="#cb86-1642" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdError =</span> coefs_1_loc[, <span class="st">"Std. Error"</span>],</span>
<span id="cb86-1643"><a href="#cb86-1643" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_low =</span> conf_1_loc[match_loc, <span class="st">"2.5 %"</span>],</span>
<span id="cb86-1644"><a href="#cb86-1644" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_high =</span> conf_1_loc[match_loc, <span class="st">"97.5 %"</span>]</span>
<span id="cb86-1645"><a href="#cb86-1645" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1646"><a href="#cb86-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1647"><a href="#cb86-1647" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_1_loc)[<span class="fu">which</span>(<span class="fu">names</span>(results_1_loc) <span class="sc">==</span> <span class="st">"X2.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_low"</span></span>
<span id="cb86-1648"><a href="#cb86-1648" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_1_loc)[<span class="fu">which</span>(<span class="fu">names</span>(results_1_loc) <span class="sc">==</span> <span class="st">"X97.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_high"</span></span>
<span id="cb86-1649"><a href="#cb86-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1650"><a href="#cb86-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1651"><a href="#cb86-1651" aria-hidden="true" tabindex="-1"></a><span class="do">## dispersion part ----</span></span>
<span id="cb86-1652"><a href="#cb86-1652" aria-hidden="true" tabindex="-1"></a>coefs_1_disp <span class="ot">&lt;-</span> summary_1<span class="sc">$</span>coefficients<span class="sc">$</span>disp</span>
<span id="cb86-1653"><a href="#cb86-1653" aria-hidden="true" tabindex="-1"></a>conf_1_disp <span class="ot">&lt;-</span> conf_1[<span class="fu">grep</span>(<span class="st">"^disp"</span>, <span class="fu">rownames</span>(conf_1)), ]</span>
<span id="cb86-1654"><a href="#cb86-1654" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(conf_1_disp) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"^disp</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, <span class="fu">rownames</span>(conf_1_disp))</span>
<span id="cb86-1655"><a href="#cb86-1655" aria-hidden="true" tabindex="-1"></a>conf_1_disp <span class="ot">&lt;-</span> conf_1_disp[<span class="fu">rownames</span>(conf_1_disp) <span class="sc">%in%</span> <span class="fu">rownames</span>(coefs_1_disp), ]</span>
<span id="cb86-1656"><a href="#cb86-1656" aria-hidden="true" tabindex="-1"></a>match_disp <span class="ot">&lt;-</span> <span class="fu">match</span>(<span class="fu">rownames</span>(coefs_1_disp), <span class="fu">rownames</span>(conf_1_disp))</span>
<span id="cb86-1657"><a href="#cb86-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1658"><a href="#cb86-1658" aria-hidden="true" tabindex="-1"></a>results_1_disp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb86-1659"><a href="#cb86-1659" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coefs_1_disp),</span>
<span id="cb86-1660"><a href="#cb86-1660" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coefs_1_disp[, <span class="st">"Estimate"</span>],</span>
<span id="cb86-1661"><a href="#cb86-1661" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdError =</span> coefs_1_disp[, <span class="st">"Std. Error"</span>],</span>
<span id="cb86-1662"><a href="#cb86-1662" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_low =</span> conf_1_disp[match_disp, <span class="st">"2.5 %"</span>],</span>
<span id="cb86-1663"><a href="#cb86-1663" aria-hidden="true" tabindex="-1"></a>  <span class="at">CI_high =</span> conf_1_disp[match_disp, <span class="st">"97.5 %"</span>]</span>
<span id="cb86-1664"><a href="#cb86-1664" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1665"><a href="#cb86-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1666"><a href="#cb86-1666" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_1_loc)[<span class="fu">which</span>(<span class="fu">names</span>(results_1_disp) <span class="sc">==</span> <span class="st">"X2.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_low"</span></span>
<span id="cb86-1667"><a href="#cb86-1667" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results_1_loc)[<span class="fu">which</span>(<span class="fu">names</span>(results_1_disp) <span class="sc">==</span> <span class="st">"X97.5."</span>)] <span class="ot">&lt;-</span> <span class="st">"CI_high"</span></span>
<span id="cb86-1668"><a href="#cb86-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1669"><a href="#cb86-1669" aria-hidden="true" tabindex="-1"></a><span class="co"># display results ----</span></span>
<span id="cb86-1670"><a href="#cb86-1670" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(results_1_loc) <span class="sc">%&gt;%</span></span>
<span id="cb86-1671"><a href="#cb86-1671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Location-scale model (location part)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1672"><a href="#cb86-1672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">everything</span>(), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1673"><a href="#cb86-1673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb86-1674"><a href="#cb86-1674" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> <span class="st">"Term"</span>,</span>
<span id="cb86-1675"><a href="#cb86-1675" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb86-1676"><a href="#cb86-1676" aria-hidden="true" tabindex="-1"></a>    <span class="at">StdError =</span> <span class="st">"Std. Error"</span>,</span>
<span id="cb86-1677"><a href="#cb86-1677" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_low =</span> <span class="st">"95% CI (low)"</span>,</span>
<span id="cb86-1678"><a href="#cb86-1678" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_high =</span> <span class="st">"95% CI (high)"</span></span>
<span id="cb86-1679"><a href="#cb86-1679" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1680"><a href="#cb86-1680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>())</span>
<span id="cb86-1681"><a href="#cb86-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1682"><a href="#cb86-1682" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(results_1_disp) <span class="sc">%&gt;%</span></span>
<span id="cb86-1683"><a href="#cb86-1683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Location-scale model (dispersion part)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1684"><a href="#cb86-1684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">everything</span>(), <span class="at">decimals =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-1685"><a href="#cb86-1685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb86-1686"><a href="#cb86-1686" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> <span class="st">"Term"</span>,</span>
<span id="cb86-1687"><a href="#cb86-1687" aria-hidden="true" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb86-1688"><a href="#cb86-1688" aria-hidden="true" tabindex="-1"></a>    <span class="at">StdError =</span> <span class="st">"Std. Error"</span>,</span>
<span id="cb86-1689"><a href="#cb86-1689" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_low =</span> <span class="st">"95% CI (low)"</span>,</span>
<span id="cb86-1690"><a href="#cb86-1690" aria-hidden="true" tabindex="-1"></a>    <span class="at">CI_high =</span> <span class="st">"95% CI (high)"</span></span>
<span id="cb86-1691"><a href="#cb86-1691" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-1692"><a href="#cb86-1692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">columns =</span> <span class="fu">everything</span>())</span>
<span id="cb86-1693"><a href="#cb86-1693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1694"><a href="#cb86-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1695"><a href="#cb86-1695" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bonus 1 - Conway-Maxwell-Poisson (CMP) model</span></span>
<span id="cb86-1696"><a href="#cb86-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1697"><a href="#cb86-1697" aria-hidden="true" tabindex="-1"></a>The <span class="in">`Conway-Maxwell-Poisson (CMP)`</span> model is a flexible count data model that can handle overdispersion **and** underdispersion.</span>
<span id="cb86-1698"><a href="#cb86-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1701"><a href="#cb86-1701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1702"><a href="#cb86-1702" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model fitting 3 - cmp_model</span></span>
<span id="cb86-1703"><a href="#cb86-1703" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-1704"><a href="#cb86-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1705"><a href="#cb86-1705" aria-hidden="true" tabindex="-1"></a><span class="co"># CMP model ----</span></span>
<span id="cb86-1706"><a href="#cb86-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1707"><a href="#cb86-1707" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span>  <span class="fu">glmmTMB</span>(</span>
<span id="cb86-1708"><a href="#cb86-1708" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb86-1709"><a href="#cb86-1709" aria-hidden="true" tabindex="-1"></a>  <span class="at">dispformula =</span> <span class="sc">~</span> condition <span class="sc">+</span> sex, </span>
<span id="cb86-1710"><a href="#cb86-1710" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref,</span>
<span id="cb86-1711"><a href="#cb86-1711" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">compois</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb86-1712"><a href="#cb86-1712" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1713"><a href="#cb86-1713" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)</span>
<span id="cb86-1714"><a href="#cb86-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1715"><a href="#cb86-1715" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_2)</span>
<span id="cb86-1716"><a href="#cb86-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1717"><a href="#cb86-1717" aria-hidden="true" tabindex="-1"></a><span class="fu">model.sel</span>(model_0, model_1, model_2)</span>
<span id="cb86-1718"><a href="#cb86-1718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1719"><a href="#cb86-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1722"><a href="#cb86-1722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1723"><a href="#cb86-1723" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model result 3 - cmp_model</span></span>
<span id="cb86-1724"><a href="#cb86-1724" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1725"><a href="#cb86-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1726"><a href="#cb86-1726" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"model_CMP_AM.rds"</span>))</span>
<span id="cb86-1727"><a href="#cb86-1727" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_2)</span>
<span id="cb86-1728"><a href="#cb86-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1729"><a href="#cb86-1729" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model_2)</span>
<span id="cb86-1730"><a href="#cb86-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1731"><a href="#cb86-1731" aria-hidden="true" tabindex="-1"></a><span class="fu">model.sel</span>(model_0, model_1, model_2)</span>
<span id="cb86-1732"><a href="#cb86-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1733"><a href="#cb86-1733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1734"><a href="#cb86-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1735"><a href="#cb86-1735" aria-hidden="true" tabindex="-1"></a>Here, we compared three generalised linear mixed models. **model_0** was a `Negative Binomial (NB)` model with a single, overall estimated dispersion parameter (i.e., not modelled as a function of predictors). **model_1** extended this by modelling the `NB` dispersion parameter as a function of condition and sex. **model_2** further used a <span class="in">`Conway-Maxwell-Poisson (CMP)`</span> distribution, which can accommodate both under- and over-dispersion, with its dispersion parameter similarly modelled by condition and sex.</span>
<span id="cb86-1736"><a href="#cb86-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1737"><a href="#cb86-1737" aria-hidden="true" tabindex="-1"></a>Model comparison based on AICc strongly favored the location-scale CMP model (model_2: AICc = 2159.2, model weight = 0.999), with the location-scale NB model (model_1: AICc = 2172.8) and the NB model with a single dispersion parameter (model_0: AICc = 2176.8) performing substantially worse.</span>
<span id="cb86-1738"><a href="#cb86-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1739"><a href="#cb86-1739" aria-hidden="true" tabindex="-1"></a>In all three models, food-supplied birds showed significantly lower gaze frequencies toward dot stimuli. There was no evidence of sex differences in the location part in any model.</span>
<span id="cb86-1740"><a href="#cb86-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1741"><a href="#cb86-1741" aria-hidden="true" tabindex="-1"></a>Regarding the dispersion parameter, in the location-scale <span class="in">`NB`</span> model (model_1), the dispersion part revealed a significant change in residual variance in the food-supplied condition ($\beta_{<span class="co">[</span><span class="ot">\text{conditionSupplied}</span><span class="co">]</span>}^{(l)}$ = –0.662). Given the parameterization of the Negative Binomial distribution (where a smaller dispersion parameter $\theta$ indicates greater overdispersion), this suggests an increase in overdispersion when food was supplied, implying less consistent behavior across individuals. However, this effect was not statistically significant in the location-scale <span class="in">`CMP`</span> model (model_2), where the corresponding estimate was 1.20 (p = 0.12). In the <span class="in">`CMP`</span> model, a positive estimate for the dispersion parameter $\nu$ would imply a decrease in overdispersion (i.e., more consistent behavior) if it were significant.</span>
<span id="cb86-1742"><a href="#cb86-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1743"><a href="#cb86-1743" aria-hidden="true" tabindex="-1"></a>Random effects in all models consistently showed greater variance among species than among id within species. For example, in the location-scale CMP model, species-level variance was 0.246, while individual-level variance was 0.151.</span>
<span id="cb86-1744"><a href="#cb86-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1745"><a href="#cb86-1745" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing Negative Binomial and CMP Models</span></span>
<span id="cb86-1746"><a href="#cb86-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1747"><a href="#cb86-1747" aria-hidden="true" tabindex="-1"></a>Below, we compare the Negative Binomial (NB) and Conway-Maxwell-Poisson (CMP) models to assess which better fits the data. Model selection is based on AICc and residual diagnostics.</span>
<span id="cb86-1748"><a href="#cb86-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1751"><a href="#cb86-1751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1752"><a href="#cb86-1752" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_comparison 2</span></span>
<span id="cb86-1753"><a href="#cb86-1753" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1754"><a href="#cb86-1754" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Model comparison of location-only and location-scale models in negative Binomial (NB) and Conway-Maxwell-Poisson (CMP) distributions."</span></span>
<span id="cb86-1755"><a href="#cb86-1755" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb86-1756"><a href="#cb86-1756" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - location-only model (NB) </span></span>
<span id="cb86-1757"><a href="#cb86-1757" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - location-scale model (NB)</span></span>
<span id="cb86-1758"><a href="#cb86-1758" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - location-scale model (CMP)</span></span>
<span id="cb86-1759"><a href="#cb86-1759" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb86-1760"><a href="#cb86-1760" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb86-1761"><a href="#cb86-1761" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-1762"><a href="#cb86-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1763"><a href="#cb86-1763" aria-hidden="true" tabindex="-1"></a>model0_res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(model_0, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-1764"><a href="#cb86-1764" aria-hidden="true" tabindex="-1"></a>model1_res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(model_1, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-1765"><a href="#cb86-1765" aria-hidden="true" tabindex="-1"></a>model2_res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(model_2, <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-1766"><a href="#cb86-1766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1767"><a href="#cb86-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1768"><a href="#cb86-1768" aria-hidden="true" tabindex="-1"></a>All models passed the <span class="in">`DHARMa`</span> dispersion and outlier tests, indicating appropriate handling of overall variance and absence of extreme observations. However, the Kolmogorov–Smirnov (KS) test consistently revealed significant deviations from the expected uniform distribution of residuals in all three cases, suggesting remaining misfits in distributional shape. The location-scale <span class="in">`CMP`</span> model performed best in terms of within-group residual uniformity, showing no significant deviation in any predictor level. In contrast, both the location-only <span class="in">`NB`</span> model and the location-scale <span class="in">`NB`</span> model exhibited within-group deviations in some categories. These results collectively suggest that while none of the models perfectly capture the residual structure, the location-scale <span class="in">`CMP`</span> model may offer the best overall fit among the candidates for the observed data characteristics.</span>
<span id="cb86-1769"><a href="#cb86-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1770"><a href="#cb86-1770" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bonus 2 - brms</span></span>
<span id="cb86-1771"><a href="#cb86-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1772"><a href="#cb86-1772" aria-hidden="true" tabindex="-1"></a>You can also fit the location-scale model using the <span class="in">`brms`</span> package. The difference is that in <span class="in">`brms`</span>, you can specify scale parts using <span class="in">`shape`</span>. Below, we show how to fit the same location-scale negative binomial model as above using <span class="in">`brms`</span>.</span>
<span id="cb86-1773"><a href="#cb86-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1776"><a href="#cb86-1776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1777"><a href="#cb86-1777" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting3 - brms model1 (nb)</span></span>
<span id="cb86-1778"><a href="#cb86-1778" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-1779"><a href="#cb86-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1780"><a href="#cb86-1780" aria-hidden="true" tabindex="-1"></a>formula1 <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb86-1781"><a href="#cb86-1781" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id),</span>
<span id="cb86-1782"><a href="#cb86-1782" aria-hidden="true" tabindex="-1"></a>  shape <span class="sc">~</span> condition <span class="sc">+</span> sex</span>
<span id="cb86-1783"><a href="#cb86-1783" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1784"><a href="#cb86-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1785"><a href="#cb86-1785" aria-hidden="true" tabindex="-1"></a>prior1 <span class="ot">&lt;-</span> <span class="fu">default_prior</span>(formula1, </span>
<span id="cb86-1786"><a href="#cb86-1786" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> dat_pref, </span>
<span id="cb86-1787"><a href="#cb86-1787" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>, <span class="at">link_shape =</span> <span class="st">"log"</span>)</span>
<span id="cb86-1788"><a href="#cb86-1788" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1789"><a href="#cb86-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1790"><a href="#cb86-1790" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(model_nb_brms <span class="ot">&lt;-</span> <span class="fu">brm</span>(formula1, </span>
<span id="cb86-1791"><a href="#cb86-1791" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dat_pref, </span>
<span id="cb86-1792"><a href="#cb86-1792" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> prior1,</span>
<span id="cb86-1793"><a href="#cb86-1793" aria-hidden="true" tabindex="-1"></a>            <span class="at">chains =</span> <span class="dv">2</span>, </span>
<span id="cb86-1794"><a href="#cb86-1794" aria-hidden="true" tabindex="-1"></a>            <span class="at">iter =</span> <span class="dv">5000</span>, </span>
<span id="cb86-1795"><a href="#cb86-1795" aria-hidden="true" tabindex="-1"></a>            <span class="at">warmup =</span> <span class="dv">3000</span>,</span>
<span id="cb86-1796"><a href="#cb86-1796" aria-hidden="true" tabindex="-1"></a>            <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb86-1797"><a href="#cb86-1797" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>, <span class="at">link_shape =</span> <span class="st">"log"</span>),</span>
<span id="cb86-1798"><a href="#cb86-1798" aria-hidden="true" tabindex="-1"></a>            <span class="co"># control = list(adapt_delta = 0.95)</span></span>
<span id="cb86-1799"><a href="#cb86-1799" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1800"><a href="#cb86-1800" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-1801"><a href="#cb86-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_nb_brms)</span>
<span id="cb86-1802"><a href="#cb86-1802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1803"><a href="#cb86-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1806"><a href="#cb86-1806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1807"><a href="#cb86-1807" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_nb_results</span></span>
<span id="cb86-1808"><a href="#cb86-1808" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-1809"><a href="#cb86-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1810"><a href="#cb86-1810" aria-hidden="true" tabindex="-1"></a>model_nb_brms <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"model_nb_AM.rds"</span>))</span>
<span id="cb86-1811"><a href="#cb86-1811" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_nb_brms)</span>
<span id="cb86-1812"><a href="#cb86-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1813"><a href="#cb86-1813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1814"><a href="#cb86-1814" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1815"><a href="#cb86-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1816"><a href="#cb86-1816" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison of location-only model and location-scale model</span></span>
<span id="cb86-1817"><a href="#cb86-1817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1818"><a href="#cb86-1818" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Modeling dispersion improves model fit and better captures the structure of the data.</span>
<span id="cb86-1819"><a href="#cb86-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1820"><a href="#cb86-1820" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Location-scale model had a lower AICc (2172.8) than location-only model (2176.8), indicating better model fit. It also had a higher model weight (0.877 vs. 0.123), suggesting stronger support for the location-scale model.</span>
<span id="cb86-1821"><a href="#cb86-1821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1822"><a href="#cb86-1822" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation of location-scale model :</span></span>
<span id="cb86-1823"><a href="#cb86-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1824"><a href="#cb86-1824" aria-hidden="true" tabindex="-1"></a>**Location (mean) part:**</span>
<span id="cb86-1825"><a href="#cb86-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1826"><a href="#cb86-1826" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The supplied condition significantly lowers gaze frequency ($\beta_{<span class="co">[</span><span class="ot">\text{conditionSupplied}</span><span class="co">]</span>}^{(l)}$ = -0.845, 95% CI <span class="sc">\[</span>-1.08, -0.61<span class="sc">\]</span>\$).</span>
<span id="cb86-1827"><a href="#cb86-1827" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There is no significant sex difference in mean gaze frequency ($\beta_{<span class="co">[</span><span class="ot">\text{sex-male}</span><span class="co">]</span>}^{(l)}$ = -0.104, 95% CI <span class="sc">\[</span>-0.37, 0.16<span class="sc">\]</span>\$).</span>
<span id="cb86-1828"><a href="#cb86-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1829"><a href="#cb86-1829" aria-hidden="true" tabindex="-1"></a>**Scale (dispersion) part:**</span>
<span id="cb86-1830"><a href="#cb86-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1831"><a href="#cb86-1831" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The supplied condition significantly increases residual variance ($\beta_{<span class="co">[</span><span class="ot">\text{deprived–supplied}</span><span class="co">]</span>}^{(s)}$ = -0.662, 95% CI <span class="sc">\[</span>1.15, -0.18<span class="sc">\]</span>\$). This suggests more varied gaze behaviour across individuals under the supplied condition.</span>
<span id="cb86-1832"><a href="#cb86-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1833"><a href="#cb86-1833" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There is no significant sex difference in the variability of gaze frequency ($\beta_{<span class="co">[</span><span class="ot">\text{sex-male}</span><span class="co">]</span>}^{(s)}$ = 0.132, 95% CI <span class="sc">\[</span>-0.36, 0.62<span class="sc">\]</span>\$).</span>
<span id="cb86-1834"><a href="#cb86-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1835"><a href="#cb86-1835" aria-hidden="true" tabindex="-1"></a>**Location (mean) random effects:**</span>
<span id="cb86-1836"><a href="#cb86-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1837"><a href="#cb86-1837" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Species-level ($sd_{<span class="co">[</span><span class="ot">\text{species}</span><span class="co">]</span>}$ = 0.55, 95% CI <span class="sc">\[</span>0.31, 0.99<span class="sc">\]</span>\$): Indicates some variation in mean gaze frequency among species.</span>
<span id="cb86-1838"><a href="#cb86-1838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1839"><a href="#cb86-1839" aria-hidden="true" tabindex="-1"></a>**Location (dispersion) random effects:** - Individual-level ($sd_{<span class="co">[</span><span class="ot">\text{species}</span><span class="co">]</span>}$ = 0.34, 95% CI <span class="sc">\[</span>0.17, 0.68<span class="sc">\]</span>): Suggests variation among individuals within species, but this is smaller than the variation across species.</span>
<span id="cb86-1840"><a href="#cb86-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1841"><a href="#cb86-1841" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb86-1842"><a href="#cb86-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1843"><a href="#cb86-1843" aria-hidden="true" tabindex="-1"></a>**Q1: Do birds gaze at dot patterns more (or less) when food-deprived compared to food-supplied?**</span>
<span id="cb86-1844"><a href="#cb86-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1845"><a href="#cb86-1845" aria-hidden="true" tabindex="-1"></a>Answer: Yes. In the location (mean) part of the model, the coefficient for the supplied condition is significantly negative. This indicates that participants made fewer gazes toward dot stimuli in the food-supplied condition compared to the food-deprived condition. So, the average gaze frequency is lower when food is supplied.</span>
<span id="cb86-1846"><a href="#cb86-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1847"><a href="#cb86-1847" aria-hidden="true" tabindex="-1"></a>**Q2: Does the variability in gaze responses differ between conditions?**</span>
<span id="cb86-1848"><a href="#cb86-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1849"><a href="#cb86-1849" aria-hidden="true" tabindex="-1"></a>Answer: Yes. In the scale (dispersion) part of the model, the coefficient for the food-supplied condition is significantly negative. Since lower θ values imply greater dispersion, this result suggests that individual gaze responses were more variable when food was supplied. In other words, birds showed more consistent gaze responses when food was deprived, and more varied responses when food was available.</span>
<span id="cb86-1850"><a href="#cb86-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1851"><a href="#cb86-1851" aria-hidden="true" tabindex="-1"></a><span class="fu"># Beyond Gaussian 2</span></span>
<span id="cb86-1852"><a href="#cb86-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1853"><a href="#cb86-1853" aria-hidden="true" tabindex="-1"></a>This dataset comes from <span class="co">[</span><span class="ot">Lundgren et al. (2022)</span><span class="co">](https://doi.org/10.1111/1365-2656.13766)</span>, which examined the activity and impact of feral dunkeys (*Equus africanus asinus*) between wetlands with and without cougar (*Puma concolor*) predation.</span>
<span id="cb86-1854"><a href="#cb86-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1855"><a href="#cb86-1855" aria-hidden="true" tabindex="-1"></a>For this example, we will focus on the effect of cougar predation on the percentage of ground trampled by feral donkeys.</span>
<span id="cb86-1856"><a href="#cb86-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1857"><a href="#cb86-1857" aria-hidden="true" tabindex="-1"></a><span class="fu">## Questions</span></span>
<span id="cb86-1858"><a href="#cb86-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1859"><a href="#cb86-1859" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Does cougar predation affect the percentage of ground trampled by feral donkeys?**</span>
<span id="cb86-1860"><a href="#cb86-1860" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Does cougar predation affect the variability in the percentage of ground trampled by feral donkeys?**</span>
<span id="cb86-1861"><a href="#cb86-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1862"><a href="#cb86-1862" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variables included</span></span>
<span id="cb86-1863"><a href="#cb86-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1864"><a href="#cb86-1864" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="simple" icon="false"}</span>
<span id="cb86-1865"><a href="#cb86-1865" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`cover`</span>: Percentage of ground trampled by feral donkeys</span>
<span id="cb86-1866"><a href="#cb86-1866" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Site`</span>: Name of the site where the data was collected</span>
<span id="cb86-1867"><a href="#cb86-1867" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`Access_point`</span>: Access point to the sites</span>
<span id="cb86-1868"><a href="#cb86-1868" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`if_kill`</span>: Whether a cougar kill (dead donkey) was found at the site (1 = yes, 0 = no)</span>
<span id="cb86-1869"><a href="#cb86-1869" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1870"><a href="#cb86-1870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1871"><a href="#cb86-1871" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualise the dataset</span></span>
<span id="cb86-1872"><a href="#cb86-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1873"><a href="#cb86-1873" aria-hidden="true" tabindex="-1"></a>iolin plots illustrate the overall density distribution of percentage of trampled Bare Ground for both areas with (Yes) and without (No) donkey kills Each individual empty circle represents the trampled bare ground cover of a single observation. The plot visually highlights individual variability and allows for the comparison of both central tendency (indicated by the black solid line, representing the mean) and spread of trampled bare ground cover between areas where burro kills are absent versus present.</span>
<span id="cb86-1874"><a href="#cb86-1874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1877"><a href="#cb86-1877" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1878"><a href="#cb86-1878" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show_data - beyond_gaussian2</span></span>
<span id="cb86-1879"><a href="#cb86-1879" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb86-1880"><a href="#cb86-1880" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-1881"><a href="#cb86-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1882"><a href="#cb86-1882" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"Lundgren_Cougar_Burro_Trophic_Cascade_Trampled_BareGround.csv"</span>))</span>
<span id="cb86-1883"><a href="#cb86-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1884"><a href="#cb86-1884" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb86-1885"><a href="#cb86-1885" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Site, Pool, if_kill, cover) <span class="sc">%&gt;%</span></span>
<span id="cb86-1886"><a href="#cb86-1886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Site=</span><span class="fu">as.factor</span>(Site),</span>
<span id="cb86-1887"><a href="#cb86-1887" aria-hidden="true" tabindex="-1"></a>         <span class="at">if_kill=</span><span class="fu">as.factor</span>(if_kill),</span>
<span id="cb86-1888"><a href="#cb86-1888" aria-hidden="true" tabindex="-1"></a>         <span class="at">cover=</span><span class="fu">as.numeric</span>(cover)</span>
<span id="cb86-1889"><a href="#cb86-1889" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1890"><a href="#cb86-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1891"><a href="#cb86-1891" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat)</span>
<span id="cb86-1892"><a href="#cb86-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1893"><a href="#cb86-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1894"><a href="#cb86-1894" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> if_kill, <span class="at">y =</span> cover, <span class="at">fill =</span> if_kill)) <span class="sc">+</span></span>
<span id="cb86-1895"><a href="#cb86-1895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(</span>
<span id="cb86-1896"><a href="#cb86-1896" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> if_kill), <span class="co"># Fill violins based on 'if_kill'</span></span>
<span id="cb86-1897"><a href="#cb86-1897" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#8B8B83"</span>, <span class="co"># Outline color for violins</span></span>
<span id="cb86-1898"><a href="#cb86-1898" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.8</span>,</span>
<span id="cb86-1899"><a href="#cb86-1899" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb86-1900"><a href="#cb86-1900" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>)</span>
<span id="cb86-1901"><a href="#cb86-1901" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1902"><a href="#cb86-1902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb86-1903"><a href="#cb86-1903" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> if_kill), <span class="co"># Color jittered points based on 'if_kill'</span></span>
<span id="cb86-1904"><a href="#cb86-1904" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb86-1905"><a href="#cb86-1905" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb86-1906"><a href="#cb86-1906" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">1</span>, <span class="co"># Open circles for jittered points</span></span>
<span id="cb86-1907"><a href="#cb86-1907" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">dodge.width =</span> <span class="fl">0.5</span>, <span class="at">jitter.width =</span> <span class="fl">0.15</span>)</span>
<span id="cb86-1908"><a href="#cb86-1908" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1909"><a href="#cb86-1909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb86-1910"><a href="#cb86-1910" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean,</span>
<span id="cb86-1911"><a href="#cb86-1911" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"crossbar"</span>,</span>
<span id="cb86-1912"><a href="#cb86-1912" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.1</span>,</span>
<span id="cb86-1913"><a href="#cb86-1913" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, <span class="co"># Black crossbar for mean</span></span>
<span id="cb86-1914"><a href="#cb86-1914" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb86-1915"><a href="#cb86-1915" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>)</span>
<span id="cb86-1916"><a href="#cb86-1916" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1917"><a href="#cb86-1917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-1918"><a href="#cb86-1918" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Donkey Trampling by Cougar Kill Presence"</span>,</span>
<span id="cb86-1919"><a href="#cb86-1919" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Cougar Kill Presence"</span>,</span>
<span id="cb86-1920"><a href="#cb86-1920" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Proportion Trampled Bare Ground"</span></span>
<span id="cb86-1921"><a href="#cb86-1921" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1922"><a href="#cb86-1922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb86-1923"><a href="#cb86-1923" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"burro kills absent"</span> <span class="ot">=</span> <span class="st">"cornflowerblue"</span>, <span class="st">"burro kills present"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>)</span>
<span id="cb86-1924"><a href="#cb86-1924" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1925"><a href="#cb86-1925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>( <span class="co"># Add scale_color_manual for jitter points</span></span>
<span id="cb86-1926"><a href="#cb86-1926" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"burro kills absent"</span> <span class="ot">=</span> <span class="st">"cornflowerblue"</span>, <span class="st">"burro kills present"</span> <span class="ot">=</span> <span class="st">"firebrick"</span>)</span>
<span id="cb86-1927"><a href="#cb86-1927" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1928"><a href="#cb86-1928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb86-1929"><a href="#cb86-1929" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"burro kills absent"</span> <span class="ot">=</span> <span class="st">"No"</span>, <span class="st">"burro kills present"</span> <span class="ot">=</span> <span class="st">"Yes"</span>),</span>
<span id="cb86-1930"><a href="#cb86-1930" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fl">0.5</span>)</span>
<span id="cb86-1931"><a href="#cb86-1931" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-1932"><a href="#cb86-1932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb86-1933"><a href="#cb86-1933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb86-1934"><a href="#cb86-1934" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb86-1935"><a href="#cb86-1935" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb86-1936"><a href="#cb86-1936" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb86-1937"><a href="#cb86-1937" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb86-1938"><a href="#cb86-1938" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1939"><a href="#cb86-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1940"><a href="#cb86-1940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-1941"><a href="#cb86-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1942"><a href="#cb86-1942" aria-hidden="true" tabindex="-1"></a><span class="fu">## Run models and interpret results</span></span>
<span id="cb86-1943"><a href="#cb86-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1944"><a href="#cb86-1944" aria-hidden="true" tabindex="-1"></a>We will fit two zero-one inflated beta regression models to the data using the <span class="in">`brms`</span> package. We'll use the <span class="in">`brms`</span> package because the <span class="in">`glmmTMB`</span> (frequentist) approach does not allow for values of '1', while the <span class="in">`brms`</span> package allows us to fit zero-one inflation models to account for these boundary values. All models incorporate <span class="in">`Pool`</span> as a random effect to account for non-independence of observations collected at the same wetland access point</span>
<span id="cb86-1945"><a href="#cb86-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1946"><a href="#cb86-1946" aria-hidden="true" tabindex="-1"></a>The models are as follows:</span>
<span id="cb86-1947"><a href="#cb86-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1948"><a href="#cb86-1948" aria-hidden="true" tabindex="-1"></a>a.  Location-Only Model: This model will estimate the average difference in the percentage of trampled bare ground between areas where "burro kills are absent" and where "burro kills are present."</span>
<span id="cb86-1949"><a href="#cb86-1949" aria-hidden="true" tabindex="-1"></a>b.  Location-Scale Model: This more comprehensive model will estimate both the average difference (location) and any differences in the variability (scale) of the percentage of trampled bare ground between areas with and without burro kills.</span>
<span id="cb86-1950"><a href="#cb86-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1951"><a href="#cb86-1951" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model fitting</span></span>
<span id="cb86-1952"><a href="#cb86-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1953"><a href="#cb86-1953" aria-hidden="true" tabindex="-1"></a>::::: panel-tabset</span>
<span id="cb86-1954"><a href="#cb86-1954" aria-hidden="true" tabindex="-1"></a><span class="fu">## Location-only model</span></span>
<span id="cb86-1955"><a href="#cb86-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1956"><a href="#cb86-1956" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="simple" icon="false"}</span>
<span id="cb86-1957"><a href="#cb86-1957" aria-hidden="true" tabindex="-1"></a><span class="in">`zoi ~ if_kill`</span> (Zero-One Inflation): This part of the model estimates how if_kill (cougar kill presence) influences the probability that an observation is exactly 0% or exactly 100% trampled bare ground. If <span class="in">`if_kill`</span> increases the zoi probability, it means that areas with burro kills are more likely to have either no trampled ground or completely trampled ground, compared to areas without burro kills.</span>
<span id="cb86-1958"><a href="#cb86-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1959"><a href="#cb86-1959" aria-hidden="true" tabindex="-1"></a><span class="in">`coi ~ if_kill`</span> (Conditional on Inflation): This is where we distinguish between the 0% and 100% boundaries. If an observation is exactly at a boundary (0% or 100% trampled bare ground), the coi part of the model estimates how <span class="in">`if_kill`</span> influences the probability that this boundary observation is 100% (fully trampled) rather than 0% (no trampled ground). So, if <span class="in">`coi`</span> increases with <span class="in">`if_kill`</span>, it suggests that if a site has exact boundary values, the presence of burro kills makes it more likely for that site to be completely trampled (100%) rather than completely untrampled (0%).</span>
<span id="cb86-1960"><a href="#cb86-1960" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-1961"><a href="#cb86-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1964"><a href="#cb86-1964" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-1965"><a href="#cb86-1965" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting1 - beyond_gaussian2</span></span>
<span id="cb86-1966"><a href="#cb86-1966" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-1967"><a href="#cb86-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1968"><a href="#cb86-1968" aria-hidden="true" tabindex="-1"></a>m0<span class="ot">&lt;-</span><span class="fu">bf</span>(cover <span class="sc">~</span> if_kill <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Pool),</span>
<span id="cb86-1969"><a href="#cb86-1969" aria-hidden="true" tabindex="-1"></a>       zoi<span class="sc">~</span>  if_kill, </span>
<span id="cb86-1970"><a href="#cb86-1970" aria-hidden="true" tabindex="-1"></a>       coi<span class="sc">~</span>  if_kill) </span>
<span id="cb86-1971"><a href="#cb86-1971" aria-hidden="true" tabindex="-1"></a>prior1<span class="ot">&lt;-</span><span class="fu">default_prior</span>(m0, <span class="at">family=</span><span class="fu">zero_one_inflated_beta</span>(), <span class="at">data=</span>dat)</span>
<span id="cb86-1972"><a href="#cb86-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1973"><a href="#cb86-1973" aria-hidden="true" tabindex="-1"></a><span class="co"># Since this model is time-consuming, reload without running it:</span></span>
<span id="cb86-1974"><a href="#cb86-1974" aria-hidden="true" tabindex="-1"></a>rerun <span class="ot">&lt;-</span> F</span>
<span id="cb86-1975"><a href="#cb86-1975" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(rerun){</span>
<span id="cb86-1976"><a href="#cb86-1976" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-1977"><a href="#cb86-1977" aria-hidden="true" tabindex="-1"></a>  fit0 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb86-1978"><a href="#cb86-1978" aria-hidden="true" tabindex="-1"></a>   m0,</span>
<span id="cb86-1979"><a href="#cb86-1979" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> dat,</span>
<span id="cb86-1980"><a href="#cb86-1980" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb86-1981"><a href="#cb86-1981" aria-hidden="true" tabindex="-1"></a>   <span class="at">prior =</span> prior1,</span>
<span id="cb86-1982"><a href="#cb86-1982" aria-hidden="true" tabindex="-1"></a>   <span class="at">iter =</span> <span class="dv">6000</span>,</span>
<span id="cb86-1983"><a href="#cb86-1983" aria-hidden="true" tabindex="-1"></a>   <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb86-1984"><a href="#cb86-1984" aria-hidden="true" tabindex="-1"></a>   <span class="at">chains =</span> <span class="dv">2</span>,  <span class="at">cores=</span><span class="dv">2</span>,</span>
<span id="cb86-1985"><a href="#cb86-1985" aria-hidden="true" tabindex="-1"></a>   <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb86-1986"><a href="#cb86-1986" aria-hidden="true" tabindex="-1"></a>     <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb86-1987"><a href="#cb86-1987" aria-hidden="true" tabindex="-1"></a>     <span class="at">max_treedepth =</span> <span class="dv">15</span></span>
<span id="cb86-1988"><a href="#cb86-1988" aria-hidden="true" tabindex="-1"></a>   ),</span>
<span id="cb86-1989"><a href="#cb86-1989" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb86-1990"><a href="#cb86-1990" aria-hidden="true" tabindex="-1"></a>   <span class="at">refresh =</span> <span class="dv">500</span></span>
<span id="cb86-1991"><a href="#cb86-1991" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-1992"><a href="#cb86-1992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(fit0, <span class="at">file =</span> <span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"fit0_BETA_Burros.rds"</span>))</span>
<span id="cb86-1993"><a href="#cb86-1993" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-1994"><a href="#cb86-1994" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb86-1995"><a href="#cb86-1995" aria-hidden="true" tabindex="-1"></a>  fit0 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"fit0_BETA_Burros.rds"</span>))</span>
<span id="cb86-1996"><a href="#cb86-1996" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-1997"><a href="#cb86-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-1998"><a href="#cb86-1998" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit0)</span>
<span id="cb86-1999"><a href="#cb86-1999" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2000"><a href="#cb86-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2003"><a href="#cb86-2003" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2004"><a href="#cb86-2004" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting1_results - beyond_gaussian2</span></span>
<span id="cb86-2005"><a href="#cb86-2005" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-2006"><a href="#cb86-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2007"><a href="#cb86-2007" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"fit0_BETA_Burros.rds"</span>))</span>
<span id="cb86-2008"><a href="#cb86-2008" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit0)</span>
<span id="cb86-2009"><a href="#cb86-2009" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2010"><a href="#cb86-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2011"><a href="#cb86-2011" aria-hidden="true" tabindex="-1"></a><span class="fu">## Location-scale model</span></span>
<span id="cb86-2012"><a href="#cb86-2012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2013"><a href="#cb86-2013" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="simple" icon="false"}</span>
<span id="cb86-2014"><a href="#cb86-2014" aria-hidden="true" tabindex="-1"></a><span class="in">`phi`</span> (Precision/Scale Parameter): This part of the model estimates how <span class="in">`if_kill`</span> (cougar kill presence) influences the variability of the percentage of trampled bare ground for observations that fall between 0% and 100% (i.e., not exactly at the boundaries). A higher <span class="in">`phi`</span> value indicates lower variability (data points are more tightly clustered around the mean). A lower <span class="in">`phi`</span> value indicates higher variability (data points are more spread out).</span>
<span id="cb86-2015"><a href="#cb86-2015" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-2016"><a href="#cb86-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2019"><a href="#cb86-2019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2020"><a href="#cb86-2020" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting2 - beyond_gaussian2</span></span>
<span id="cb86-2021"><a href="#cb86-2021" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-2022"><a href="#cb86-2022" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span><span class="fu">bf</span>(cover <span class="sc">~</span> if_kill <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Pool),</span>
<span id="cb86-2023"><a href="#cb86-2023" aria-hidden="true" tabindex="-1"></a>       zoi<span class="sc">~</span>  if_kill, </span>
<span id="cb86-2024"><a href="#cb86-2024" aria-hidden="true" tabindex="-1"></a>       coi<span class="sc">~</span>  if_kill,</span>
<span id="cb86-2025"><a href="#cb86-2025" aria-hidden="true" tabindex="-1"></a>       phi<span class="sc">~</span>if_kill) </span>
<span id="cb86-2026"><a href="#cb86-2026" aria-hidden="true" tabindex="-1"></a>prior2<span class="ot">&lt;-</span><span class="fu">default_prior</span>(m1, <span class="at">family=</span><span class="fu">zero_one_inflated_beta</span>(), <span class="at">data=</span>dat)</span>
<span id="cb86-2027"><a href="#cb86-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2028"><a href="#cb86-2028" aria-hidden="true" tabindex="-1"></a>rerun <span class="ot">&lt;-</span> F</span>
<span id="cb86-2029"><a href="#cb86-2029" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(rerun){</span>
<span id="cb86-2030"><a href="#cb86-2030" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb86-2031"><a href="#cb86-2031" aria-hidden="true" tabindex="-1"></a>   m1,</span>
<span id="cb86-2032"><a href="#cb86-2032" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> dat,</span>
<span id="cb86-2033"><a href="#cb86-2033" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb86-2034"><a href="#cb86-2034" aria-hidden="true" tabindex="-1"></a>   <span class="at">prior =</span> prior2,</span>
<span id="cb86-2035"><a href="#cb86-2035" aria-hidden="true" tabindex="-1"></a>   <span class="at">iter =</span> <span class="dv">6000</span>,</span>
<span id="cb86-2036"><a href="#cb86-2036" aria-hidden="true" tabindex="-1"></a>   <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb86-2037"><a href="#cb86-2037" aria-hidden="true" tabindex="-1"></a>   <span class="at">chains =</span> <span class="dv">2</span>,  <span class="at">cores=</span><span class="dv">2</span>,</span>
<span id="cb86-2038"><a href="#cb86-2038" aria-hidden="true" tabindex="-1"></a>   <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb86-2039"><a href="#cb86-2039" aria-hidden="true" tabindex="-1"></a>     <span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb86-2040"><a href="#cb86-2040" aria-hidden="true" tabindex="-1"></a>     <span class="at">max_treedepth =</span> <span class="dv">15</span></span>
<span id="cb86-2041"><a href="#cb86-2041" aria-hidden="true" tabindex="-1"></a>   ),</span>
<span id="cb86-2042"><a href="#cb86-2042" aria-hidden="true" tabindex="-1"></a>   <span class="at">seed =</span> <span class="dv">123</span>,      <span class="co">#</span></span>
<span id="cb86-2043"><a href="#cb86-2043" aria-hidden="true" tabindex="-1"></a>   <span class="at">refresh =</span> <span class="dv">500</span>    <span class="co">#</span></span>
<span id="cb86-2044"><a href="#cb86-2044" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-2045"><a href="#cb86-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(fit1, <span class="at">file =</span> <span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"fit1_BETA_Burros.rds"</span>))</span>
<span id="cb86-2046"><a href="#cb86-2046" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb86-2047"><a href="#cb86-2047" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"fit1_BETA_Burros.rds"</span>))</span>
<span id="cb86-2048"><a href="#cb86-2048" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-2049"><a href="#cb86-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2050"><a href="#cb86-2050" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb86-2051"><a href="#cb86-2051" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2052"><a href="#cb86-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2055"><a href="#cb86-2055" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2056"><a href="#cb86-2056" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting2_results - beyond_gaussian2</span></span>
<span id="cb86-2057"><a href="#cb86-2057" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-2058"><a href="#cb86-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2059"><a href="#cb86-2059" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"fit1_BETA_Burros.rds"</span>))</span>
<span id="cb86-2060"><a href="#cb86-2060" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb86-2061"><a href="#cb86-2061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2062"><a href="#cb86-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2063"><a href="#cb86-2063" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Comparison</span></span>
<span id="cb86-2064"><a href="#cb86-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2067"><a href="#cb86-2067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2068"><a href="#cb86-2068" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_comparison - beyond_gaussian2</span></span>
<span id="cb86-2069"><a href="#cb86-2069" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-2070"><a href="#cb86-2070" aria-hidden="true" tabindex="-1"></a>f0loo <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(fit0)</span>
<span id="cb86-2071"><a href="#cb86-2071" aria-hidden="true" tabindex="-1"></a>f1loo <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(fit1)</span>
<span id="cb86-2072"><a href="#cb86-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2073"><a href="#cb86-2073" aria-hidden="true" tabindex="-1"></a>fc<span class="ot">&lt;-</span>loo<span class="sc">::</span><span class="fu">loo_compare</span>(f0loo, f1loo)</span>
<span id="cb86-2074"><a href="#cb86-2074" aria-hidden="true" tabindex="-1"></a>fc</span>
<span id="cb86-2075"><a href="#cb86-2075" aria-hidden="true" tabindex="-1"></a><span class="co">#      elpd_diff se_diff</span></span>
<span id="cb86-2076"><a href="#cb86-2076" aria-hidden="true" tabindex="-1"></a><span class="co"># fit1  0.0       0.0   </span></span>
<span id="cb86-2077"><a href="#cb86-2077" aria-hidden="true" tabindex="-1"></a><span class="co"># fit0 -2.7       1.6   </span></span>
<span id="cb86-2078"><a href="#cb86-2078" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2079"><a href="#cb86-2079" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb86-2080"><a href="#cb86-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2081"><a href="#cb86-2081" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Comparison Results</span></span>
<span id="cb86-2082"><a href="#cb86-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2083"><a href="#cb86-2083" aria-hidden="true" tabindex="-1"></a>Our analysis of the model comparison results shows that the location-scale model is the most supported by the data. This is indicated by its lowest LOO (Leave-One-Out Cross-Validation) information criterion value.</span>
<span id="cb86-2084"><a href="#cb86-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2085"><a href="#cb86-2085" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Interpretation</span></span>
<span id="cb86-2086"><a href="#cb86-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2087"><a href="#cb86-2087" aria-hidden="true" tabindex="-1"></a>**Location (mean) part:**</span>
<span id="cb86-2088"><a href="#cb86-2088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2089"><a href="#cb86-2089" aria-hidden="true" tabindex="-1"></a>On average, the log-odds of the mean percentage of trampled bare ground are lower when burro kills are present compared to when they are absent (estimate = -1.22, 95% CI <span class="sc">\[</span>-2.27, -0.18<span class="sc">\]</span>). This suggests that the presence of burro kills is associated with a lower average percentage of trampled bare ground.</span>
<span id="cb86-2090"><a href="#cb86-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2091"><a href="#cb86-2091" aria-hidden="true" tabindex="-1"></a>**Scale (dispersion/phi) part:** The log-precision (phi) is lower when burro kills are present, compared to when they are absent (estimate = -1.07, 95% CI <span class="sc">\[</span>-2.01, -0.04<span class="sc">\]</span>). Suggesting that the percentage of trampled bare ground exhibits more variation or less consistency in areas where burro kills are present.</span>
<span id="cb86-2092"><a href="#cb86-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2093"><a href="#cb86-2093" aria-hidden="true" tabindex="-1"></a>**Zero-One Inflation (zoi) part:** The log-odds of observing exactly 0% or 100% trampled bare ground are lower when burro kills are present (estimate = -1.71, 95% CI <span class="sc">\[</span>-2.55, -0.89<span class="sc">\]</span>). In other words, areas with burro kills are less likely to be at the extreme boundaries of either no trampled ground or entirely trampled ground.</span>
<span id="cb86-2094"><a href="#cb86-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2095"><a href="#cb86-2095" aria-hidden="true" tabindex="-1"></a>**Conditional on Inflation (coi) part:** The log-odds of a boundary observation being 100% rather than 0% are lower when burro kills are present (estimate = -4.20, 95% CI <span class="sc">\[</span>-12.07, -0.08<span class="sc">\]</span>). This implies that if a boundary value is encountered with burro kills, it is less likely to be 100% (and potentially more likely to be 0%) compared to the "burro kills absent" scenario.</span>
<span id="cb86-2096"><a href="#cb86-2096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2097"><a href="#cb86-2097" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb86-2098"><a href="#cb86-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2099"><a href="#cb86-2099" aria-hidden="true" tabindex="-1"></a>**Does cougar predation affect the percentage of ground trampled by feral donkeys?**</span>
<span id="cb86-2100"><a href="#cb86-2100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2101"><a href="#cb86-2101" aria-hidden="true" tabindex="-1"></a>Answer: Yes, cougar predation, affects the average percentage of ground trampled by feral donkeys.</span>
<span id="cb86-2102"><a href="#cb86-2102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2103"><a href="#cb86-2103" aria-hidden="true" tabindex="-1"></a>**Does cougar predation affect the variability in the percentage of ground trampled by feral donkeys?**</span>
<span id="cb86-2104"><a href="#cb86-2104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2105"><a href="#cb86-2105" aria-hidden="true" tabindex="-1"></a>Answer: The model provides evidence that cougar predation affects the variability in the percentage of ground trampled by feral donkeys.</span>
<span id="cb86-2106"><a href="#cb86-2106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2107"><a href="#cb86-2107" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model selection</span></span>
<span id="cb86-2108"><a href="#cb86-2108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2109"><a href="#cb86-2109" aria-hidden="true" tabindex="-1"></a>This section outlines general guidelines for model selection and refinement, based on the results from the previous examples (sections XX and Beyond Gaussian 1). These steps can be applied to any model fitting process, whether using <span class="in">`glmmTMB`</span>, <span class="in">`brms`</span>, or other packages.</span>
<span id="cb86-2110"><a href="#cb86-2110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2111"><a href="#cb86-2111" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Identify data type and plot raw data** to understand the distribution and structure of the response variable. This helps in selecting an appropriate model family (e.g., Gaussian, Poisson, Negative Binomial, Beta).</span>
<span id="cb86-2112"><a href="#cb86-2112" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Begin with a simpler model** (e.g., a location-only model assuming homoscedasticity) to establish a baseline for interpretation.</span>
<span id="cb86-2113"><a href="#cb86-2113" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Check residual diagonostics** to detect possible model misspecification, such as overdispersion or non-uniformity of residuals. If issues are detected, consider more complex models (e.g., location-scale models) that account for heterogeneity in variance.</span>
<span id="cb86-2114"><a href="#cb86-2114" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Gradually increase model complexity**: Introduce additional components, such as group-level effects on the scale (variance), and consider estimating correlations between random effects when theoretically or empirically justified—especially when supported by sufficient sample size.</span>
<span id="cb86-2115"><a href="#cb86-2115" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Compare models using information criteria**:</span>
<span id="cb86-2116"><a href="#cb86-2116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2117"><a href="#cb86-2117" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For frequentist models: use **AIC** (Akaike Information Criterion)</span>
<span id="cb86-2118"><a href="#cb86-2118" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For Bayesian models: use **LOO** (Leave-One-Out Cross-Validation) or **WAIC** (Widely Applicable Information Criterion).</span>
<span id="cb86-2119"><a href="#cb86-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2120"><a href="#cb86-2120" aria-hidden="true" tabindex="-1"></a>Ultimately, the goal is not only to improve statistical fit but also to gain biological insights. For example, finding that a scale predictor improves model fit may suggest biologically meaningful heterogeneity.</span>
<span id="cb86-2121"><a href="#cb86-2121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2122"><a href="#cb86-2122" aria-hidden="true" tabindex="-1"></a>We demonstrate these steps using the previous examples, where we started with a location-only model and then moved to a location-scale model to account for heterogeneity in variance. We also compared models using AICc and LOO criteria to select the best-fitting model. Although parts of the examples below may repeat content from earlier sections, we present them again here in sequence to illustrate a typical approach to model selection and refinement.</span>
<span id="cb86-2123"><a href="#cb86-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2124"><a href="#cb86-2124" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="simple" icon="false"}</span>
<span id="cb86-2125"><a href="#cb86-2125" aria-hidden="true" tabindex="-1"></a>One important thing to keep in mind is that <span class="in">`DHARMa`</span> does not work with models fitted using <span class="in">`brms`</span>. This means that you cannot check residual diagnostics for the location-only double-hierarchical model (model 3) if it was fitted with brms. If you want to use <span class="in">`DHARMa`</span> for residual diagnostics, you need to run model 2.5 instead - in other words, you cannot include the correlation part.</span>
<span id="cb86-2126"><a href="#cb86-2126" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-2127"><a href="#cb86-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2128"><a href="#cb86-2128" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb86-2129"><a href="#cb86-2129" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;!-- ## Example 1</span></span>
<span id="cb86-2130"><a href="#cb86-2130" aria-hidden="true" tabindex="-1"></a><span class="in">Santi's data</span></span>
<span id="cb86-2131"><a href="#cb86-2131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2132"><a href="#cb86-2132" aria-hidden="true" tabindex="-1"></a><span class="in">### Step 1: Identify data type and plot raw data</span></span>
<span id="cb86-2133"><a href="#cb86-2133" aria-hidden="true" tabindex="-1"></a><span class="in"> --&gt;</span></span>
<span id="cb86-2134"><a href="#cb86-2134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2135"><a href="#cb86-2135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2136"><a href="#cb86-2136" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example 2</span></span>
<span id="cb86-2137"><a href="#cb86-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2138"><a href="#cb86-2138" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb86-2139"><a href="#cb86-2139" aria-hidden="true" tabindex="-1"></a>We revisit the dataset on Estrildid finches to examine how food supplementation affects gaze frequency toward dot patterns (as introduced in Beyond Gaussian 1).</span>
<span id="cb86-2140"><a href="#cb86-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2141"><a href="#cb86-2141" aria-hidden="true" tabindex="-1"></a>To avoid repeating the structure of the previous example, we now take a more realistic modeling approach by incorporating phylogenetic non-independence as a random effect. The response variable, frequency, is a count variable, which supports the use of Poisson or Negative Binomial distributions. However, as visualised in the plots below, there is substantial between-species variation—both in mean gaze frequency and in the degree of within-species variability.</span>
<span id="cb86-2142"><a href="#cb86-2142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2143"><a href="#cb86-2143" aria-hidden="true" tabindex="-1"></a>To better capture this structure, we include phylogeny as a random effect, distinct from the previously used species effect. While species was treated as a simple categorical grouping factor, the phylogenetic random effect accounts for shared evolutionary history and allows for correlated responses among closely related species.</span>
<span id="cb86-2144"><a href="#cb86-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2145"><a href="#cb86-2145" aria-hidden="true" tabindex="-1"></a>In the following sections, we will:</span>
<span id="cb86-2146"><a href="#cb86-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2147"><a href="#cb86-2147" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Include phylogeny as a random effect in the location and/or scale parts of the model.</span>
<span id="cb86-2148"><a href="#cb86-2148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2149"><a href="#cb86-2149" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Compare models with and without phylogenetic structure to evaluate whether accounting for evolutionary history improves model fit.</span>
<span id="cb86-2150"><a href="#cb86-2150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2151"><a href="#cb86-2151" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1</span></span>
<span id="cb86-2152"><a href="#cb86-2152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2153"><a href="#cb86-2153" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Identify data type and plot raw data</span></span>
<span id="cb86-2154"><a href="#cb86-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2155"><a href="#cb86-2155" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This is the same figures as in the previous example - should O skip?? --&gt;</span></span>
<span id="cb86-2156"><a href="#cb86-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2157"><a href="#cb86-2157" aria-hidden="true" tabindex="-1"></a>The violin plot by condition and sex shows that gaze frequency is generally higher in the food-deprived condition, with some individuals—especially females—showing very high values (over 500). The faceted line plot by species shows: - Consistent directional trends (e.g., reduced gazing in the supplied condition) - Species-specific differences in variance, suggesting possible heteroscedasticity</span>
<span id="cb86-2158"><a href="#cb86-2158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2159"><a href="#cb86-2159" aria-hidden="true" tabindex="-1"></a>These patterns raise two important considerations: 1. Overdispersion is likely present, particularly in the deprived condition, where the spread of counts is large. 2. A phylogenetic effect may be at play, since species vary not only in their average gaze frequencies but also in how consistent individuals are within each species - possibly due to traits shaped by common ancestry.</span>
<span id="cb86-2160"><a href="#cb86-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2163"><a href="#cb86-2163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2164"><a href="#cb86-2164" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: identify_data_type - eg2</span></span>
<span id="cb86-2165"><a href="#cb86-2165" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb86-2166"><a href="#cb86-2166" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb86-2167"><a href="#cb86-2167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2168"><a href="#cb86-2168" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_pref, <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb86-2169"><a href="#cb86-2169" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> frequency)) <span class="sc">+</span></span>
<span id="cb86-2170"><a href="#cb86-2170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>(<span class="at">color =</span> <span class="st">"#8B8B83"</span>, <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb86-2171"><a href="#cb86-2171" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb86-2172"><a href="#cb86-2172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">shape =</span> sex, <span class="at">color =</span> sex),</span>
<span id="cb86-2173"><a href="#cb86-2173" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb86-2174"><a href="#cb86-2174" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">height =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb86-2175"><a href="#cb86-2175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-2176"><a href="#cb86-2176" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total frequency of gazes towards dot patterns"</span>,</span>
<span id="cb86-2177"><a href="#cb86-2177" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb86-2178"><a href="#cb86-2178" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total frequency of gazes (1hr)"</span></span>
<span id="cb86-2179"><a href="#cb86-2179" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-2180"><a href="#cb86-2180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="dv">17</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="dv">16</span>),</span>
<span id="cb86-2181"><a href="#cb86-2181" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"Male"</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"Female"</span>)) <span class="sc">+</span></span>
<span id="cb86-2182"><a href="#cb86-2182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"#009ACD"</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"#FF4D4D"</span>),</span>
<span id="cb86-2183"><a href="#cb86-2183" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"Male"</span>, <span class="st">"F"</span> <span class="ot">=</span> <span class="st">"Female"</span>)) <span class="sc">+</span></span>
<span id="cb86-2184"><a href="#cb86-2184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb86-2185"><a href="#cb86-2185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb86-2186"><a href="#cb86-2186" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb86-2187"><a href="#cb86-2187" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb86-2188"><a href="#cb86-2188" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>),</span>
<span id="cb86-2189"><a href="#cb86-2189" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#6E7B8B"</span>),</span>
<span id="cb86-2190"><a href="#cb86-2190" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb86-2191"><a href="#cb86-2191" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb86-2192"><a href="#cb86-2192" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-2193"><a href="#cb86-2193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2194"><a href="#cb86-2194" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat_pref, <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> frequency)) <span class="sc">+</span></span>
<span id="cb86-2195"><a href="#cb86-2195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb86-2196"><a href="#cb86-2196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-2197"><a href="#cb86-2197" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Total frequency of gazes towards dot patterns by species"</span>,</span>
<span id="cb86-2198"><a href="#cb86-2198" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Condition"</span>,</span>
<span id="cb86-2199"><a href="#cb86-2199" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Total frequency of gazes (1hr)"</span></span>
<span id="cb86-2200"><a href="#cb86-2200" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-2201"><a href="#cb86-2201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="fu">aes</span>(<span class="at">group =</span> species, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb86-2202"><a href="#cb86-2202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb86-2203"><a href="#cb86-2203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species)</span>
<span id="cb86-2204"><a href="#cb86-2204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2205"><a href="#cb86-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2206"><a href="#cb86-2206" aria-hidden="true" tabindex="-1"></a><span class="fu">### Steps 2 and 3</span></span>
<span id="cb86-2207"><a href="#cb86-2207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2208"><a href="#cb86-2208" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Begin with a simpler model and heck residual diagnostics</span></span>
<span id="cb86-2209"><a href="#cb86-2209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2210"><a href="#cb86-2210" aria-hidden="true" tabindex="-1"></a>From the previous analysis, we already know that a location-only model without phylogenetic effects does not adequately capture the structure of the data. However, here we re-examine this model before moving on.</span>
<span id="cb86-2211"><a href="#cb86-2211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2214"><a href="#cb86-2214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2215"><a href="#cb86-2215" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting - eg2</span></span>
<span id="cb86-2216"><a href="#cb86-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2217"><a href="#cb86-2217" aria-hidden="true" tabindex="-1"></a>model_0 <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb86-2218"><a href="#cb86-2218" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span>  condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="co"># location part (mean)</span></span>
<span id="cb86-2219"><a href="#cb86-2219" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref,</span>
<span id="cb86-2220"><a href="#cb86-2220" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb86-2221"><a href="#cb86-2221" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2222"><a href="#cb86-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2223"><a href="#cb86-2223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2224"><a href="#cb86-2224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2225"><a href="#cb86-2225" aria-hidden="true" tabindex="-1"></a>To evaluate model adequacy, we use the DHARMa package to simulate and visualize residuals. The plots allow us to assess residual uniformity, potential over- or underdispersion, outliers, and leverage.</span>
<span id="cb86-2226"><a href="#cb86-2226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2229"><a href="#cb86-2229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2230"><a href="#cb86-2230" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: residual_diagnostics - eg2</span></span>
<span id="cb86-2231"><a href="#cb86-2231" aria-hidden="true" tabindex="-1"></a><span class="co"># main diagnostic plots</span></span>
<span id="cb86-2232"><a href="#cb86-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2233"><a href="#cb86-2233" aria-hidden="true" tabindex="-1"></a>model0_res <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(model_0, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb86-2234"><a href="#cb86-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2235"><a href="#cb86-2235" aria-hidden="true" tabindex="-1"></a><span class="co"># formal test for over/underdispersion</span></span>
<span id="cb86-2236"><a href="#cb86-2236" aria-hidden="true" tabindex="-1"></a><span class="fu">testDispersion</span>(model0_res) </span>
<span id="cb86-2237"><a href="#cb86-2237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2238"><a href="#cb86-2238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2239"><a href="#cb86-2239" aria-hidden="true" tabindex="-1"></a>Although the dispersion test (p = 0.456) suggests no clear evidence of overdispersion based on the mean–variance relationship, the KS test indicates that the residuals deviate from a uniform distribution. These two tests assess different aspects of model adequacy: the dispersion test evaluates whether the variance is correctly specified as a function of the mean, while the KS test can detect broader misfits, such as unmodeled structure, zero inflation, or group-specific heteroscedasticity. Thus, even in the absence of overdispersion, the presence of non-uniform residuals supports the need for a more flexible model.</span>
<span id="cb86-2240"><a href="#cb86-2240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2241"><a href="#cb86-2241" aria-hidden="true" tabindex="-1"></a>Since we have found the limitations of the model without phylogenetic effects, we now proceed to fit the same model using the <span class="in">`brms`</span> package, this time including the phylogenetic effect as a random effect to account for the non-independence among species. Including both species and phylogeny as random effects allows us to distinguish between two sources of variation: the phylogenetic effect captures correlations arising from shared evolutionary history, whereas the species-level random intercept absorbs residual species-specific variation not accounted for by the tree—such as ecological or methodological factors. Including both terms helps avoid underestimating heterogeneity at the species level and provides a more accurate partitioning of variance.</span>
<span id="cb86-2242"><a href="#cb86-2242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2243"><a href="#cb86-2243" aria-hidden="true" tabindex="-1"></a>First, we run the same model as above, but using the <span class="in">`brms`</span> package. Then, we will gradually increase the model complexity by adding phylogenetic effects and a scale part to the model.</span>
<span id="cb86-2244"><a href="#cb86-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2247"><a href="#cb86-2247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2248"><a href="#cb86-2248" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting1 - eg2</span></span>
<span id="cb86-2249"><a href="#cb86-2249" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-2250"><a href="#cb86-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2251"><a href="#cb86-2251" aria-hidden="true" tabindex="-1"></a>formula_eg2<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb86-2252"><a href="#cb86-2252" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id)</span>
<span id="cb86-2253"><a href="#cb86-2253" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2254"><a href="#cb86-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2255"><a href="#cb86-2255" aria-hidden="true" tabindex="-1"></a>prior_eg2<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">default_prior</span>(formula_eg2<span class="fl">.0</span>, </span>
<span id="cb86-2256"><a href="#cb86-2256" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> dat_pref, </span>
<span id="cb86-2257"><a href="#cb86-2257" aria-hidden="true" tabindex="-1"></a>                        <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb86-2258"><a href="#cb86-2258" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2259"><a href="#cb86-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2260"><a href="#cb86-2260" aria-hidden="true" tabindex="-1"></a>model_eg2<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(formula_eg2<span class="fl">.0</span>, </span>
<span id="cb86-2261"><a href="#cb86-2261" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dat_pref, </span>
<span id="cb86-2262"><a href="#cb86-2262" aria-hidden="true" tabindex="-1"></a>            <span class="at">prior =</span> prior_eg2<span class="fl">.0</span>,</span>
<span id="cb86-2263"><a href="#cb86-2263" aria-hidden="true" tabindex="-1"></a>            <span class="at">chains =</span> <span class="dv">2</span>, </span>
<span id="cb86-2264"><a href="#cb86-2264" aria-hidden="true" tabindex="-1"></a>            <span class="at">iter =</span> <span class="dv">5000</span>, </span>
<span id="cb86-2265"><a href="#cb86-2265" aria-hidden="true" tabindex="-1"></a>            <span class="at">warmup =</span> <span class="dv">3000</span>,</span>
<span id="cb86-2266"><a href="#cb86-2266" aria-hidden="true" tabindex="-1"></a>            <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb86-2267"><a href="#cb86-2267" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb86-2268"><a href="#cb86-2268" aria-hidden="true" tabindex="-1"></a>            <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-2269"><a href="#cb86-2269" aria-hidden="true" tabindex="-1"></a>            <span class="co"># control = list(adapt_delta = 0.95)</span></span>
<span id="cb86-2270"><a href="#cb86-2270" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2271"><a href="#cb86-2271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2272"><a href="#cb86-2272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2273"><a href="#cb86-2273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2274"><a href="#cb86-2274" aria-hidden="true" tabindex="-1"></a>Then, we add the phylogenetic effect as a random effect to the model. This allows us to account for the non-independence among species due to shared evolutionary history.</span>
<span id="cb86-2275"><a href="#cb86-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2278"><a href="#cb86-2278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2279"><a href="#cb86-2279" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model_fitting2 - eg2</span></span>
<span id="cb86-2280"><a href="#cb86-2280" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-2281"><a href="#cb86-2281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2282"><a href="#cb86-2282" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">read.nexus</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"AM_est_tree.txt"</span>))</span>
<span id="cb86-2283"><a href="#cb86-2283" aria-hidden="true" tabindex="-1"></a>tree　<span class="ot">&lt;-</span><span class="fu">force.ultrametric</span>(tree, <span class="at">method =</span> <span class="st">"extend"</span>)</span>
<span id="cb86-2284"><a href="#cb86-2284" aria-hidden="true" tabindex="-1"></a><span class="co"># is.ultrametric(tree)</span></span>
<span id="cb86-2285"><a href="#cb86-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2286"><a href="#cb86-2286" aria-hidden="true" tabindex="-1"></a>tip <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Lonchura_cantans"</span>,<span class="st">"Uraeginthus_bengalus"</span>,<span class="st">"Neochmia_modesta"</span>,</span>
<span id="cb86-2287"><a href="#cb86-2287" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Lonchura_atricapilla"</span>,<span class="st">"Padda_oryzivora"</span>,<span class="st">"Taeniopygia_bichenovii"</span>,</span>
<span id="cb86-2288"><a href="#cb86-2288" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Emblema_pictum"</span>,<span class="st">"Neochmia_ruficauda"</span>,<span class="st">"Lonchura_maja"</span>,</span>
<span id="cb86-2289"><a href="#cb86-2289" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Taeniopygia_guttata"</span>,<span class="st">"Chloebia_gouldiae"</span>,<span class="st">"Lonchura_castaneothorax"</span>)</span>
<span id="cb86-2290"><a href="#cb86-2290" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">KeepTip</span>(tree, tip, <span class="at">preorder =</span> <span class="cn">TRUE</span>, <span class="at">check =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-2291"><a href="#cb86-2291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2292"><a href="#cb86-2292" aria-hidden="true" tabindex="-1"></a><span class="co"># Create phylogenetic correlation matrix</span></span>
<span id="cb86-2293"><a href="#cb86-2293" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">vcv.phylo</span>(tree, <span class="at">corr =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-2294"><a href="#cb86-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2295"><a href="#cb86-2295" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the model formula (location-only)</span></span>
<span id="cb86-2296"><a href="#cb86-2296" aria-hidden="true" tabindex="-1"></a>formula_eg2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb86-2297"><a href="#cb86-2297" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span> </span>
<span id="cb86-2298"><a href="#cb86-2298" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> a <span class="sc">|</span> <span class="fu">gr</span>(phylo, <span class="at">cov =</span> A)) <span class="sc">+</span>  <span class="co"># phylogenetic random effect</span></span>
<span id="cb86-2299"><a href="#cb86-2299" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span>             <span class="co"># non-phylogenetic species-level random effect (ecological factors)</span></span>
<span id="cb86-2300"><a href="#cb86-2300" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> id)                    <span class="co"># individual-level random effect</span></span>
<span id="cb86-2301"><a href="#cb86-2301" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2302"><a href="#cb86-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2303"><a href="#cb86-2303" aria-hidden="true" tabindex="-1"></a>prior_eg2<span class="fl">.1</span> <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">get_prior</span>(</span>
<span id="cb86-2304"><a href="#cb86-2304" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> formula_eg2<span class="fl">.1</span>, </span>
<span id="cb86-2305"><a href="#cb86-2305" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref, </span>
<span id="cb86-2306"><a href="#cb86-2306" aria-hidden="true" tabindex="-1"></a>  <span class="at">data2 =</span> <span class="fu">list</span>(<span class="at">A =</span> A),</span>
<span id="cb86-2307"><a href="#cb86-2307" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb86-2308"><a href="#cb86-2308" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2309"><a href="#cb86-2309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2310"><a href="#cb86-2310" aria-hidden="true" tabindex="-1"></a>model_eg2<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb86-2311"><a href="#cb86-2311" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> formula_eg2<span class="fl">.1</span>, </span>
<span id="cb86-2312"><a href="#cb86-2312" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref, </span>
<span id="cb86-2313"><a href="#cb86-2313" aria-hidden="true" tabindex="-1"></a>  <span class="at">data2 =</span> <span class="fu">list</span>(<span class="at">A =</span> A),</span>
<span id="cb86-2314"><a href="#cb86-2314" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>, </span>
<span id="cb86-2315"><a href="#cb86-2315" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">12000</span>, </span>
<span id="cb86-2316"><a href="#cb86-2316" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">10000</span>,</span>
<span id="cb86-2317"><a href="#cb86-2317" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb86-2318"><a href="#cb86-2318" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb86-2319"><a href="#cb86-2319" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> prior_eg2<span class="fl">.1</span>,</span>
<span id="cb86-2320"><a href="#cb86-2320" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>),</span>
<span id="cb86-2321"><a href="#cb86-2321" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-2322"><a href="#cb86-2322" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2323"><a href="#cb86-2323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2324"><a href="#cb86-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2325"><a href="#cb86-2325" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4</span></span>
<span id="cb86-2326"><a href="#cb86-2326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2327"><a href="#cb86-2327" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gradually increase model complexity</span></span>
<span id="cb86-2328"><a href="#cb86-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2329"><a href="#cb86-2329" aria-hidden="true" tabindex="-1"></a>In the previous model, variation in individual gaze frequency was modeled assuming a constant dispersion parameter across all groups. However, visual inspection of the raw data suggests heteroscedasticity (i.e., group-specific variance). To accommodate this, we now fit a location-scale model where the shape (dispersion) parameter is allowed to vary by condition and sex.</span>
<span id="cb86-2330"><a href="#cb86-2330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2331"><a href="#cb86-2331" aria-hidden="true" tabindex="-1"></a>This model helps capture structured variability in the data and may reveal whether the precision (or variability) of gaze frequency differs systematically between experimental groups.</span>
<span id="cb86-2332"><a href="#cb86-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2335"><a href="#cb86-2335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2336"><a href="#cb86-2336" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-2337"><a href="#cb86-2337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2338"><a href="#cb86-2338" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the model formula (location-scale) - the scale part does not include random effects</span></span>
<span id="cb86-2339"><a href="#cb86-2339" aria-hidden="true" tabindex="-1"></a>formula_eg2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb86-2340"><a href="#cb86-2340" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span> </span>
<span id="cb86-2341"><a href="#cb86-2341" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> a <span class="sc">|</span> <span class="fu">gr</span>(phylo, <span class="at">cov =</span> A)) <span class="sc">+</span>  </span>
<span id="cb86-2342"><a href="#cb86-2342" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span>          </span>
<span id="cb86-2343"><a href="#cb86-2343" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> id),              </span>
<span id="cb86-2344"><a href="#cb86-2344" aria-hidden="true" tabindex="-1"></a>shape <span class="sc">~</span> condition <span class="sc">+</span> sex</span>
<span id="cb86-2345"><a href="#cb86-2345" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2346"><a href="#cb86-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2347"><a href="#cb86-2347" aria-hidden="true" tabindex="-1"></a>prior_eg2<span class="fl">.2</span> <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">get_prior</span>(</span>
<span id="cb86-2348"><a href="#cb86-2348" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> formula_eg2<span class="fl">.2</span>, </span>
<span id="cb86-2349"><a href="#cb86-2349" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref, </span>
<span id="cb86-2350"><a href="#cb86-2350" aria-hidden="true" tabindex="-1"></a>  <span class="at">data2 =</span> <span class="fu">list</span>(<span class="at">A =</span> A),</span>
<span id="cb86-2351"><a href="#cb86-2351" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>, <span class="at">link_shape =</span> <span class="st">"log"</span>)</span>
<span id="cb86-2352"><a href="#cb86-2352" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2353"><a href="#cb86-2353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2354"><a href="#cb86-2354" aria-hidden="true" tabindex="-1"></a>model_eg2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb86-2355"><a href="#cb86-2355" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> formula_eg2<span class="fl">.2</span>, </span>
<span id="cb86-2356"><a href="#cb86-2356" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref, </span>
<span id="cb86-2357"><a href="#cb86-2357" aria-hidden="true" tabindex="-1"></a>  <span class="at">data2 =</span> <span class="fu">list</span>(<span class="at">A =</span> A),</span>
<span id="cb86-2358"><a href="#cb86-2358" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>, </span>
<span id="cb86-2359"><a href="#cb86-2359" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">12000</span>, </span>
<span id="cb86-2360"><a href="#cb86-2360" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">10000</span>,</span>
<span id="cb86-2361"><a href="#cb86-2361" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb86-2362"><a href="#cb86-2362" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>, <span class="at">link_shape =</span> <span class="st">"log"</span>),</span>
<span id="cb86-2363"><a href="#cb86-2363" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> prior_eg2<span class="fl">.2</span>,</span>
<span id="cb86-2364"><a href="#cb86-2364" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>),</span>
<span id="cb86-2365"><a href="#cb86-2365" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-2366"><a href="#cb86-2366" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2367"><a href="#cb86-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2368"><a href="#cb86-2368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2369"><a href="#cb86-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2372"><a href="#cb86-2372" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2373"><a href="#cb86-2373" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-2374"><a href="#cb86-2374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2375"><a href="#cb86-2375" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the model formula (location-scale)</span></span>
<span id="cb86-2376"><a href="#cb86-2376" aria-hidden="true" tabindex="-1"></a><span class="do">## the scale part includes phylogenetic random effects and individual-level random effects</span></span>
<span id="cb86-2377"><a href="#cb86-2377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2378"><a href="#cb86-2378" aria-hidden="true" tabindex="-1"></a>formula_eg2<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">bf</span>(</span>
<span id="cb86-2379"><a href="#cb86-2379" aria-hidden="true" tabindex="-1"></a>  frequency <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span> </span>
<span id="cb86-2380"><a href="#cb86-2380" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span>a<span class="sc">|</span> <span class="fu">gr</span>(phylo, <span class="at">cov =</span> A)) <span class="sc">+</span>  <span class="co"># phylogenetic random effect</span></span>
<span id="cb86-2381"><a href="#cb86-2381" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span>            <span class="co"># non-phylogenetic species-level random effect (ecological factors)</span></span>
<span id="cb86-2382"><a href="#cb86-2382" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> id),              <span class="co"># individual-level random effect</span></span>
<span id="cb86-2383"><a href="#cb86-2383" aria-hidden="true" tabindex="-1"></a>shape <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span></span>
<span id="cb86-2384"><a href="#cb86-2384" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span>a<span class="sc">|</span> <span class="fu">gr</span>(phylo, <span class="at">cov =</span> A)) <span class="sc">+</span>  </span>
<span id="cb86-2385"><a href="#cb86-2385" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> species) <span class="sc">+</span>  </span>
<span id="cb86-2386"><a href="#cb86-2386" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> id)          </span>
<span id="cb86-2387"><a href="#cb86-2387" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb86-2388"><a href="#cb86-2388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2389"><a href="#cb86-2389" aria-hidden="true" tabindex="-1"></a>prior_eg2<span class="fl">.3</span> <span class="ot">&lt;-</span> brms<span class="sc">::</span><span class="fu">get_prior</span>(</span>
<span id="cb86-2390"><a href="#cb86-2390" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> formula_eg2<span class="fl">.3</span>, </span>
<span id="cb86-2391"><a href="#cb86-2391" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref, </span>
<span id="cb86-2392"><a href="#cb86-2392" aria-hidden="true" tabindex="-1"></a>  <span class="at">data2 =</span> <span class="fu">list</span>(<span class="at">A =</span> A),</span>
<span id="cb86-2393"><a href="#cb86-2393" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>, <span class="at">link_shape =</span> <span class="st">"log"</span>)</span>
<span id="cb86-2394"><a href="#cb86-2394" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2395"><a href="#cb86-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2396"><a href="#cb86-2396" aria-hidden="true" tabindex="-1"></a>model_eg2<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb86-2397"><a href="#cb86-2397" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> formula_eg2<span class="fl">.3</span>, </span>
<span id="cb86-2398"><a href="#cb86-2398" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dat_pref, </span>
<span id="cb86-2399"><a href="#cb86-2399" aria-hidden="true" tabindex="-1"></a>  <span class="at">data2 =</span> <span class="fu">list</span>(<span class="at">A =</span> A),</span>
<span id="cb86-2400"><a href="#cb86-2400" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>, </span>
<span id="cb86-2401"><a href="#cb86-2401" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">12000</span>, </span>
<span id="cb86-2402"><a href="#cb86-2402" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">10000</span>,</span>
<span id="cb86-2403"><a href="#cb86-2403" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb86-2404"><a href="#cb86-2404" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">negbinomial</span>(<span class="at">link =</span> <span class="st">"log"</span>, <span class="at">link_shape =</span> <span class="st">"log"</span>),</span>
<span id="cb86-2405"><a href="#cb86-2405" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> prior_eg2<span class="fl">.3</span>,</span>
<span id="cb86-2406"><a href="#cb86-2406" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.95</span>),</span>
<span id="cb86-2407"><a href="#cb86-2407" aria-hidden="true" tabindex="-1"></a>  <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-2408"><a href="#cb86-2408" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-2409"><a href="#cb86-2409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2410"><a href="#cb86-2410" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_eg2<span class="fl">.3</span>)</span>
<span id="cb86-2411"><a href="#cb86-2411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2412"><a href="#cb86-2412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2413"><a href="#cb86-2413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2414"><a href="#cb86-2414" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5</span></span>
<span id="cb86-2415"><a href="#cb86-2415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2416"><a href="#cb86-2416" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Compare models using information criteria</span></span>
<span id="cb86-2417"><a href="#cb86-2417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2418"><a href="#cb86-2418" aria-hidden="true" tabindex="-1"></a>To assess whether model fit improves with increased complexity, we compare models using Leave-One-Out Cross-Validation (LOO).</span>
<span id="cb86-2419"><a href="#cb86-2419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2422"><a href="#cb86-2422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2423"><a href="#cb86-2423" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb86-2424"><a href="#cb86-2424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2425"><a href="#cb86-2425" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">future.globals.maxSize =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">1024</span><span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb86-2426"><a href="#cb86-2426" aria-hidden="true" tabindex="-1"></a>loo_eg2<span class="fl">.0</span> <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(model_eg2<span class="fl">.0</span>, <span class="at">moment_match =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-2427"><a href="#cb86-2427" aria-hidden="true" tabindex="-1"></a>                      <span class="at">reloo =</span> <span class="cn">TRUE</span>, <span class="at">cores =</span> <span class="dv">2</span>)</span>
<span id="cb86-2428"><a href="#cb86-2428" aria-hidden="true" tabindex="-1"></a>loo_eg2<span class="fl">.1</span> <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(model_eg2<span class="fl">.1</span>, <span class="at">moment_match =</span> <span class="cn">TRUE</span>, </span>
<span id="cb86-2429"><a href="#cb86-2429" aria-hidden="true" tabindex="-1"></a>                      <span class="at">reloo =</span> <span class="cn">TRUE</span>, <span class="at">cores =</span> <span class="dv">2</span>)</span>
<span id="cb86-2430"><a href="#cb86-2430" aria-hidden="true" tabindex="-1"></a>loo_eg2<span class="fl">.2</span> <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(model_eg2<span class="fl">.2</span>, <span class="at">moment_match =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-2431"><a href="#cb86-2431" aria-hidden="true" tabindex="-1"></a>                      <span class="at">reloo =</span> <span class="cn">TRUE</span>, <span class="at">cores =</span> <span class="dv">2</span>)</span>
<span id="cb86-2432"><a href="#cb86-2432" aria-hidden="true" tabindex="-1"></a>loo_eg2<span class="fl">.3</span> <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo</span>(model_eg2<span class="fl">.3</span>, <span class="at">moment_match =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-2433"><a href="#cb86-2433" aria-hidden="true" tabindex="-1"></a>                      <span class="at">reloo =</span> <span class="cn">TRUE</span>, <span class="at">cores =</span> <span class="dv">2</span>)</span>
<span id="cb86-2434"><a href="#cb86-2434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2435"><a href="#cb86-2435" aria-hidden="true" tabindex="-1"></a>fc_eg2 <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo_compare</span>(loo_eg2<span class="fl">.0</span>, loo_eg2<span class="fl">.1</span>, loo_eg2<span class="fl">.2</span>, loo_eg2<span class="fl">.3</span>)</span>
<span id="cb86-2436"><a href="#cb86-2436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2437"><a href="#cb86-2437" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fc_eg2)</span>
<span id="cb86-2438"><a href="#cb86-2438" aria-hidden="true" tabindex="-1"></a><span class="co">#             elpd_diff se_diff</span></span>
<span id="cb86-2439"><a href="#cb86-2439" aria-hidden="true" tabindex="-1"></a><span class="co"># model_eg2.3   0.0       0.0  </span></span>
<span id="cb86-2440"><a href="#cb86-2440" aria-hidden="true" tabindex="-1"></a><span class="co"># model_eg2.1 -11.5       4.5  </span></span>
<span id="cb86-2441"><a href="#cb86-2441" aria-hidden="true" tabindex="-1"></a><span class="co"># model_eg2.2 -11.7       5.3  </span></span>
<span id="cb86-2442"><a href="#cb86-2442" aria-hidden="true" tabindex="-1"></a><span class="co"># model_eg2.0 -13.5       4.9  </span></span>
<span id="cb86-2443"><a href="#cb86-2443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2444"><a href="#cb86-2444" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_eg2<span class="fl">.3</span>)</span>
<span id="cb86-2445"><a href="#cb86-2445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2446"><a href="#cb86-2446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2447"><a href="#cb86-2447" aria-hidden="true" tabindex="-1"></a>Model eg2.3, which includes both phylogenetic and species-level effects on the location and scale parts, performs best (highest elpd).</span>
<span id="cb86-2448"><a href="#cb86-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2449"><a href="#cb86-2449" aria-hidden="true" tabindex="-1"></a>ELPD stands for Expected Log Predictive Density. It is a measure of out-of-sample predictive accuracy—that is, how well a model is expected to predict new, unseen data. - It is used in Bayesian model comparison, especially when using LOO-CV (Leave-One-Out Cross-Validation). - Higher ELPD means better predictive performance. - It is calculated by taking the log-likelihood of each observation, averaged over posterior draws, and then summed over all observations. - It rewards models that fit the data well without overfitting.</span>
<span id="cb86-2450"><a href="#cb86-2450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2453"><a href="#cb86-2453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2454"><a href="#cb86-2454" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb86-2455"><a href="#cb86-2455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2456"><a href="#cb86-2456" aria-hidden="true" tabindex="-1"></a>model_eg2<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"Rdata"</span>, <span class="st">"model_eg2.3.rds"</span>))</span>
<span id="cb86-2457"><a href="#cb86-2457" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_eg2<span class="fl">.3</span>)</span>
<span id="cb86-2458"><a href="#cb86-2458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2459"><a href="#cb86-2459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb86-2460"><a href="#cb86-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2461"><a href="#cb86-2461" aria-hidden="true" tabindex="-1"></a>Accounting for phylogeny captures much of the between-species structure, it highlights evolutionary constraints or shared ecological traits. The remaining species-specific variance suggests additional factors (e.g., experimental nuances) not captured by the tree alone.</span>
<span id="cb86-2462"><a href="#cb86-2462" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb86-2463"><a href="#cb86-2463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2464"><a href="#cb86-2464" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb86-2465"><a href="#cb86-2465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2466"><a href="#cb86-2466" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cleasby IR, Burke T, Schroeder J, Nakagawa S. (2011) Food supplements increase adult tarsus length, but not growth rate, in an island population of house sparrows (Passer domesticus). *BMC Research Notes*. 4:1-1. doi: 10.1186/1756-0500-4-431</span>
<span id="cb86-2467"><a href="#cb86-2467" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Drummond H, Rodriguez C, Ortega S. (2025). Long-Term Insights into Who Benefits from Brood Reduction. *Behavioral Ecology*. doi: 10.1093/beheco/araf050</span>
<span id="cb86-2468"><a href="#cb86-2468" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mizuno A, Soma M. (2023) Pre-existing visual preference for white dot patterns in estrildid finches: a comparative study of a multi-species experiment. *Royal Society Open Science*. 10:231057. doi: 10.1098/rsos.231057</span>
<span id="cb86-2469"><a href="#cb86-2469" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Lundgren EJ, Ramp D, Middleton OS, Wooster EI, Kusch E, Balisi M, Ripple WJ, Hasselerharm CD, Sanchez JN, Mills M, Wallach AD. (2022) A novel trophic cascade between cougars and feral donkeys shapes desert wetlands. *Journal of Animal Ecology*. 91:2348-57. doi: 10.1111/1365-2656.13766</span>
<span id="cb86-2470"><a href="#cb86-2470" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aki Vehtari, Andrew Gelman, Daniel Simpson, Bob Carpenter, Paul-Christian Bürkner (2021). Rank-Normalization, Folding, and Localization: An Improved Rhat for Assessing Convergence of MCMC (with Discussion). *Bayesian Analysis*. 16:667-718. doi: 10.1214/20-BA1221</span>
<span id="cb86-2471"><a href="#cb86-2471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2472"><a href="#cb86-2472" aria-hidden="true" tabindex="-1"></a><span class="fu"># Information about R session</span></span>
<span id="cb86-2473"><a href="#cb86-2473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2474"><a href="#cb86-2474" aria-hidden="true" tabindex="-1"></a>This section shows the current R session information, including R version, platform, and loaded packages.</span>
<span id="cb86-2475"><a href="#cb86-2475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-2478"><a href="#cb86-2478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb86-2479"><a href="#cb86-2479" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb86-2480"><a href="#cb86-2480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>